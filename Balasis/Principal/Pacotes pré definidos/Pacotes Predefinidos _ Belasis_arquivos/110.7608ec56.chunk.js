(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[110],{1288:function(e,t,a){"use strict";var n=a(0),s=a(50),i=a(1809),l=a(116),r=a(250),c=a(1440),d=a(787),o=a(2854),b=a(691),u=a(27),j=a(600),m=a(22);const _=e=>{let{record:t,openDrawer:a,handleDestroy:_}=e;const h=Object(u.a)((e=>e.current_user.salon)),O=Object(u.a)((e=>e.current_user.permissions)),p=h.id===t.salon.id,v=Object(n.useMemo)((()=>[{key:"edit",icon:Object(m.jsx)(c.a,{}),onClick:()=>{p?O.can_edit_anamnesis?a(t):l.b.warning(Object(s.b)("phrases.no_permission_to_do_this")):l.b.warning(Object(s.b)("anamnesis.edit_from_another_salon"))},label:Object(m.jsx)(r.h,{children:Object(s.b)("verbs.access")})},{key:"print",icon:Object(m.jsx)(d.a,{}),onClick:()=>Object(j.a)(`/reports/clients/anamnesis/${t.id}`),label:Object(m.jsx)(r.h,{children:Object(s.b)("verbs.print")})},{key:"delete",danger:!0,onClick:()=>_(t),icon:Object(m.jsx)(o.a,{}),label:Object(s.b)("verbs.delete")}]),[p,_,a,O.can_edit_anamnesis,t]);return Object(m.jsx)(r.g,{$justifyCenter:!0,children:Object(m.jsx)(i.a,{menu:{items:v},trigger:["click"],getPopupContainer:e=>e.parentElement||document.body,children:Object(m.jsx)(r.i,{className:"link",children:Object(m.jsx)(b.a,{})})})})};_.displayName="ActionsColumn",t.a=_},1289:function(e,t,a){"use strict";var n=a(0),s=a(50),i=a(250),l=a(583),r=a(53),c=a.n(r),d=a(547),o=a(18),b=a(22);const u=e=>{var t,a;const{item:n}=e,r=!(null===n||void 0===n||null===(t=n.digital_signature)||void 0===t||!t.id)||"finished"===(null===n||void 0===n||null===(a=n.electronic_signature)||void 0===a?void 0:a.status),u="open"===(null===n||void 0===n?void 0:n.status);return Object(b.jsxs)("div",{style:{overflow:"hidden",width:"100%"},children:[Object(b.jsx)(i.g,{$column:!0,style:{overflow:"hidden",flexGrow:1},children:Object(b.jsx)(l.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:"70%",children:Object(b.jsx)(i.h,{$bold:!0,$right:3,children:null===n||void 0===n?void 0:n.client.name})})}),Object(b.jsx)(i.g,{$column:!0,style:{overflow:"hidden",flexGrow:1},children:Object(b.jsx)(l.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:"40%",children:Object(b.jsx)(i.h,{$right:3,children:null===n||void 0===n?void 0:n.employee.name})})}),Object(b.jsx)(i.g,{style:{overflow:"hidden",flexGrow:1},children:Object(b.jsx)(l.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:"50%",children:Object(b.jsx)(i.h,{$right:3,children:null===n||void 0===n?void 0:n.anamnesis_template.name})})}),Object(b.jsxs)(i.g,{style:{display:"flex",justifyContent:"space-between",flexGrow:1},children:[Object(b.jsx)(l.b,{width:8,children:Object(b.jsxs)(i.h,{$size:12,children:[Object(s.b)("words.date"),": ",c()(null===n||void 0===n?void 0:n.entry_date).format("LL")]})}),Object(b.jsx)(l.b,{width:8,children:Object(b.jsxs)(i.h,{$size:12,children:[Object(s.b)("phrases.updated_at"),": ",c()(null===n||void 0===n?void 0:n.updated_at,o.H).format("L, HH:mm[h]")]})})]}),Object(b.jsxs)(i.g,{style:{display:"flex",justifyContent:"space-between",overflow:"hidden",flexGrow:1,marginTop:4},children:[Object(b.jsx)(l.b,{width:"40%",children:Object(b.jsx)(d.a,{color:u?"green":"red",children:u?Object(s.b)("words.open"):Object(s.b)("words.closed")})}),Object(b.jsx)(l.b,{width:"40%",children:Object(b.jsx)(d.a,{style:{marginRight:0},color:r?"blue":"red",children:r?Object(s.b)("digital_signature.signed",{context:"female"}):Object(s.b)("digital_signature.not_signed",{context:"female"})})})]})]})};u.displayName="AnamnesisMobileItem",t.a=Object(n.memo)(u)},2990:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(50),i=a(18),l=a(2854);const r=a(37).e`
  query AnamnesisList(
    $page: Int,
    $results: Int,
    $client_id: ID,
    $anamnesis_template_id: ID,
    $search_query: String,
    $start_date: String,
    $end_date: String,
    $signeds: Boolean,
    $closed: Boolean
  ) {
    all_anamnesis(
      page: $page,
      results: $results,
      client_id: $client_id,
      anamnesis_template_id: $anamnesis_template_id,
      search: $search_query,
      order_by: "entry_date",
      order: "DESC",
      start_date: $start_date,
      end_date: $end_date,
      signeds: $signeds,
      closed: $closed,
    ) {
      total_count
      all {
        id
        updated_at
        status
        anamnesis_template { id name }
        client { id name }
        fields
        entry_date
        employee { id name }
        salon { id name }

        digital_signature {
          id
          created_at
        }

        electronic_signature {
          id
          status
        }
      }
    }
  }
`;var c=a(116),d=a(1803),o=a(596),b=a(846),u=a(690),j=a(627),m=a(612),_=a(27),h=a(616),O=a(250),p=a(547),v=a(1288),w=a(53),f=a.n(w),x=a(22);var g=e=>{var t,a;const{openDrawer:l,handleDestroy:r,clientDrawerRef:d,anamnesisTemplaneDrawerRef:o,employeeDrawerRef:b}=e,u=Object(_.a)((e=>e.current_user.salon)),j=Object(_.a)((e=>e.current_user.permissions)),m=null===(t=u.organization)||void 0===t||null===(a=t.organization_configuration)||void 0===a?void 0:a.share_clients_between_salons;return Object(n.useMemo)((()=>{const e=[{title:Object(s.b)("words.date"),key:"entry_date",dataIndex:"entry_date",default_visible:!0,width:100,render:e=>f()(e).format("L")},{title:Object(s.b)("phrases.updated_at"),key:"updated_at",dataIndex:"updated_at",default_visible:!0,width:155,render:e=>f()(e,i.H).format("L, HH:mm[h]")},{title:Object(s.b)("words.client"),key:"client",dataIndex:"client",always_visible:!0,ellipsis:!0,render:e=>Object(x.jsx)(O.i,{title:e.name,className:"link text-overflow-ellipsis",onClick:()=>{var t;j.can_edit_client?null===(t=d.current)||void 0===t||t.open({id:e.id,initial_active_bar:"anamnesis"}):c.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))},children:e.name})},{title:Object(s.b)("words.anamnesi_template"),key:"anamnesis_template",dataIndex:"anamnesis_template",default_visible:!0,ellipsis:!0,render:e=>Object(x.jsx)(O.i,{title:e.name,className:"link text-overflow-ellipsis",onClick:()=>{var t;j.can_edit_anamnesis?null===(t=o.current)||void 0===t||t.open(e.id):c.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))},children:e.name})},{title:Object(s.b)("words.employee"),key:"employee",dataIndex:"employee",default_visible:!0,ellipsis:!0,render:e=>Object(x.jsx)(O.i,{title:e.name,className:"link text-overflow-ellipsis",onClick:()=>{var t;j.can_edit_employee?null===(t=b.current)||void 0===t||t.open({id:e.id}):c.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))},children:e.name})},{title:Object(s.b)("words.status"),key:"status",dataIndex:"status",default_visible:!0,width:90,render:e=>{const t="open"===e;return Object(x.jsx)(p.a,{color:t?"green":"red",children:t?Object(s.b)("words.open"):Object(s.b)("words.closed")})}}];return m&&e.push({title:Object(s.b)("words.subsidiary"),key:"salon",default_visible:!0,ellipsis:!0,dataIndex:"salon",render:(e,t)=>t.salon.name}),e.push({title:`${Object(s.b)("digital_signature.signed")}?`,key:"digital_signature",default_visible:!0,width:90,render:(e,t)=>{var a,n;const i=!(null===t||void 0===t||null===(a=t.digital_signature)||void 0===a||!a.id)||"finished"===(null===t||void 0===t||null===(n=t.electronic_signature)||void 0===n?void 0:n.status);return Object(x.jsx)(p.a,{color:i?"blue":"red",children:i?Object(s.b)("words.yes"):Object(s.b)("words.no")})}}),e.push({title:Object(s.b)("words.action",{count:2}),key:"actions",always_visible:!0,width:70,align:"center",render:(e,t)=>Object(x.jsx)(h.a,{width:54,children:Object(x.jsx)(v.a,{record:t,openDrawer:l,handleDestroy:r})})}),e}),[o,d,b,r,l,j.can_edit_anamnesis,j.can_edit_client,j.can_edit_employee,m])},y=a(1289),k=a(964),$=a(2937),C=a(1003),D=a(621);var H=()=>Object(n.useMemo)((()=>[{label:Object(s.b)("words.client"),name:"client_id",render:e=>Object(x.jsx)($.a.Item,{name:"client_id",noStyle:!0,children:Object(x.jsx)(D.a,{popupClassName:"ant-select-dropdown-small",onChange:t=>e.setFieldsValue({client_id:t}),show_phone:!0,style:{width:"100%"},allowClear:!0,variant:"borderless",getPopupContainer:()=>document.body})})},{label:Object(s.b)("words.anamnesi_template"),name:"anamnesis_template_id",render:e=>Object(x.jsx)($.a.Item,{name:"anamnesis_template_id",noStyle:!0,children:Object(x.jsx)(C.a,{onChange:t=>e.setFieldsValue({anamnesis_template_id:t}),style:{width:"100%"},allowClear:!0,variant:"borderless",getPopupContainer:()=>document.body})})},{label:Object(s.b)("words.period"),name:"dates",rangepicker:{start_date_name:"start_date",end_date_name:"end_date"}},{label:Object(s.b)("words.status"),name:"closed",default_value:null,double_checkbox:{true:Object(s.b)("words.closed"),false:Object(s.b)("words.open")}},{label:Object(s.b)("digital_signature.signed_other",{context:"female"}),name:"signeds",default_value:null,double_checkbox:{true:Object(s.b)("words.yes"),false:Object(s.b)("words.no")}}]),[]),I=a(593),R=a(1651);t.default=()=>{const e=Object(_.a)((e=>e.current_user.permissions)),t=Object(_.a)((e=>e.current_user.salon)),a=Object(n.useRef)(null),h=Object(n.useRef)(null),O=Object(n.useRef)(null),p=Object(n.useRef)(null),v=Object(n.useRef)(null);Object(I.a)({feature_keys:["has_anamnesis"],addon_keys:["has_anamnesis"],search:i.a.ID_ANAMNESIS});const[w]=Object(k.a)(),f=Object(n.useCallback)(((e,t)=>{var a;null===(a=p.current)||void 0===a||a.open(null===e||void 0===e?void 0:e.id,{tab:t})}),[]),$=Object(n.useCallback)((e=>{var t;null===(t=v.current)||void 0===t||t.afterDestroyRecord(e)}),[]),C=Object(n.useCallback)((async e=>{const{success:t}=await w({id:e});t&&(c.b.success(Object(s.b)("phrases.deleted_successfully",{prefix:Object(s.b)("words.anamnesi"),context:"female"})),$(1))}),[$,w]),D=Object(n.useCallback)((a=>{t.id===a.salon.id?e.can_destroy_anamnesis?c.c.confirm({centered:!0,className:"webook-modal",title:Object(s.b)("words.attention"),maskClosable:!0,content:Object(s.b)("phrases.confirm_delete",{model:Object(s.b)("words.anamnesi").toLocaleLowerCase(),context:"female"}),okText:Object(s.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(s.b)("verbs.cancel"),onOk:()=>C(a.id)}):c.b.warning(Object(s.b)("phrases.no_permission_to_do_this")):c.b.warning(Object(s.b)("anamnesis.delete_from_another_salon"))}),[t.id,C,e.can_destroy_anamnesis]),S=g({openDrawer:f,handleDestroy:D,clientDrawerRef:h,anamnesisTemplaneDrawerRef:O,employeeDrawerRef:a}),z=H(),N=Object(n.useCallback)((e=>{var t;null===(t=v.current)||void 0===t||t.refetch(),e&&f({id:e},"digital_signature")}),[f]),L=Object(n.useCallback)((()=>{var e;null===(e=v.current)||void 0===e||e.refetch()}),[]),M=Object(n.useCallback)((()=>!0),[]),V=Object(n.useCallback)((e=>{var t;return(null===e||void 0===e||null===(t=e.all_anamnesis)||void 0===t?void 0:t.total_count)||0}),[]),E=Object(n.useCallback)((e=>{var t;return null===e||void 0===e||null===(t=e.all_anamnesis)||void 0===t?void 0:t.all}),[]),T=Object(n.useCallback)((e=>({content:Object(x.jsx)(m.a,{icon:l.a,label:Object(s.b)("verbs.delete"),direction:"left",color:"red"}),action:()=>D(e)})),[D]);return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.a,{Header:R.a,ref:v,permissions_key:"anamnesis",filters:z,search_placeholder:Object(s.b)("input.search_by_name"),openDrawer:f,title:Object(s.b)("words.anamnesi",{count:2}),columns:S,item_selectable:!1,query:r,MobileItem:y.a,getData:E,getTotalCount:V,validateRow:M,mobileSwipeLeft:T}),Object(x.jsx)(b.a,{ref:p,afterSave:N}),Object(x.jsx)(o.a,{ref:h,onSave:L}),Object(x.jsx)(d.a,{ref:O,afterSave:L}),Object(x.jsx)(u.a,{ref:a,onSave:L})]})}},691:function(e,t,a){"use strict";var n=a(13),s=a(0),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]},name:"menu",theme:"outlined"},l=a(71),r=function(e,t){return s.createElement(l.a,Object(n.a)({},e,{ref:t,icon:i}))},c=s.forwardRef(r);t.a=c},787:function(e,t,a){"use strict";var n=a(13),s=a(0),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M820 436h-40c-4.4 0-8 3.6-8 8v40c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-40c0-4.4-3.6-8-8-8zm32-104H732V120c0-4.4-3.6-8-8-8H300c-4.4 0-8 3.6-8 8v212H172c-44.2 0-80 35.8-80 80v328c0 17.7 14.3 32 32 32h168v132c0 4.4 3.6 8 8 8h424c4.4 0 8-3.6 8-8V772h168c17.7 0 32-14.3 32-32V412c0-44.2-35.8-80-80-80zM360 180h304v152H360V180zm304 664H360V568h304v276zm200-140H732V500H292v204H160V412c0-6.6 5.4-12 12-12h680c6.6 0 12 5.4 12 12v292z"}}]},name:"printer",theme:"outlined"},l=a(71),r=function(e,t){return s.createElement(l.a,Object(n.a)({},e,{ref:t,icon:i}))},c=s.forwardRef(r);t.a=c}}]);
//# sourceMappingURL=110.7608ec56.chunk.js.map