(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[74],{1794:function(e,t,a){"use strict";var n=a(0),l=a(50),c=a(250),i=a(1838),s=a(853),r=a(2937),o=a(543),d=a(2883),b=a(159),u=a(787),j=a(614),m=a(27),_=a(621),p=a(22);const O=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const c=Object(m.a)((e=>e.is_mobile)),[i]=r.a.useForm(),{submit:s}=i,O=Object(n.useCallback)((e=>{a({document_template_id:t,...e})}),[t,a]);return Object(p.jsx)("div",{children:Object(p.jsx)(r.a,{form:i,layout:"horizontal",onFinish:O,children:Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:12,lg:10,children:Object(p.jsx)(r.a.Item,{name:"employee_id",children:Object(p.jsx)(j.a,{allowClear:!0,showCreateButton:!1,size:c?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:12,lg:10,children:Object(p.jsx)(r.a.Item,{name:"client_id",children:Object(p.jsx)(_.a,{allowClear:!0,show_phone:!1,size:c?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,lg:4,children:Object(p.jsx)(b.a,{block:!0,type:"primary",icon:Object(p.jsx)(u.a,{}),onClick:s,children:Object(l.b)("verbs.generate")})})]})})})};O.displayName="SelectWithoutOrigin";var h=Object(n.memo)(O),v=a(2921),g=a(37);const x=g.e`
  query fetchSchedules ($start_date: String, $end_date: String, $client_id: ID, $page: Int) {
    schedule_groups (
      start_date: $start_date, end_date: $end_date, client_id: $client_id, page: $page, results: 10,
      sort_field: "start_date", sort_order: "DESC"
    ) {
      all{
        id
        start_date

        client {
          id name
        }

        calendars {
          id
          start_hour
          status

          services {
            id description duration
          }

          employee {
            id name
          }
        }
      }
      total_count
    }
  }
`;var y=a(596),f=a(852),w=a(53),k=a.n(w);var $=e=>{let{document_template_id:t,openClientDrawer:a,openGenerateDocumentModal:i}=e;return Object(n.useMemo)((()=>[{key:"start_date",title:Object(l.b)("words.date"),dataIndex:"start_date",width:100,render:e=>Object(p.jsx)("span",{children:k()(e).format("L")})},{key:"client",title:Object(l.b)("words.client"),dataIndex:"client",render:e=>Object(p.jsx)(c.i,{onClick:()=>a(e.id),children:e.name})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>i({document_template_id:t,schedule_group_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a,i])},C=a(688);const D=e=>{let{item:t,document_template_id:a,openGenerateDocumentModal:i}=e;const s=Object(n.useCallback)((e=>e.services.reduce(((e,t,a)=>0===a?t.description:e+", "+t.description),"")),[]),r=Object(n.useCallback)((()=>{t&&i({document_template_id:a,schedule_group_id:null===t||void 0===t?void 0:t.id})}),[a,i,t]);return Object(p.jsx)(c.g,{$column:!0,onClick:r,children:null===t||void 0===t?void 0:t.calendars.map((e=>Object(p.jsxs)(c.g,{$alignCenter:!0,justify:"space-between",children:[Object(p.jsxs)(c.g,{$paddings:10,$column:!0,style:{overflow:"hidden",flexGrow:1},children:[Object(p.jsx)(c.h,{$textEllipsis:!0,$block:!0,$semibold:!0,children:s(e)}),Object(p.jsx)(c.h,{$block:!0,$color:"gray_1",$size:12,children:k()(null===t||void 0===t?void 0:t.start_date,"YYYY-MM-DD").format(`L [${Object(l.b)("words.at")}] `)+((null===e||void 0===e?void 0:e.start_hour)||0)})]}),Object(p.jsx)("div",{children:Object(p.jsxs)(c.g,{$paddings:10,$column:!0,align:"bottom",$isFlex:!1,children:[Object(p.jsx)(c.h,{$textEllipsis:!0,$block:!0,$semibold:!0,children:null===e||void 0===e?void 0:e.employee.name}),Object(C.c)((null===t||void 0===t?void 0:t.status)||"confirmed")]})})]})))})};D.displayName="ScheduleItemMobile";var I=Object(n.memo)(D),M=a(405);const S=e=>{const{query:t,columns:a,expandable:l,filters_initial_values:c,Filters:i,normalizeFilters:s,getData:o,getTotalCount:d}=e,[b,u]=Object(n.useState)(1),[j,m]=Object(n.useState)(c),[_]=r.a.useForm(),{data:O,loading:h}=Object(M.f)(t,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:{...s(j),page:b}}),g=Object(n.useCallback)((e=>{u(1),m(e)}),[]),x=Object(n.useCallback)((e=>{u(e)}),[]),y=o(O)||[],f=d(O)||0;return Object(p.jsxs)("div",{children:[Object(p.jsx)(r.a,{form:_,layout:"horizontal",onFinish:g,children:Object(p.jsx)(i,{})}),Object(p.jsx)("div",{children:Object(p.jsx)(v.a,{loading:h,dataSource:y,rowKey:e=>e.id,columns:a,pagination:{current:b,total:f,onChange:x,showSizeChanger:!1},expandable:l})})]})};S.displayName="Table";var F=Object(n.memo)(S),z=a(582),Y=a(199),E=a(583),R=a(592),T=a(904),N=a(19);const P=e=>{var t,a;const{query:i,filters_initial_values:s,MobileItem:o,Filters:d,getData:b,getTotalCount:u,mergeData:j,normalizeFilters:m}=e,[_,O]=Object(n.useState)(s),[h]=r.a.useForm(),v=Object(n.useRef)(null),g=Object(n.useRef)(null),x=Object(n.useRef)(1),{data:y,loading:f,fetchMore:w,refetch:k}=Object(M.f)(i,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:{...m(_),page:1}}),$=Object(n.useCallback)((()=>{x.current+=1,w({variables:{page:x.current},updateQuery:(e,t)=>{let{fetchMoreResult:a}=t;return a?j(e,a):e}})}),[w,j]),C=Object(n.useCallback)((e=>{x.current=1,O(e);const t=m(e);k({...t,page:1})}),[m,k]),D=b(y)||[],I=u(y)||0,S=((null===(t=v.current)||void 0===t?void 0:t.clientHeight)||0)-((null===(a=g.current)||void 0===a?void 0:a.clientHeight)||0);return Object(p.jsxs)(q,{ref:v,children:[Object(p.jsx)(r.a,{form:h,layout:"horizontal",onFinish:C,children:Object(p.jsx)("div",{ref:g,children:Object(p.jsx)(d,{})})}),Object(p.jsx)("div",{style:{marginLeft:-15,marginRight:-15},children:Object(p.jsx)(T.a,{style:{paddingTop:15},dataLength:D.length,next:$,hasMore:D.length<I,height:S-15,loader:Object(p.jsx)(c.g,{$justifyCenter:!0,$alignCenter:!0,$top:15,children:Object(p.jsx)(c.d,{as:Y.a,$color:"primary",$size:24})}),endMessage:f?Object(p.jsx)(c.g,{$justifyCenter:!0,$alignCenter:!0,$top:50,children:Object(p.jsx)(c.d,{as:Y.a,$color:"primary",$size:24})}):Object(p.jsx)(c.h,{$alignCenter:!0,$fullWidth:!0,$block:!0,$size:12,$color:"gray_1",children:Object(l.b)("phrases.total_record",{count:I})}),children:0===D.length&&f?[0,-1,-2,-3,-4,-5,-6,-7,-8,-9].map((e=>Object(p.jsx)(L,{children:Object(p.jsx)(E.a.Provider,{value:!0,children:Object(p.jsx)(o,{item:void 0})})},e))):D.map((e=>Object(p.jsx)(L,{children:Object(p.jsx)(E.a.Provider,{value:!1,children:Object(p.jsx)(o,{item:e})})},e.id)))})})]})};P.displayName="ListMobile";var G=Object(n.memo)(P);const q=N.d.div.withConfig({componentId:"wb__sc-1itosda-0"})(["height:100%;"]),L=Object(N.d)(R.b).attrs({$disabled:!1}).withConfig({componentId:"wb__sc-1itosda-1"})(["box-shadow:0 2px 9px rgba(83,83,83,0.2);"]);function B(e){return Object(p.jsx)(z.a,{Mobile:G,Desktop:F,...e})}B.displayName="ItemsList";var V=Object(n.memo)(B),A=a(1444),H=a(703);const K=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:10,children:Object(p.jsx)(U,{name:"dates",initialValue:[t.dates[0],t.dates[1]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:9,md:10,xl:11,children:Object(p.jsx)(U,{name:"client_id",children:Object(p.jsx)(_.a,{show_phone:!1,allowClear:!0,size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,xl:3,children:Object(p.jsx)(b.a,{block:!0,htmlType:"submit",type:"primary",size:a?"large":void 0,icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};K.displayName="Filters";var J=Object(n.memo)(K);const U=Object(N.d)(r.a.Item).withConfig({componentId:"wb__sc-ybupko-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"]))),W=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const c=Object(n.useRef)(null),i={dates:[k()().startOf("week"),k()().endOf("week")]},s=Object(n.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.open({id:e})}),[]),r=Object(n.useCallback)((e=>{let t=[];e.calendars.forEach((a=>a.services.forEach(((n,l)=>{return t.push({key:`${e.id}-${a.id}-${n.id}-${l}`,start_hour:a.start_hour,employee_name:a.employee.name,service_description:n.description,service_duration:(c=n.duration,`${k.a.duration(c,"seconds").hours().toLocaleString("pt-BR",{minimumIntegerDigits:2})}:\n    ${k.a.duration(c,"seconds").minutes().toLocaleString("pt-BR",{minimumIntegerDigits:2})}`)});var c}))));const a=[{key:"information",render:e=>Object(p.jsx)("p",{style:{margin:0},children:Object(l.b)("document_templates.select_schedule.calendar_resume",e)})}];return Object(p.jsx)(v.a,{showHeader:!1,rowKey:e=>e.key,dataSource:t,columns:a,pagination:!1})}),[]),o=Object(n.useCallback)((e=>{let{client_id:t,dates:a}=e;return{client_id:t,start_date:a[0].format("DD-MM-YYYY"),end_date:a[1].format("DD-MM-YYYY")}}),[]),d=$({document_template_id:t,openClientDrawer:s,openGenerateDocumentModal:a});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{query:x,columns:d,filters_initial_values:i,Filters:()=>Object(p.jsx)(J,{initial_filters:i}),MobileItem:e=>Object(p.jsx)(I,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:o,getData:e=>null===e||void 0===e?void 0:e.schedule_groups.all,getTotalCount:e=>null===e||void 0===e?void 0:e.schedule_groups.total_count,mergeData:(e,t)=>({...e,schedule_groups:{...e.schedule_groups,all:[...e.schedule_groups.all,...t.schedule_groups.all],total_count:t.schedule_groups.total_count}}),expandable:{expandedRowRender:r}}),Object(p.jsx)(y.a,{ref:c})]})};var Q=Object(n.memo)(W);const X=g.e`
  query inventory_purchases($start_date: String, $end_date: String, $page: Int, $search_term: String) {
    all_inventory_purchases(
      start_date: $start_date, end_date: $end_date, page: $page, search_term: $search_term, results: 10,
      status: "finished", deleted: false, sort_field: "code", sort_order: "DESC"
    ) {
      all {
        id date code number finished sum_cents vendor { id name }
      }
      total_count
    }
  }
`;var Z=a(579);var ee=e=>{let{document_template_id:t,openGenerateDocumentModal:a,openPurchaseDrawer:i}=e;return Object(n.useMemo)((()=>[{key:"code",title:Object(l.b)("words.ticket"),dataIndex:"code",width:80,render:(e,t)=>Object(p.jsxs)(c.i,{onClick:()=>i(t.id),children:["#",e]})},{key:"vendor",title:Object(l.b)("words.vendor"),dataIndex:"vendor",render:e=>null===e||void 0===e?void 0:e.name},{key:"sum_cents",title:Object(l.b)("words.value"),dataIndex:"sum_cents",width:120,align:"right",render:e=>Object(p.jsx)("span",{children:Object(Z.d)(e)})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>a({document_template_id:t,inventory_purchase_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a,i])},te=a(604),ae=a(735);const ne=e=>{var t;let{item:a,document_template_id:i,openGenerateDocumentModal:s}=e;const r=Object(n.useCallback)((()=>{a&&s({document_template_id:i,inventory_purchase_id:null===a||void 0===a?void 0:a.id})}),[i,s,a]);return Object(p.jsxs)(c.g,{$paddings:10,onClick:r,children:[Object(p.jsxs)(c.g,{$column:!0,style:{overflow:"hidden",flexGrow:1},children:[Object(p.jsxs)(E.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:22,children:[Object(p.jsxs)(c.h,{$color:"primary",$bold:!0,$right:3,children:["#",null===a||void 0===a?void 0:a.code]}),null===a||void 0===a||null===(t=a.vendor)||void 0===t?void 0:t.name]}),Object(p.jsx)(E.b,{width:22,$block:!0,$color:"gray_1",$size:12,$top:5,$right:5,$isFlex:!0,$textEllipsis:!0,children:k()(null===a||void 0===a?void 0:a.date).format("L")})]}),Object(p.jsx)("div",{children:Object(p.jsxs)(c.g,{$column:!0,align:"bottom",$left:10,$isFlex:!1,children:[Object(p.jsx)(E.b,{width:6,$align:"right",$block:!0,$semibold:!0,style:{whiteSpace:"nowrap"},children:Object(Z.d)(null===a||void 0===a?void 0:a.sum_cents)}),Object(p.jsx)("div",{style:{paddingTop:5,marginRight:-3},children:a?a.finished?Object(p.jsx)(ae.b,{$backgroundColor:"#777777",$color:"white",children:Object(l.b)("words.finished")}):Object(p.jsx)(ae.b,{$color:"#fdb730",$backgroundColor:"#fff4e1",children:Object(l.b)("words.pending")}):Object(p.jsx)(te.a,{width:"8ch"})})]})})]})};ne.displayName="PurchaseItemMobile";var le=Object(n.memo)(ne),ce=a(2824);const ie=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:12,md:9,lg:8,children:Object(p.jsx)(re,{name:"dates",initialValue:[t.dates[0],t.dates[1]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:12,md:11,lg:13,children:Object(p.jsx)(re,{name:"search_term",children:Object(p.jsx)(ce.a,{autoComplete:"off",placeholder:Object(l.b)("document_templates.purchase_search_placeholder"),size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,lg:3,children:Object(p.jsx)(b.a,{block:!0,type:"primary",htmlType:"submit",size:a?"large":void 0,icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};ie.displayName="Filters";var se=Object(n.memo)(ie);const re=Object(N.d)(r.a.Item).withConfig({componentId:"wb__sc-5m6asj-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"])));var oe=a(784);const de=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const l=Object(n.useRef)(null),c={dates:[k()().startOf("week"),k()().endOf("week")]},i=Object(n.useCallback)((e=>{let{search_term:t,dates:a}=e;return{search_term:t,start_date:a[0].format("YYYY-MM-DD"),end_date:a[1].format("YYYY-MM-DD")}}),[]),s=Object(n.useCallback)(((e,t)=>({...e,all_inventory_purchases:{...e.all_inventory_purchases,all:[...e.all_inventory_purchases.all,...t.all_inventory_purchases.all],total_count:t.all_inventory_purchases.total_count}})),[]),r=Object(n.useCallback)((e=>{var t;null===(t=l.current)||void 0===t||t.open({id:e})}),[]),o=ee({document_template_id:t,openGenerateDocumentModal:a,openPurchaseDrawer:r});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{query:X,columns:o,filters_initial_values:c,Filters:()=>Object(p.jsx)(se,{initial_filters:c}),MobileItem:e=>Object(p.jsx)(le,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:i,getData:e=>null===e||void 0===e?void 0:e.all_inventory_purchases.all,getTotalCount:e=>null===e||void 0===e?void 0:e.all_inventory_purchases.total_count,mergeData:s}),Object(p.jsx)(oe.a,{ref:l})]})};var be=Object(n.memo)(de);const ue=g.e`
  query fetchInventoryPackages ($start_date: String, $end_date: String, $client_id: ID, $code: Int, $page: Int) {
    inventory_packages (
      start_date: $start_date, end_date: $end_date, client_id: $client_id, code: $code, page: $page, results: 10,
      sort_order: "DESC", sort_field: "date"
    ) {
      all {
        id date code finished sum_cents client {
          id name
        }
      }
      total_count
    }
  }
`;var je=a(647);var me=e=>{let{document_template_id:t,openClientDrawer:a,openGenerateDocumentModal:i,openPackageDrawer:s}=e;return Object(n.useMemo)((()=>[{key:"code",title:Object(l.b)("words.ticket"),dataIndex:"code",width:80,render:(e,t)=>Object(p.jsxs)(c.i,{onClick:()=>s(t.id),children:["#",e]})},{key:"date",title:Object(l.b)("words.date"),dataIndex:"date",width:100,render:e=>Object(p.jsx)("span",{children:k()(e).format("L")})},{key:"client",title:Object(l.b)("words.client"),dataIndex:"client",render:e=>Object(p.jsx)(c.i,{onClick:()=>a(e.id),children:e.name})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>i({document_template_id:t,inventory_package_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a,i,s])},_e=a(547);const pe=e=>{var t;const{item:a,document_template_id:i,openGenerateDocumentModal:s}=e,r=Object(n.useMemo)((()=>a?a.finished?Object(p.jsx)(he,{color:"#777777",children:Object(l.b)("words.finished")}):Object(p.jsx)(he,{color:"orange",children:Object(l.b)("words.pending")}):Object(p.jsx)(te.a,{width:"8ch"})),[a]),o=Object(n.useCallback)((()=>{a&&s({document_template_id:i,inventory_package_id:null===a||void 0===a?void 0:a.id})}),[i,s,a]);return Object(p.jsxs)(c.g,{$column:!0,$paddings:10,onClick:o,children:[Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsxs)(E.b,{width:22,$block:!0,$textEllipsis:!0,$isFlex:!0,children:[Object(p.jsxs)(c.h,{$color:"primary",$bold:!0,children:["#",null===a||void 0===a?void 0:a.code]}),"\xa0",null===a||void 0===a||null===(t=a.client)||void 0===t?void 0:t.name]}),Object(p.jsx)(E.b,{width:6,$align:"right",$block:!0,$semibold:!0,style:{whiteSpace:"nowrap"},children:Object(Z.d)(null===a||void 0===a?void 0:a.sum_cents)})]}),Object(p.jsxs)(c.g,{$top:5,justify:"space-between",children:[Object(p.jsxs)(E.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[Object(l.b)("words.date"),": ",k()(null===a||void 0===a?void 0:a.date).format("L")]}),r]})]})};pe.displayName="PackageItemMobile";var Oe=Object(n.memo)(pe);const he=Object(N.d)(_e.a).withConfig({componentId:"wb__sc-1jwj9cu-0"})(["margin-right:0 !important;width:75px;text-align:center;"]);var ve=a(2838);const ge=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:12,lg:6,children:Object(p.jsx)(ye,{name:"dates",initialValue:[t.dates[0],t.dates[1]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:12,lg:6,children:Object(p.jsx)(ye,{name:"code",children:Object(p.jsx)(ve.a,{style:{width:"100%"},inputMode:"numeric",autoComplete:"off",placeholder:Object(l.b)("document_templates.search_by_ticket"),className:"hide-number-button",size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:19,md:20,lg:9,children:Object(p.jsx)(ye,{name:"client_id",children:Object(p.jsx)(_.a,{show_phone:!1,allowClear:!0,size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,lg:3,children:Object(p.jsx)(b.a,{block:!0,type:"primary",htmlType:"submit",size:a?"large":void 0,icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};ge.displayName="Filters";var xe=Object(n.memo)(ge);const ye=Object(N.d)(r.a.Item).withConfig({componentId:"wb__sc-1hp4jjw-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"]))),fe=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const l=Object(n.useRef)(null),c=Object(n.useRef)(null),i={dates:[k()().startOf("week"),k()().endOf("week")]},s=Object(n.useCallback)((e=>{let{client_id:t,code:a,dates:n}=e;return{code:a,client_id:t,start_date:n[0].format("YYYY-MM-DD"),end_date:n[1].format("YYYY-MM-DD")}}),[]),r=Object(n.useCallback)(((e,t)=>({...e,inventory_packages:{...e.inventory_packages,all:[...e.inventory_packages.all,...t.inventory_packages.all],total_count:t.inventory_packages.total_count}})),[]),o=Object(n.useCallback)((e=>{var t;null===(t=l.current)||void 0===t||t.open({id:e})}),[]),d=Object(n.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.open(e)}),[]),b=me({document_template_id:t,openClientDrawer:o,openGenerateDocumentModal:a,openPackageDrawer:d});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{query:ue,columns:b,filters_initial_values:i,Filters:()=>Object(p.jsx)(xe,{initial_filters:i}),MobileItem:e=>Object(p.jsx)(Oe,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:s,getData:e=>null===e||void 0===e?void 0:e.inventory_packages.all,getTotalCount:e=>null===e||void 0===e?void 0:e.inventory_packages.total_count,mergeData:r}),Object(p.jsx)(y.a,{ref:l}),Object(p.jsx)(je.a,{ref:c})]})};var we=Object(n.memo)(fe);const ke=g.e`
  query fetchFinanceBillRecs ($start_date: String, $end_date: String, $client_id: ID, $historical: String, $page: Int) {
    finance_bill_recs (
      start_date: $start_date, end_date: $end_date, date_type: "due", client_id: $client_id,
      historical: $historical, page: $page, results: 10, sort_field: "due", sort_order: "DESC"
    ) {
      all {
        id
        due
        historical
        value_cents
        payment {
          id
          name
        }
        client {
          id name
        }
      }
      total_count
    }
  }
`;var $e=e=>{let{document_template_id:t,openClientDrawer:a,openGenerateDocumentModal:i}=e;return Object(n.useMemo)((()=>[{key:"due",title:Object(l.b)("words.date"),dataIndex:"due",width:100,render:e=>Object(p.jsx)("span",{children:k()(e).format("L")})},{key:"client",title:Object(l.b)("words.client"),dataIndex:"client",render:e=>e?Object(p.jsx)(c.i,{onClick:()=>a(e.id),children:e.name}):"-"},{key:"historical",title:Object(l.b)("words.description"),dataIndex:"historical",render:e=>Object(p.jsx)("span",{children:e||"-"})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>i({document_template_id:t,finance_bill_rec_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a,i])};const Ce=e=>{var t;let{item:a,document_template_id:l,openGenerateDocumentModal:i}=e;const s=Object(n.useCallback)((()=>{a&&i({document_template_id:l,finance_bill_rec_id:null===a||void 0===a?void 0:a.id})}),[l,i,a]);return Object(p.jsxs)(c.g,{$column:!0,$paddings:10,onClick:s,children:[Object(p.jsxs)(c.g,{$column:!0,children:[Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsx)(c.h,{$size:16,$color:"primary",$textEllipsis:!0,children:(null===a||void 0===a||null===(t=a.client)||void 0===t?void 0:t.name)||"-"}),Object(p.jsx)(c.h,{children:k()(null===a||void 0===a?void 0:a.due).format("L")})]}),Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsx)(c.h,{children:null===a||void 0===a?void 0:a.payment.name}),Object(p.jsx)(c.h,{$size:16,$semibold:!0,children:Object(Z.d)(null===a||void 0===a?void 0:a.value_cents)})]})]}),Object(p.jsx)(c.h,{$textEllipsis:!0,children:null===a||void 0===a?void 0:a.historical})]})};Ce.displayName="BillRecItemMobile";var De=Object(n.memo)(Ce);const Ie=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:12,lg:6,children:Object(p.jsx)(Se,{name:"dates",initialValue:[t.dates[0],t.dates[1]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:12,lg:8,children:Object(p.jsx)(Se,{name:"historical",children:Object(p.jsx)(ce.a,{autoComplete:"off",placeholder:Object(l.b)("document_templates.search_by_description"),size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:19,md:20,lg:7,children:Object(p.jsx)(Se,{name:"client_id",children:Object(p.jsx)(_.a,{show_phone:!1,allowClear:!0,size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,lg:3,children:Object(p.jsx)(b.a,{block:!0,type:"primary",htmlType:"submit",size:a?"large":void 0,icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};Ie.displayName="Filters";var Me=Object(n.memo)(Ie);const Se=Object(N.d)(r.a.Item).withConfig({componentId:"wb__sc-mnti8i-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"]))),Fe=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const l=Object(n.useRef)(null),c={dates:[k()().startOf("week"),k()().endOf("week")]},i=Object(n.useCallback)((e=>{let{client_id:t,historical:a,dates:n}=e;return{client_id:t,historical:a,start_date:n[0].format("YYYY-MM-DD"),end_date:n[1].format("YYYY-MM-DD")}}),[]),s=Object(n.useCallback)(((e,t)=>({...e,finance_bill_recs:{...e.finance_bill_recs,all:[...e.finance_bill_recs.all,...t.finance_bill_recs.all],total_count:t.finance_bill_recs.total_count}})),[]),r=Object(n.useCallback)((e=>{var t;null===(t=l.current)||void 0===t||t.open({id:e})}),[]),o=$e({document_template_id:t,openClientDrawer:r,openGenerateDocumentModal:a});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{query:ke,columns:o,filters_initial_values:c,Filters:()=>Object(p.jsx)(Me,{initial_filters:c}),MobileItem:e=>Object(p.jsx)(De,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:i,getData:e=>null===e||void 0===e?void 0:e.finance_bill_recs.all,getTotalCount:e=>null===e||void 0===e?void 0:e.finance_bill_recs.total_count,mergeData:s}),Object(p.jsx)(y.a,{ref:l})]})};var ze=Object(n.memo)(Fe);const Ye=g.e`
  query fetchFinanceBillPays (
    $start_date: String, $end_date: String, $employee_id: ID, $historical: String, $page: Int
  ) {
    finance_bill_pays (
      start_date: $start_date, end_date: $end_date, date_type: "available_at", employee_id: $employee_id,
      historical: $historical, page: $page, results: 10, sort_field: "due", sort_order: "DESC"
    ) {
      all {
        id
        due
        historical
        value_cents
        payment{
          id name
        }
        employee {
          id name
        }
      }
      total_count
    }
  }
`;var Ee=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;return Object(n.useMemo)((()=>[{key:"due",title:Object(l.b)("words.date"),dataIndex:"due",width:100,render:e=>Object(p.jsx)("span",{children:k()(e).format("L")})},{key:"employee",title:Object(l.b)("words.employee"),dataIndex:"employee",render:e=>e?e.name:"-"},{key:"historical",title:Object(l.b)("words.description"),dataIndex:"historical",render:e=>Object(p.jsx)("span",{children:e||"-"})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>a({document_template_id:t,finance_bill_pay_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a])};const Re=e=>{var t;let{item:a,document_template_id:l,openGenerateDocumentModal:i}=e;const s=Object(n.useCallback)((()=>{a&&i({document_template_id:l,finance_bill_pay_id:null===a||void 0===a?void 0:a.id})}),[l,i,a]);return Object(p.jsxs)(c.g,{$column:!0,$paddings:10,onClick:s,children:[Object(p.jsxs)(c.g,{$column:!0,children:[Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsx)(c.h,{$size:16,$color:"primary",$textEllipsis:!0,children:(null===a||void 0===a||null===(t=a.employee)||void 0===t?void 0:t.name)||"-"}),Object(p.jsx)(c.h,{children:k()(null===a||void 0===a?void 0:a.due).format("L")})]}),Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsx)(c.h,{children:null===a||void 0===a?void 0:a.payment.name}),Object(p.jsx)(c.h,{$size:16,$semibold:!0,children:Object(Z.d)(null===a||void 0===a?void 0:a.value_cents)})]})]}),Object(p.jsx)(c.h,{$textEllipsis:!0,children:null===a||void 0===a?void 0:a.historical})]})};Re.displayName="BillPayItemMobile";var Te=Object(n.memo)(Re),Ne=a(2238);const Pe=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:12,lg:6,children:Object(p.jsx)(qe,{name:"dates",initialValue:[t.dates[0],t.dates[1]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:12,lg:8,children:Object(p.jsx)(qe,{name:"historical",children:Object(p.jsx)(ce.a,{autoComplete:"off",placeholder:Object(l.b)("document_templates.search_by_description"),size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:19,md:20,lg:7,children:Object(p.jsx)(qe,{name:"employee_id",children:Object(p.jsx)(j.a,{allowClear:!0,showCreateButton:!1,size:a?"large":void 0,style:{width:"100%"}})})}),Object(p.jsx)(d.a,{xs:24,sm:5,md:4,lg:3,children:Object(p.jsx)(b.a,{block:!0,size:a?"large":void 0,type:"primary",htmlType:"submit",icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};Pe.displayName="Filters";var Ge=Object(n.memo)(Pe);const qe=Object(N.d)(Ne.Form.Item).withConfig({componentId:"wb__sc-hg878h-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"]))),Le=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const l={dates:[k()().startOf("week"),k()().endOf("week")]},c=Object(n.useCallback)((e=>{let{employee_id:t,historical:a,dates:n}=e;return{employee_id:t,historical:a,start_date:n[0].format("YYYY-MM-DD"),end_date:n[1].format("YYYY-MM-DD")}}),[]),i=Object(n.useCallback)(((e,t)=>({...e,finance_bill_pays:{...e.finance_bill_pays,all:[...e.finance_bill_pays.all,...t.finance_bill_pays.all],total_count:t.finance_bill_pays.total_count}})),[]),s=Ee({document_template_id:t,openGenerateDocumentModal:a});return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(V,{query:Ye,columns:s,filters_initial_values:l,Filters:()=>Object(p.jsx)(Ge,{initial_filters:l}),MobileItem:e=>Object(p.jsx)(Te,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:c,getData:e=>null===e||void 0===e?void 0:e.finance_bill_pays.all,getTotalCount:e=>null===e||void 0===e?void 0:e.finance_bill_pays.total_count,mergeData:i})})};var Be=Object(n.memo)(Le);const Ve=g.e`
    query fetchInventorySales ($start_date: String, $end_date: String, $client_id: ID, $code: Int, $page: Int) {
    inventory_sales (
      start_date: $start_date, end_date: $end_date, client_id: $client_id, code: $code, page: $page, results: 10,
      sort_field: "date", sort_order: "DESC"
    ) {
      all {
        id
        date
        code
        finished
        sum_cents
        client {
          id name
        }
      }
      total_count
    }
  }
`;var Ae=a(613);var He=e=>{let{document_template_id:t,openClientDrawer:a,openGenerateDocumentModal:i,openSaleDrawer:s}=e;return Object(n.useMemo)((()=>[{key:"code",title:Object(l.b)("words.ticket"),dataIndex:"code",width:80,render:(e,t)=>Object(p.jsxs)(c.i,{onClick:()=>s(t.id),children:["#",e]})},{key:"date",title:Object(l.b)("words.date"),dataIndex:"date",width:100,render:e=>Object(p.jsx)("span",{children:k()(e).format("L")})},{key:"client",title:Object(l.b)("words.client"),dataIndex:"client",render:e=>Object(p.jsx)(c.i,{onClick:()=>a(e.id),children:e.name})},{key:"actions",width:30,render:e=>Object(p.jsx)(f.a,{title:Object(l.b)("document_templates.generate_document"),children:Object(p.jsx)(c.i,{onClick:()=>i({document_template_id:t,inventory_sale_id:e.id}),children:Object(p.jsx)(u.a,{})})})}]),[t,a,i,s])};const Ke=e=>{let{item:t,document_template_id:a,openGenerateDocumentModal:i}=e;const s=Object(n.useMemo)((()=>t?t.finished?Object(p.jsx)(Ue,{color:"#777777",children:Object(l.b)("words.finished")}):Object(p.jsx)(Ue,{color:"#fdb730",children:Object(l.b)("words.pending")}):Object(p.jsx)(te.a,{width:"8ch"})),[t]),r=Object(n.useCallback)((()=>{t&&i({document_template_id:a,inventory_sale_id:null===t||void 0===t?void 0:t.id})}),[a,i,t]);return Object(p.jsxs)(c.g,{$column:!0,$paddings:10,onClick:r,children:[Object(p.jsxs)(c.g,{justify:"space-between",children:[Object(p.jsxs)(E.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:22,children:[Object(p.jsxs)(c.h,{$color:"primary",$bold:!0,$right:3,children:["#",null===t||void 0===t?void 0:t.code]})," ",null===t||void 0===t?void 0:t.client.name]}),Object(p.jsx)(E.b,{width:6,$align:"right",$block:!0,$semibold:!0,children:Object(Z.d)(null===t||void 0===t?void 0:t.sum_cents)})]}),Object(p.jsxs)(c.g,{$top:5,justify:"space-between",children:[Object(p.jsx)(E.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:k()(null===t||void 0===t?void 0:t.date).format("L")}),s]})]})};Ke.displayName="SaleItemMobile";var Je=Object(n.memo)(Ke);const Ue=Object(N.d)(_e.a).withConfig({componentId:"wb__sc-6r9gxa-0"})(["margin-right:0 !important;width:75px;text-align:center;"]),We=e=>{let{initial_filters:t}=e;const a=Object(m.a)((e=>e.is_mobile));return Object(p.jsxs)(o.a,{gutter:8,children:[Object(p.jsx)(d.a,{xs:24,sm:6,children:Object(p.jsx)(Xe,{name:"dates",initialValue:[t.dates[0],t.dates[0]],children:Object(p.jsx)(H.a,{getPopupContainer:e=>e.parentElement||document.body,size:a?"large":void 0,allowClear:!1,format:"L",suffixIcon:null})})}),Object(p.jsx)(d.a,{xs:24,sm:6,children:Object(p.jsx)(Xe,{name:"code",children:Object(p.jsx)(ve.a,{style:{width:"100%"},size:a?"large":void 0,inputMode:"numeric",autoComplete:"off",placeholder:Object(l.b)("document_templates.search_by_ticket"),className:"hide-number-button"})})}),Object(p.jsx)(d.a,{xs:24,sm:9,children:Object(p.jsx)(Xe,{name:"client_id",children:Object(p.jsx)(_.a,{show_phone:!1,allowClear:!0,size:a?"large":void 0})})}),Object(p.jsx)(d.a,{xs:24,sm:3,children:Object(p.jsx)(b.a,{htmlType:"submit",block:!0,size:a?"large":void 0,type:"primary",icon:Object(p.jsx)(A.a,{}),children:Object(l.b)("verbs.search")})})]})};We.displayName="Filters";var Qe=Object(n.memo)(We);const Xe=Object(N.d)(r.a.Item).withConfig({componentId:"wb__sc-8hwx46-0"})(["",""],(e=>e.theme.is_mobile&&Object(N.c)(["margin-bottom:5px;"]))),Ze=e=>{let{document_template_id:t,openGenerateDocumentModal:a}=e;const l=Object(n.useRef)(null),c=Object(n.useRef)(null),i={dates:[k()().startOf("week"),k()().endOf("week")]},s=Object(n.useCallback)((e=>{let{client_id:t,code:a,dates:n}=e;return{client_id:t,code:a,start_date:n[0].format("DD-MM-YYYY"),end_date:n[1].format("DD-MM-YYYY")}}),[]),r=Object(n.useCallback)(((e,t)=>({...e,inventory_sales:{...e.inventory_sales,all:[...e.inventory_sales.all,...t.inventory_sales.all],total_count:t.inventory_sales.total_count}})),[]),o=Object(n.useCallback)((e=>{var t;null===(t=l.current)||void 0===t||t.open({id:e})}),[]),d=Object(n.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.open({sale_id:e})}),[]),b=He({document_template_id:t,openClientDrawer:o,openGenerateDocumentModal:a,openSaleDrawer:d});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{query:Ve,columns:b,filters_initial_values:i,Filters:()=>Object(p.jsx)(Qe,{initial_filters:i}),MobileItem:e=>Object(p.jsx)(Je,{...e,document_template_id:t,openGenerateDocumentModal:a}),normalizeFilters:s,getData:e=>null===e||void 0===e?void 0:e.inventory_sales.all,getTotalCount:e=>null===e||void 0===e?void 0:e.inventory_sales.total_count,mergeData:r}),Object(p.jsx)(y.a,{ref:l}),Object(p.jsx)(Ae.a,{ref:c})]})};var et=Object(n.memo)(Ze);const tt=(e,t)=>{const[a,r]=Object(n.useState)(!1),[o,d]=Object(n.useState)(),[b,u]=Object(n.useState)(),j=Object(n.useRef)(null),m=Object(n.useCallback)(((e,t)=>{d(t),u(e),r(!0)}),[]),_=Object(n.useCallback)((()=>{r(!1)}),[]);Object(n.useImperativeHandle)(t,(()=>({close:_,open:m})));const O=Object(n.useCallback)((e=>{var t;null===(t=j.current)||void 0===t||t.open(e)}),[]),v=Object(n.useMemo)((()=>{const e={document_template_id:b,openGenerateDocumentModal:O};let t;switch(o){case"ScheduleGroup":t=Object(p.jsx)(Q,{...e});break;case"Inventory::Sale":t=Object(p.jsx)(et,{...e});break;case"Inventory::Package":t=Object(p.jsx)(we,{...e});break;case"Finance::BillRec":t=Object(p.jsx)(ze,{...e});break;case"Finance::BillPay":t=Object(p.jsx)(Be,{...e});break;case"Inventory::Purchase":t=Object(p.jsx)(be,{...e});break;default:t=Object(p.jsx)(h,{...e})}return t}),[o,b,O]),g=Object(n.useCallback)((e=>{e||(u(void 0),d(void 0))}),[]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(c.a,{title:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(i.a,{})," ",Object(l.b)("document_templates.generate_document")]}),open:a,width:970,height:"100%",afterOpenChange:g,onClose:_,push:!1,children:v}),Object(p.jsx)(s.a,{ref:j})]})};t.a=Object(n.memo)(Object(n.forwardRef)(tt))},2955:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a(50),c=a(37);const i=c.a`
  query fetchDocumentTemplates ($search_query: String, $class_type: String, $page: Int, $results: Int) {
    document_templates (search_term: $search_query, class_type: $class_type, page: $page, per_page: $results) {
      all {
        id name description class_type
      }
      total_count
    }
  }
`;var s=a(18),r=a(2937),o=a(250),d=a(116),b=a(1850),u=a(76);const j=c.e`
  mutation documentTemplateDestroy($data: DocumentTemplateDestroyInput!) {
    documentTemplateDestroy(input: $data) {
      destroyed errors
    }
  }
`;var m=()=>{const[e,{loading:t}]=Object(b.a)(j);return[Object(n.useCallback)((async t=>{try{var a;const n=await e({variables:{data:{id:t}}}),{destroyed:l,errors:c}=(null===(a=n.data)||void 0===a?void 0:a.documentTemplateDestroy)||{};return l?{success:!0}:(null===c||void 0===c||c.forEach((e=>d.b.error(e))),{success:!1})}catch(n){return u.a.captureException(n),console.error(n),d.b.error(Object(l.b)("phrases.generic_delete_error_message")),{success:!1}}}),[e]),t]},_=a(582);const p=c.e`
  mutation documentTemplateSave($data: DocumentTemplateSaveInput!) {
    documentTemplateSave(input: $data) {
      success errors
    }
  }
`;var O=()=>{const[e,{loading:t}]=Object(b.a)(p);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:n,errors:l=[]}=(null===a||void 0===a?void 0:a.documentTemplateSave)||{};return null===l||void 0===l||l.forEach((e=>d.b.error(e))),{success:n}}catch(a){return u.a.captureException(a),d.b.error(Object(l.b)("phrases.generic_save_error_message")),{success:!1}}},{loading:t}]},h=a(27),v=a(2879);const g=c.e`
  query fetchDocumentTemplate ($id: ID) {
    document_template (id: $id) {
      id name description class_type save_on_generation template_content_html
    }
  }
`;var x=(e,t)=>{const a=Object(n.useCallback)((a=>{e(a),t(a.class_type)}),[t,e]);return Object(v.a)(g,{fetchPolicy:"network-only",onCompleted:e=>{const{document_template:t}=e;a(t)},onError:e=>{u.a.captureException(e),console.log(e)}})},y=a(232),f=a(19),w=a(22);const k=Object(n.lazy)((()=>Object(y.a)((()=>Promise.all([a.e(13),a.e(33),a.e(190)]).then(a.bind(null,3008)))))),$=Object(n.lazy)((()=>Object(y.a)((()=>Promise.all([a.e(13),a.e(33),a.e(191)]).then(a.bind(null,3009)))))),C=(e,t)=>{const{afterSave:a,afterDestroy:c}=e,[i,s]=Object(n.useState)(!1),[o,b]=Object(n.useState)(),[u,j]=Object(n.useState)(""),p=Object(h.a)((e=>e.is_mobile)),[v]=r.a.useForm(),{submit:g,setFieldsValue:y,resetFields:f}=v,[C,{loading:D}]=x(y,j),[M,{loading:S}]=O(),[F,z]=m(),Y=Object(n.useCallback)((e=>{e&&(C({variables:{id:e}}),b(e)),s(!0)}),[C]),E=Object(n.useCallback)((()=>{s(!1)}),[]);Object(n.useImperativeHandle)(t,(()=>({close:E,open:Y})));const R=Object(n.useCallback)((async e=>{const{success:t}=await M(e);t&&(d.b.success(Object(l.b)("phrases.saved_successfully",{prefix:Object(l.b)("words.document_template")})),E(),null===a||void 0===a||a())}),[a,E,M]),T=Object(n.useCallback)((()=>{d.c.confirm({centered:!0,className:"webook-modal",title:Object(l.b)("words.attention"),maskClosable:!0,content:Object(l.b)("phrases.confirm_delete",{model:Object(l.b)("words.document_template").toLocaleLowerCase()}),okText:Object(l.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(l.b)("verbs.cancel"),onOk:async()=>{if(!o)return;const{success:e}=await F(o);e&&(null===c||void 0===c||c(),E())}})}),[c,E,F,o]),N=Object(n.useCallback)((e=>{e||(f(),b(void 0),j(""))}),[f]),P=o?Object(l.b)("document_templates.edit_document"):Object(l.b)("document_templates.new_document");return Object(w.jsx)(I,{closable:!0,destroyOnClose:!0,open:i,onClose:E,width:1650,height:"100%",push:!1,afterOpenChange:N,placement:p?"bottom":"right",children:Object(w.jsx)(r.a,{form:v,layout:"vertical",onFinish:R,style:{height:"100%"},children:Object(w.jsx)(_.a,{Mobile:$,Desktop:k,loading:D,title:P,document_template_id:o,destroy_loading:z,save_loading:S,class_type:u,close:E,submit:g,setClassType:j,handleDestroyDocument:T})})})};C.displayName="DocumentTemplateDrawer";var D=Object(n.forwardRef)(C);const I=Object(f.d)(o.a).withConfig({componentId:"wb__sc-1ebt5q2-0"})([".ant-drawer-body{background:",";padding:0;.tox-statusbar__branding{display:none;}}"],(e=>e.theme.is_mobile?"#f8f8f8":"transparent"));var M=a(1794),S=a(627),F=a(852),z=a(1438),Y=a(616),E=a(787),R=a(3034),T=a(989),N=a(2854);const P=e=>{let{document_template_id:t,afterDestroy:a}=e;const[c,i]=m(),s=Object(n.useCallback)((e=>{d.c.confirm({centered:!0,className:"webook-modal",title:Object(l.b)("words.attention"),maskClosable:!0,content:Object(l.b)("phrases.confirm_delete",{model:Object(l.b)("words.document_template").toLocaleLowerCase()}),okText:Object(l.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(l.b)("verbs.cancel"),onOk:async()=>{if(!e)return;const{success:t}=await c(e);t&&(null===a||void 0===a||a())}})}),[a,c]);return Object(w.jsx)(F.a,{title:Object(l.b)("verbs.delete"),placement:"bottom",children:Object(w.jsx)(o.i,{className:"link color-red",disabled:i,onClick:()=>s(t),children:Object(w.jsx)(N.a,{})})})};P.displayName="DeleteIcon";var G=Object(n.memo)(P);var q=(e,t,a)=>Object(n.useMemo)((()=>[{title:Object(l.b)("words.name"),dataIndex:"name",key:"name",width:210,align:"left",ellipsis:!0,always_visible:!0},{title:Object(l.b)("words.description"),key:"description",dataIndex:"description",ellipsis:!0,always_visible:!0,align:"left"},{title:Object(l.b)("words.origin"),key:"class_type",dataIndex:"class_type",width:130,ellipsis:!0,always_visible:!0,align:"left",render:e=>T.a[e]||Object(l.b)("document_templates.class_types.without_origin")},{title:"A\xe7\xf5es",key:"actions",width:110,align:"center",always_visible:!0,render:n=>Object(w.jsxs)(Y.a,{width:100,children:[Object(w.jsx)(F.a,{title:Object(l.b)("verbs.print"),placement:"bottom",children:Object(w.jsx)(o.i,{className:"link",onClick:()=>a(n.id,n.class_type),children:Object(w.jsx)(E.a,{})})}),Object(w.jsx)(z.a,{type:"vertical"}),Object(w.jsx)(F.a,{title:Object(l.b)("verbs.edit"),placement:"bottom",children:Object(w.jsx)(o.i,{className:"link",onClick:()=>e(n),children:Object(w.jsx)(R.a,{})})}),Object(w.jsx)(z.a,{type:"vertical"}),Object(w.jsx)(G,{document_template_id:n.id,afterDestroy:t})]})}]),[t,e,a]),L=a(583);const B=e=>{const{item:t}=e,a=T.a[null===t||void 0===t?void 0:t.class_type]||Object(l.b)("document_templates.class_types.without_origin");return Object(w.jsxs)(o.g,{$column:!0,children:[Object(w.jsx)(o.g,{justify:"space-between",children:Object(w.jsx)(L.b,{width:22,$block:!0,$textEllipsis:!0,$isFlex:!0,children:null===t||void 0===t?void 0:t.name})}),Object(w.jsx)(o.g,{justify:"space-between",children:Object(w.jsx)(L.b,{width:22,$block:!0,$textEllipsis:!0,$isFlex:!0,children:Object(w.jsx)(o.h,{$bold:!0,children:a})})}),Object(w.jsx)(o.g,{justify:"space-between",children:Object(w.jsx)(L.b,{width:22,$block:!0,$textEllipsis:!0,$isFlex:!0,children:null===t||void 0===t?void 0:t.description})})]})};B.displayName="DocumentTemplateItemMobile";var V=Object(n.memo)(B);var A=()=>{const e=Object(n.useMemo)((()=>Object.entries(T.a).map((e=>{let[t,a]=e;return{value:t,label:a}}))),[]);return Object(n.useMemo)((()=>[{label:Object(l.b)("words.origin"),name:"class_type",radio_options:e}]),[e])},H=a(593);const K=()=>{const e=Object(h.a)((e=>e.current_user.permissions.is_admin)),t=Object(n.useRef)(null),a=Object(n.useRef)(null),c=Object(n.useRef)(null),r=Object(n.useCallback)((e=>{var t;null===(t=a.current)||void 0===t||t.open(null===e||void 0===e?void 0:e.id)}),[]),o=Object(n.useCallback)(((e,t)=>{var a;null===(a=c.current)||void 0===a||a.open(e,t)}),[]),d=Object(n.useCallback)((()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.afterDestroyRecord(1)}),[]),b=q(r,d,o),u=A();return Object(H.a)({addon_keys:["has_document_template"],search:s.a.ID_DOCUMENT_TEMPLATE}),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S.a,{ref:t,openDrawer:r,permissions:{can_access:e,can_create:e,can_edit:e},search_placeholder:"Procure por nome ou descri\xe7\xe3o",title:Object(l.b)("words.document_template"),filters:u,columns:b,query:i,MobileItem:V,validateRow:()=>!0,getData:e=>{var t;return null===e||void 0===e||null===(t=e.document_templates)||void 0===t?void 0:t.all},getTotalCount:e=>{var t;return(null===e||void 0===e||null===(t=e.document_templates)||void 0===t?void 0:t.total_count)||0}}),Object(w.jsx)(D,{ref:a,afterSave:Object(n.useCallback)((()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.refetch()}),[]),afterDestroy:d}),Object(w.jsx)(M.a,{ref:c})]})};t.default=Object(n.memo)(K)},609:function(e,t,a){"use strict";var n=a(0),l=a(50),c=a(159),i=a(53),s=a.n(i),r=a(19),o=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(o.jsx)(b,{children:u.map((e=>{let{label:a,value:n}=e;return Object(o.jsx)(c.a,{type:"primary",onClick:()=>t(n),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(n.memo)(d);const b=r.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(l.b)("words.today"),value:[s()(),s()()]},{label:Object(l.b)("date.last_week"),value:[s()().startOf("week").subtract(1,"week"),s()().endOf("week").subtract(1,"week")]},{label:Object(l.b)("date.last_month"),value:[s()().subtract(1,"month").startOf("month"),s()().subtract(1,"month").endOf("month")]},{label:Object(l.b)("date.current_month"),value:[s()().startOf("month"),s()().endOf("month")]},{label:Object(l.b)("date.six_months_ago"),value:[s()().subtract(6,"month"),s()()]},{label:Object(l.b)("date.one_year_ago"),value:[s()().subtract(12,"month"),s()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return j})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return _})),a.d(t,"a",(function(){return p}));var n=a(19),l=a(0),c=a(2934),i=a(609),s=a(22);const r=(e,t)=>{let{onRangeChange:a,...n}=e;const[r,o]=Object(l.useState)(!1),b=Object(l.useCallback)((e=>{a(e)}),[a]);return Object(s.jsx)(c.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(s.jsx)(d,{children:Object(s.jsx)(i.a,{handleChangeRange:b})}),...n,open:r,onOpenChange:o})};r.displayName="SimpleRangePicker";var o=Object(l.memo)(Object(l.forwardRef)(r));const d=n.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,n]=e;n in b&&(t[a]=b[n])})),Object.entries(e).forEach((e=>{let[t,n]=e;u.includes(t)&&(a[t]=null===n||void 0===n?void 0:n.format("YYYY-MM-DD"))})),{...e,...t,...a}},m=n.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(n.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),_=Object(n.d)(o).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),p=n.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(n.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var n=a(0),l=a(50),c=a(2937),i=a(137),s=a(578),r=a(116),o=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var j=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},m=a(53),_=a.n(m),p=a(635),O=a(22);const h={ascend:"ASC",descend:"DESC"},v=e=>e?_()(e):null;var g=a(405),x=a(610),y=a(27),f=a(582),w=a(1814),k=a(148);var $=e=>{const{total_count:t,records:a,results:c,select_all_query:i,validateRow:s=(e=>!0),rowSelector:o=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(n.useState)([]),[u,j]=Object(n.useState)(!1),[m,_]=Object(n.useState)(!1),[p,h]=Object(n.useState)(!1),v=Object(k.a)(),g=Object(n.useCallback)((()=>{j(!1),b([]),h(!1)}),[]),x=Object(n.useCallback)((()=>{const e=r.b.loading(`${Object(l.b)("verbs.selecting")}...`,0);_(!0);const{query:t,variables:a,resolve:n}=i;v.query({query:t,variables:a,fetchPolicy:"network-only"}).then(n((e=>{j(!0),b(o(e))}))).catch((e=>console.error(e))).then((()=>{e(),_(!1)}))}),[v,o,i]),y=Object(n.useCallback)(((e,t)=>{b(o(t))}),[]),f=Object(n.useMemo)((()=>a.filter(s)),[a,s]);return Object(n.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:f,total_count:t,resetSelected:g,records:a,results:c,selectAll:x,onChange:y,is_select_mode:p,setIsSelectMode:h,is_selecting_all:m,setSelectedAll:j,setIsSelectingAll:_,getCheckboxProps:e=>({disabled:!s(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(O.jsx)(w.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<f.length)return b(o(f));g()}})})),[u,d,t,g,a,c,x,y,s,f,p,h,m])},C=a(597),D=a(232);const I=Object(n.lazy)((()=>Object(D.a)((()=>a.e(12).then(a.bind(null,968)))))),M=Object(n.lazy)((()=>Object(D.a)((()=>a.e(7).then(a.bind(null,969)))))),S=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(O.jsx)(C.b,{title:t,onSearch:e,children:Object(O.jsx)(f.a,{Desktop:I,Mobile:M})})};S.displayName="DefaultHeader";var F=S,z=a(76);const Y=Object(n.lazy)((()=>Object(D.a)((()=>a.e(94).then(a.bind(null,2909)))))),E=Object(n.lazy)((()=>Object(D.a)((()=>a.e(67).then(a.bind(null,3082)))))),R=e=>!(null===e||void 0===e||!e.active),T=e=>null===e||void 0===e?void 0:e.id,N=(e,t)=>{var a,m;const{columns:_,filters:w,extra_actions:k,query:C,getTotalCount:D,getData:I,select_all_query:M,validateRow:S=R,rowSelectorKey:N=T,Header:P,expandedRowKeys:G,title:q,storage_key:L=q,has_feature:B=!0,use_storage:V=!0,addon_id:A,has_joyride:H=!0,show_create_button:K=!0,item_selectable:J=!0,parseFilters:U=x.d,rowClassName:W,mobileSwipeLeft:Q}=e,X=Object(y.a)((e=>e.current_user.permissions)),Z=Object(y.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${L}`,[te]=c.a.useForm(),ae=(null===(a=_.find((e=>e.sorter)))||void 0===a?void 0:a.key)||_[0].key,ne=(null===(m=_.find((e=>e.defaultSortOrder)))||void 0===m?void 0:m.defaultSortOrder)||_[0].defaultSortOrder||"ascend",le=Object(n.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:n,local_storage_key:l,visible_columns:c,use_storage:i}=e,s=Object(d.c)(l);if(s&&i){const e=null===s||void 0===s?void 0:s.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...s,filters_value:{...s.filters_value,start_date:v(s.filters_value.start_date),end_date:v(s.filters_value.end_date),birthday_start_date:v(s.filters_value.birthday_start_date),birthday_end_date:v(s.filters_value.birthday_end_date),start_date_open:v(s.filters_value.start_date_open),start_date_close:v(s.filters_value.start_date_close),end_date_open:v(s.filters_value.end_date_open),end_date_close:v(s.filters_value.end_date_close)}}:s}const r=null===n||void 0===n?void 0:n.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:h[t],filters_value:r,visible_columns:c}})({local_storage_key:ee,filters:w,default_sort_field:ae,default_sort_order:ne,visible_columns:_.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:V})),[_,ae,ne,w,ee,V]),[ce,ie]=Object(n.useReducer)(j,le);Object(s.a)((()=>{Object(d.d)(ee,{...ce,page:1})}),[ce]);const[se,re]=Object(n.useState)(""),[oe,de]=Object(n.useState)([]),[be,ue]=Object(n.useState)(0),je=Object(n.useRef)(!1),me=(e=>{const{columns:t,visible_columns:a=[],dispatch:n}=e,l=t.filter((e=>a.includes(e.key)||e.always_visible)),c=l.findIndex((e=>"actions"===e.key));return c&&(l[c]={...l[c],title:Object(O.jsx)(p.a,{columns:t,visible_columns:a,dispatch:n})}),l})({dispatch:ie,columns:_,visible_columns:ce.visible_columns}),_e={...Object(n.useMemo)((()=>_.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=ce.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[_,ce.visible_columns]),...U(ce.filters_value),is_mobile:Z,search_query:se,sort_field:ce.sort_field,sort_order:ce.sort_order,page:ce.page,results:ce.results},{loading:pe,refetch:Oe}=Object(g.f)(C,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:_e,skip:!B,onError:e=>{console.log(e),z.a.captureException(e),r.b.error(Object(l.b)("phrases.loading_error"))},onCompleted:e=>{ue(D(e)),1!==ce.page&&je.current?de((t=>[...t,...I(e)||[]])):de(I(e)||[])}}),he=Object(n.useCallback)((()=>{if(1===ce.page)return Oe();ie({type:"set_page",payload:1})}),[ce.page,Oe]),ve=Object(n.useCallback)((()=>{je.current=!0,ie({type:"set_page",payload:ce.page+1})}),[ce.page]),ge=Object(n.useCallback)(((e,t,a)=>{a.order&&(ie({type:"set_sort_field",payload:a.field}),ie({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&ie({type:"set_page",payload:e.current}),e.pageSize&&ie({type:"set_results",payload:e.pageSize})}),[]),xe=$({total_count:be,results:ce.results,records:oe,select_all_query:{query:M,variables:_e,resolve:e=>t=>{let{data:a}=t;return e(I(a)||[])}},validateRow:S,rowSelector:Object(n.useCallback)((e=>e.filter(S).map(N)),[N,S])}),ye=Object(n.useMemo)((()=>G?G(oe):void 0),[oe,G]),fe=Object(n.useCallback)((e=>{Oe(),xe.resetSelected();const t=Math.ceil((be-e)/ce.results);ce.page>t&&ie({type:"set_page",payload:t})}),[ce.page,Oe,ce.results,xe,be]),we=Object(n.useCallback)((e=>{ie({type:"set_page",payload:1}),re(e)}),[re]),ke=Object(n.useCallback)((e=>{ie({type:"set_filters_value",payload:e}),ie({type:"set_page",payload:1})}),[]),$e=Object(n.useMemo)((()=>B?e.permissions?e.permissions:e.permissions_key?{can_create:X[`can_create_${e.permissions_key}`],can_edit:X[`can_edit_${e.permissions_key}`],can_access:X[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[B,e.permissions,e.permissions_key,X]),Ce=Object(n.useCallback)((()=>{if(xe.resetSelected(),Z)return 1===ce.page?void Oe():void ie({type:"set_page",payload:1});Oe()}),[Z,Oe,xe,ce.page]);Object(n.useImperativeHandle)(t,(()=>({afterDestroyRecord:fe,refetch:Ce})));const De=Object(n.useMemo)((()=>({onSearch:we,row_selection:xe,onFiltersChange:ke,data_source:oe,form:te,total_count:be,loading:pe,new_columns:me,onChange:ge,expanded_row_keys:ye,refetch:he,handleFetchMore:ve,...e,has_feature:B,addon_id:A,has_joyride:H,show_create_button:K,item_selectable:J,validateRow:S,rowSelectorKey:N,permissions:$e,...ce,dispatch:ie,rowClassName:W,extra_actions:k})),[we,xe,ke,oe,te,be,pe,me,ge,ye,he,ve,e,B,H,K,S,N,$e,ce,W,k,J,A]),Ie=Object(n.useMemo)((()=>null===w||void 0===w?void 0:w.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[w]);return Object(O.jsx)(b.a.Provider,{value:De,children:Object(O.jsxs)(o.b,{children:[P?Object(O.jsx)(P,{}):Object(O.jsx)(F,{}),Object(O.jsx)(c.a,{form:te,component:!1,layout:"vertical",onChange:Object(i.debounce)(ke,1e3),initialValues:{...Ie,...ce.filters_value},children:Object(O.jsx)(f.a,{Desktop:Y,Mobile:E,mobileSwipeLeft:Q})})]})})};N.displayName="MagicTable";t.a=Object(n.memo)(Object(n.forwardRef)(N))},635:function(e,t,a){"use strict";var n=a(0),l=a(50),c=a(1809),i=a(852),s=a(1814),r=a(3052),o=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:s,setVisibleColumns:o}=e;const[b,j]=Object(n.useState)(!1),m=Object(n.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===s||void 0===s||s({type:"set_visible_columns",payload:e}),null===o||void 0===o||o(e)}),[t,s,o]),_=Object(n.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===s||void 0===s||s({type:"set_visible_columns",payload:t}),void(null===o||void 0===o||o(t))}const t=[...a,e];null===s||void 0===s||s({type:"set_visible_columns",payload:t}),null===o||void 0===o||o(t)}),[s,o,a]),p=Object(n.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const n={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>_(t.key),checked:a.includes(t.key),children:t.title})};return[...e,n]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(l.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:m,children:Object(l.b)("words.default")})]}),children:e}]}),[t,m,_,a]);return Object(d.jsx)(c.a,{menu:{items:p},trigger:["click"],open:b,onOpenChange:j,className:"no-print table-configuration",children:Object(d.jsx)(i.a,{title:Object(l.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(r.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(o.d)(s.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])},688:function(e,t,a){"use strict";a.d(t,"c",(function(){return O})),a.d(t,"a",(function(){return h}));var n=a(0),l=a(50),c=a(852),i=a(547),s=a(250),r=a(1440),o=a(2843),d=a(27),b=a(19),u=a(53),j=a.n(u),m=a(116),_=a(117),p=a(22);t.b=e=>{let{openScheduleGroupDrawer:t,handleCreateSale:a,handleOpenSale:i}=e;const b=Object(d.a)((e=>e.current_user.permissions)),u=Object(d.a)((e=>e.current_user.salon_id)),_=Object(d.a)((e=>{var t,a;return null===(t=e.current_user.salon.organization)||void 0===t||null===(a=t.organization_configuration)||void 0===a?void 0:a.share_clients_between_salons}));return Object(n.useMemo)((()=>{let e=[{title:Object(l.b)("words.date"),key:"start_date",dataIndex:"start_date",width:160,render:(e,t)=>j()(e,"YYYY-MM-DD").format(`L [${Object(l.b)("words.at")}] `)+t.start_hour},{title:Object(l.b)("words.service"),key:"services",dataIndex:"services",ellipsis:!0,render:e=>{const t=e.reduce(((t,a,n)=>{let{description:l}=a;return`${t+l}${n+1!==e.length?", ":""}`}),"");return Object(p.jsx)("span",{title:t,children:t})}},{title:Object(l.b)("words.status"),key:"status",dataIndex:"status",width:120,render:e=>O(e)},{title:Object(l.b)("words.employee"),key:"employee",dataIndex:"employee",width:160,ellipsis:!0,render:e=>e.name}];return _&&e.push({title:Object(l.b)("words.subsidiary"),key:"salon",ellipsis:!0,width:160,dataIndex:"salon",render:e=>Object(p.jsx)("span",{title:e.name,children:e.name})}),e=[...e,{title:Object(l.b)("words.sale"),key:"sale",align:"center",width:100,render:(e,t)=>{const n=String(u)===String(t.salon.id),d=t.sale;return n?Object(p.jsx)(c.a,{title:d?Object(l.b)("clients.schedule.view_sale"):Object(l.b)("clients.schedule.create_sale"),children:Object(p.jsx)(s.i,{className:"link",onClick:()=>{d&&b.can_edit_sale?i(null===d||void 0===d?void 0:d.id):d||!b.can_create_sale?m.b.warning(Object(l.b)("phrases.no_permission_to_do_this")):a(t.schedule_group_id)},children:d?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(r.a,{}),"\xa0",Object(l.b)("verbs.view")]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.a,{}),"\xa0",Object(l.b)("verbs.create")]})})}):null}},{title:Object(l.b)("words.action",{count:2}),key:"actions",align:"center",width:70,render:(e,a)=>String(u)===String(a.salon.id)?Object(p.jsx)(c.a,{placement:"left",title:Object(l.b)("clients.schedule.view_schedule"),children:Object(p.jsx)(s.i,{className:"link",onClick:()=>{b.can_edit_calendar?t(a.schedule_group_id):m.b.warning(Object(l.b)("phrases.no_permission_to_do_this"))},children:Object(p.jsx)(r.a,{})})}):null}],e}),[i,a,t,b.can_create_sale,b.can_edit_calendar,b.can_edit_sale,u,_])};const O=e=>({confirmed:Object(p.jsx)(h,{color:_.a.calendar_confirmed,style:{color:"white"},children:Object(l.b)("words.confirmed")}),unconfirmed:Object(p.jsx)(h,{color:_.a.calendar_unconfirmed,style:{color:"white"},children:Object(l.b)("words.unconfirmed")}),disconfirm:Object(p.jsx)(h,{color:_.a.calendar_disconfirm,style:{color:"white"},children:Object(l.b)("words.canceled")}),waiting:Object(p.jsx)(h,{color:_.a.calendar_waiting,style:{color:"white"},children:Object(l.b)("verbs.waiting")})}[e]||""),h=Object(b.d)(i.a).withConfig({componentId:"wb__sc-1wnsqqm-0"})(["margin-right:0 !important;"])},853:function(e,t,a){"use strict";var n=a(0),l=a(50),c=a(2937),i=a(116),s=a(20),r=a(250),o=a(18),d=a(582),b=a(27),u=a(37),j=a(2879);const m=u.e`
  query fetchDocumentTemplate (
    $id: ID, $client_id: ID, $employee_id: ID, $schedule_group_id: ID, $inventory_sale_id: ID,
    $inventory_package_id: ID, $finance_bill_rec_id: ID, $finance_bill_pay_id: ID, $inventory_purchase_id: ID
  ) {
    document_template (id: $id) {
      id name save_on_generation exchange_variables(
        client_id: $client_id, employee_id: $employee_id, schedule_group_id: $schedule_group_id,
        inventory_sale_id: $inventory_sale_id, inventory_package_id: $inventory_package_id,
        finance_bill_rec_id: $finance_bill_rec_id, finance_bill_pay_id: $finance_bill_pay_id,
        inventory_purchase_id: $inventory_purchase_id
      )
    }
  }
`;var _=()=>Object(j.a)(m,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),p=a(232),O=a(19),h=a(82),v=a(22);const g=Object(n.lazy)((()=>Object(p.a)((()=>Promise.all([a.e(13),a.e(157)]).then(a.bind(null,3084)))))),x=Object(n.lazy)((()=>Object(p.a)((()=>Promise.all([a.e(13),a.e(158)]).then(a.bind(null,3085)))))),y=(e,t)=>{const[a,r]=Object(n.useState)(!1),[u,j]=Object(n.useState)(),[m,p]=Object(n.useState)(),[O,y]=Object(n.useState)(),[w,k]=Object(n.useState)(!0),$=Object(s.o)(),C=Object(b.a)((e=>e.current_user.id)),D=Object(b.a)((e=>e.current_user.authentication_token)),I=Object(b.a)((e=>e.current_user.addons.has_upload_image)),M=Object(n.useRef)(null),[S]=c.a.useForm(),{setFieldsValue:F,getFieldsValue:z,resetFields:Y}=S,[E,{data:R,loading:T,called:N}]=_();Object(n.useEffect)((()=>{var e;N&&!T&&null!==R&&void 0!==R&&R.document_template&&(F({exchange_variables:null===R||void 0===R?void 0:R.document_template.exchange_variables}),k(null!==(e=R.document_template.save_on_generation)&&void 0!==e&&e))}),[null===R||void 0===R?void 0:R.document_template,T,N]);const P=Object(n.useCallback)((e=>{let{document_template_id:t,...a}=e;E({variables:{id:t,...a}}),r(!0),j(t),y(a.client_id);const n=a.schedule_group_id||a.inventory_sale_id||a.inventory_package_id||a.finance_bill_rec_id;p(n)}),[E]),G=Object(n.useCallback)((()=>{r(!1)}),[]);Object(n.useImperativeHandle)(t,(()=>({close:G,open:P})));const q=Object(n.useCallback)((()=>{$(`/subscription/addons?addon_id=${o.a.ID_UPLOAD_IMAGE}`)}),[$]),L=Object(n.useCallback)((e=>{const t=document.getElementById("generate-pdf-form");if(!t)return;const a=z();t.save_on_generation.value=e,t.exchange_variables.value=a.exchange_variables,t.submit()}),[z]),B=Object(n.useCallback)((()=>{I||!w?L(w):i.c.confirm({content:Object(l.b)("document_templates.upload_activation"),okText:Object(l.b)("verbs.contract"),okType:"primary",cancelText:Object(l.b)("verbs.cancel"),zIndex:1042,onOk:q,onCancel:()=>{k(!1),L(!1)}})}),[q,I,w,L]),V=Object(n.useCallback)((e=>{e||(Y(),j(void 0),y(void 0),p(void 0),k(!0))}),[Y]);return Object(v.jsxs)(f,{open:a,width:1650,height:"100%",onClose:G,destroyOnClose:!0,afterOpenChange:V,children:[Object(v.jsx)(c.a,{form:S,layout:"vertical",style:{height:"100%"},children:Object(v.jsx)(d.a,{Mobile:x,Desktop:g,title:null===R||void 0===R?void 0:R.document_template.name,loading:T,save_on_generation:w,setSaveOnGeneration:k,close:G,generatePDF:B,editorRef:M})}),Object(v.jsxs)("form",{id:"generate-pdf-form",action:`${h.a.API}/document_templates/generate_document`,method:"post",target:"_blank",children:[Object(v.jsx)("input",{type:"hidden",name:"document_template_id",value:u,readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"client_id",value:O,readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"class_id",value:m,readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"current_user_id",value:C,readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"authentication_token",value:D,readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"exchange_variables",readOnly:!0}),Object(v.jsx)("input",{type:"hidden",name:"save_on_generation",readOnly:!0})]})]})};y.displayName="GenerateDocumentDrawer";t.a=Object(n.memo)(Object(n.forwardRef)(y));const f=Object(O.d)(r.a).withConfig({componentId:"wb__sc-wueh2s-0"})([".ant-drawer-body{padding-left:0;padding-right:0;background:",";.tox-statusbar__branding{display:none;}}"],(e=>e.theme.is_mobile?"#f8f8f8":"transparent"))},989:function(e,t,a){"use strict";var n=a(50);const l={"":Object(n.b)("document_templates.class_types.without_origin"),ScheduleGroup:Object(n.b)("document_templates.class_types.schedule_group"),"Inventory::Sale":Object(n.b)("document_templates.class_types.inventory_sale"),"Inventory::Package":Object(n.b)("document_templates.class_types.inventory_package"),"Finance::BillRec":Object(n.b)("document_templates.class_types.finance_bill_rec"),"Finance::BillPay":Object(n.b)("document_templates.class_types.finance_bill_pay"),"Inventory::Purchase":Object(n.b)("document_templates.class_types.inventory_purchase")};t.a=l}}]);
//# sourceMappingURL=74.02bf748f.chunk.js.map