(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[93],{1450:function(e,t,a){"use strict";var s=a(0),r=a(250),o=a(616);var l=()=>Object(s.useMemo)((()=>[{title:"Servi\xe7o/Produto",key:"description",dataIndex:"description",align:"left",ellipsis:!0}]),[]),n=a(19),c=a(50),i=a(22);const d=(e,t)=>{const[a,o]=Object(s.useState)(!1),[n,d]=Object(s.useState)([]),u=Object(s.useCallback)((e=>{e&&d(e),o(!0)}),[]),_=Object(s.useCallback)((()=>{o(!1)}),[]);Object(s.useImperativeHandle)(t,(()=>({open:u,close:_})));const p=l();return Object(i.jsx)(r.b,{open:a,onClose:_,destroyOnClose:!0,title:Object(c.b)("words.association_other"),width:550,children:Object(i.jsx)(r.g,{children:Object(i.jsx)(b,{columns:p,dataSource:n,scroll:{y:window.innerHeight-132},pagination:!1,rowKey:"id",className:"drawer-table",size:"small"})})})};d.displayName="ProductAssociationDrawer";t.a=Object(s.memo)(Object(s.forwardRef)(d));const b=Object(n.d)(o.b).withConfig({componentId:"wb__sc-12zakpx-0"})([".ant-table-container table > thead > tr:first-child th:first-child{padding-left:30px !important;}"])},2963:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a(50),o=a(116),l=a(37);const n=l.e`
  query GroupsList (
    $page: Int, $results: Int, $search_query: String, $sort_field: String, $sort_order: String, $actives: Boolean,
  ) {
    all_inventory_groups (
      page: $page, results: $results, search_term: $search_query, sort_field: $sort_field, sort_order: $sort_order,
      actives: $actives, use_replica: true
    ) {
      all {
        id name active
      }
      total_count
    }
  }
`,c=l.e`
  query GroupsIdsList ($actives: Boolean) {
    all_inventory_groups (actives: $actives, use_replica: true) {
      all {
        id active
      }
    },
  }
`;var i=a(1450),d=a(627),b=a(896),u=a(216),_=a(27);var p=()=>Object(s.useMemo)((()=>[{label:Object(r.b)("words.status"),name:"actives",default_value:"true",double_checkbox:{true:Object(r.b)("words.active",{count:2}),false:Object(r.b)("words.inactive",{count:2})}}]),[]),j=a(852),h=a(1438),m=a(250),v=a(616),O=a(3034),f=a(2854),g=a(22);var y=e=>{let{openGroupDrawer:t,handleDestroyGroup:a,openProductAssociation:l}=e;const n=Object(_.a)((e=>e.inventory_products)),c=Object(_.a)((e=>e.current_user.permissions)),i=Object(s.useCallback)((e=>{c.can_destroy_product?o.c.confirm({centered:!0,className:"webook-modal",title:Object(r.b)("words.attention"),maskClosable:!0,content:Object(r.b)("phrases.confirm_delete",{model:Object(r.b)("words.category").toLocaleLowerCase(),context:"female"}),okText:Object(r.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(r.b)("verbs.cancel"),onOk:()=>a(e)}):o.b.warning(Object(r.b)("phrases.no_permission_to_do_this"))}),[a,c.can_destroy_product]);return Object(s.useMemo)((()=>[{title:Object(r.b)("words.name"),default_visible:!0,always_visible:!0,key:"name",dataIndex:"name",defaultSortOrder:"ascend",className:"table-sort",sorter:!0,ellipsis:!0,render:(e,a)=>Object(g.jsx)("button",{style:{maxWidth:"100%"},title:e,className:"link text-overflow-ellipsis",onClick:()=>t(a),children:e})},{title:Object(r.b)("words.item",{count:2}),default_visible:!0,key:"products",ellipsis:!0,width:260,render:(e,t)=>{const a=n.filter((e=>e.active&&e.group_id===t.id)),s=(null===a||void 0===a?void 0:a.length)||0;return s>0?Object(g.jsx)(m.i,{onClick:()=>l(a),children:Object(r.b)("groups_brands.has_associated_item",{count:s})}):Object(r.b)("groups_brands.no_associated_item")}},{default_visible:!0,key:"actions",always_visible:!0,align:"center",width:100,render:(e,a)=>Object(g.jsxs)(v.a,{width:84,children:[Object(g.jsx)(j.a,{title:Object(r.b)("verbs.view"),placement:"bottom",children:Object(g.jsx)("button",{className:"link",onClick:()=>t(a),children:Object(g.jsx)(O.a,{})})}),Object(g.jsx)(h.a,{type:"vertical"}),Object(g.jsx)("button",{className:"link color-red",onClick:()=>i(a.id),children:Object(g.jsx)(f.a,{})})]})}]),[i,n,t,l])},w=a(583);const x=e=>{const{item:t}=e,a=Object(_.a)((e=>e.inventory_products)),o=Object(s.useMemo)((()=>{if(!t)return 0;return a.filter((e=>e.active&&e.group_id===t.id)).length}),[t,a]);return Object(g.jsxs)(m.g,{$column:!0,children:[Object(g.jsx)(w.b,{width:10,$block:!0,children:null===t||void 0===t?void 0:t.name}),Object(g.jsx)(w.b,{width:20,$block:!0,$color:o>0?"primary":"gray_1",$size:12,children:o>0?Object(r.b)("groups_brands.has_associated_item",{count:o}):Object(r.b)("groups_brands.no_associated_item")})]})};x.displayName="BrandItemMobile";var k=Object(s.memo)(x),C=a(608),$=a(19);const S=e=>Object(r.b)("phrases.confirm_delete_female",{model:Object(r.b)("words.category",{count:e.length}).toLocaleLowerCase(),count:e.length,context:"female"}),I=$.d.div.withConfig({componentId:"wb__sc-2qgq14-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;background-color:#fbfbfb;border-radius:5px;box-shadow:0 2px 9px rgba(83,83,83,0.06);overflow:hidden;margin-bottom:15px;padding:10px;border:1px solid transparent;user-select:none;transition:transform .2s;"]);var M=a(667),q=a(1850);const D=l.e`
  mutation DestroyBrand($data: InventoryGroupDestroyInput!) {
    inventoryGroupDestroy(input: $data) {
      success
      errors
      has_products_associated
    }
  }
`;var N=()=>{const[e,{loading:t}]=Object(q.a)(D);return[async t=>{const a=o.b.loading(`${Object(r.b)("verbs.wait")}...`,0);try{const{data:s}=await e({variables:{data:{id:t}}}),{success:r=!1,errors:l=[],has_products_associated:n=!1}=(null===s||void 0===s?void 0:s.inventoryGroupDestroy)||{};return r||(n?null===l||void 0===l||l.forEach((e=>o.b.info(e))):null===l||void 0===l||l.forEach((e=>o.b.error(e)))),{success:r,has_products_associated:n}}catch(s){return o.b.error(Object(r.b)("phrases.generic_save_error_message")),console.error(s),{success:!1,has_products_associated:!1}}finally{a()}},t]};const R=l.e`
  mutation DestroyAllInventoryGroups($data: InventoryGroupDestroyAllInput!) {
    inventoryGroupDestroyAll(input: $data) {
      success
      failures { id code errors }
      errors
    }
  }
`;var z=()=>{const[e]=Object(q.a)(R);return[async t=>{const a=o.b.loading(`${Object(r.b)("verbs.wait")}...`,0);try{const{data:s}=await e({variables:{data:t}}),{success:r=!1,failures:l=[],errors:n=[]}=(null===s||void 0===s?void 0:s.inventoryGroupDestroyAll)||{};return null===n||void 0===n||n.map((e=>o.b.error(e))),{success:r,failures:l||[]}}catch(s){return o.b.error(Object(r.b)("phrases.generic_save_error_message")),console.error(s),{success:!1,failures:[]}}finally{a()}}]};t.default=()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),a=Object(s.useRef)(null),l=Object(_.a)((e=>e.current_user.permissions)),j=Object(u.b)(),[v]=N(),[O]=z(),w=Object(s.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.refetch(),j()}),[j]),x=Object(s.useCallback)((async e=>{const{success:t,failures:a=[]}=await O({ids:e});(t||0!==a.length)&&(e=>{let{ids:t,failures:a,afterSaveGroup:s}=e;const l=a.length===t.length,n=0===a.length,c=t.length-a.length;if(n)return o.b.success(`${c} ${Object(r.b)("phrases.deleted_successfully",{prefix:Object(r.b)("words.category",{count:c}).toLocaleLowerCase(),count:c,context:"female"})}`),void s();C.a.information({closable:!0,className:"webook-modal hide-buttons",maskClosable:!0,onCancel:()=>{l||s()},title:Object(r.b)("phrases.mass_delete_completed"),content:Object(g.jsxs)("div",{style:{maxHeight:400,width:"100%",maxWidth:480,overflowX:"hidden",overflowY:"auto"},children:[!l&&Object(g.jsxs)(m.h,{$size:16,$alignCenter:!0,$color:"green_2",children:[c,"\xa0",Object(r.b)("phrases.deleted_successfully",{prefix:Object(r.b)("words.category",{count:c}).toLocaleLowerCase(),count:c,context:"female"})]}),a.length>0&&Object(g.jsxs)(m.g,{$column:!0,$paddings:[0,10],children:[Object(g.jsx)(h.a,{dashed:!0}),Object(g.jsx)(m.h,{$size:16,$alignCenter:!0,$paddings:{bottom:10},children:Object(r.b)("phrases.failure_destroy_message",{model:Object(r.b)("words.category",{count:a.length}).toLocaleLowerCase(),count:a.length,context:"female"})}),a.map((e=>{let{id:t,code:a,errors:s=[]}=e;return Object(g.jsxs)(I,{children:[Object(g.jsx)(m.g,{$column:!0,style:{overflow:"hidden"},children:Object(g.jsxs)(m.h,{$size:16,$textEllipsis:!0,$block:!0,children:[Object(r.b)("words.item"),":\xa0",a]})}),Object(g.jsx)(m.g,{$column:!0,style:{overflow:"hidden"},$mTop:10,children:s.map((e=>Object(g.jsx)(m.h,{style:{color:"#FF7875"},children:e},`${e}_${t}`)))})]},`package_item_${t}`)}))]})]})})})({ids:e,failures:a,afterSaveGroup:w})}),[w,O]),$=Object(s.useCallback)((async e=>{const{success:t,has_products_associated:a}=await v(e);(t||a)&&w(),t&&o.b.success(Object(r.b)("phrases.deleted_successfully",{prefix:Object(r.b)("words.brand")}))}),[w,v]),q=Object(s.useCallback)((e=>{var a;null===(a=t.current)||void 0===a||a.open(e)}),[]),D=Object(s.useCallback)((e=>{l.can_edit_product?q(e):o.b.warning(Object(r.b)("phrases.no_permission_to_do_this"))}),[q,l.can_edit_product]),R=Object(s.useCallback)((e=>{var t;l.can_edit_product?null===(t=a.current)||void 0===t||t.open(e):o.b.warning(Object(r.b)("phrases.no_permission_to_do_this"))}),[l.can_edit_product]),G=y({openGroupDrawer:D,handleDestroyGroup:$,openProductAssociation:R}),L=p(),A=Object(M.a)(l.can_destroy_product,S,x),T=Object(s.useCallback)((e=>{var t;return null===e||void 0===e||null===(t=e.all_inventory_groups)||void 0===t?void 0:t.all}),[]),E=Object(s.useCallback)((e=>{var t;return(null===e||void 0===e||null===(t=e.all_inventory_groups)||void 0===t?void 0:t.total_count)||0}),[]),P=Object(s.useMemo)((()=>[{label:Object(r.b)("verbs.delete"),icon:Object(g.jsx)(f.a,{}),danger:!0,onClick:A,disabled:!l.can_destroy_product}]),[A,l.can_destroy_product]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(d.a,{ref:e,title:Object(r.b)("words.category_other"),permissions_key:"product",search_placeholder:Object(r.b)("input.search_by_name"),filters:L,columns:G,getData:T,query:n,openDrawer:q,mass_actions:P,MobileItem:k,getTotalCount:E,select_all_query:c}),Object(g.jsx)(b.a,{ref:t,onSave:w}),Object(g.jsx)(i.a,{ref:a})]})}},609:function(e,t,a){"use strict";var s=a(0),r=a(50),o=a(159),l=a(53),n=a.n(l),c=a(19),i=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(i.jsx)(b,{children:u.map((e=>{let{label:a,value:s}=e;return Object(i.jsx)(o.a,{type:"primary",onClick:()=>t(s),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(s.memo)(d);const b=c.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(r.b)("words.today"),value:[n()(),n()()]},{label:Object(r.b)("date.last_week"),value:[n()().startOf("week").subtract(1,"week"),n()().endOf("week").subtract(1,"week")]},{label:Object(r.b)("date.last_month"),value:[n()().subtract(1,"month").startOf("month"),n()().subtract(1,"month").endOf("month")]},{label:Object(r.b)("date.current_month"),value:[n()().startOf("month"),n()().endOf("month")]},{label:Object(r.b)("date.six_months_ago"),value:[n()().subtract(6,"month"),n()()]},{label:Object(r.b)("date.one_year_ago"),value:[n()().subtract(12,"month"),n()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return _})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return j})),a.d(t,"a",(function(){return h}));var s=a(19),r=a(0),o=a(2934),l=a(609),n=a(22);const c=(e,t)=>{let{onRangeChange:a,...s}=e;const[c,i]=Object(r.useState)(!1),b=Object(r.useCallback)((e=>{a(e)}),[a]);return Object(n.jsx)(o.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(n.jsx)(d,{children:Object(n.jsx)(l.a,{handleChangeRange:b})}),...s,open:c,onOpenChange:i})};c.displayName="SimpleRangePicker";var i=Object(r.memo)(Object(r.forwardRef)(c));const d=s.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,s]=e;s in b&&(t[a]=b[s])})),Object.entries(e).forEach((e=>{let[t,s]=e;u.includes(t)&&(a[t]=null===s||void 0===s?void 0:s.format("YYYY-MM-DD"))})),{...e,...t,...a}},p=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(s.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),j=Object(s.d)(i).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),h=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(s.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var s=a(0),r=a(50),o=a(2937),l=a(137),n=a(578),c=a(116),i=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var _=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},p=a(53),j=a.n(p),h=a(635),m=a(22);const v={ascend:"ASC",descend:"DESC"},O=e=>e?j()(e):null;var f=a(405),g=a(610),y=a(27),w=a(582),x=a(1814),k=a(148);var C=e=>{const{total_count:t,records:a,results:o,select_all_query:l,validateRow:n=(e=>!0),rowSelector:i=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(s.useState)([]),[u,_]=Object(s.useState)(!1),[p,j]=Object(s.useState)(!1),[h,v]=Object(s.useState)(!1),O=Object(k.a)(),f=Object(s.useCallback)((()=>{_(!1),b([]),v(!1)}),[]),g=Object(s.useCallback)((()=>{const e=c.b.loading(`${Object(r.b)("verbs.selecting")}...`,0);j(!0);const{query:t,variables:a,resolve:s}=l;O.query({query:t,variables:a,fetchPolicy:"network-only"}).then(s((e=>{_(!0),b(i(e))}))).catch((e=>console.error(e))).then((()=>{e(),j(!1)}))}),[O,i,l]),y=Object(s.useCallback)(((e,t)=>{b(i(t))}),[]),w=Object(s.useMemo)((()=>a.filter(n)),[a,n]);return Object(s.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:w,total_count:t,resetSelected:f,records:a,results:o,selectAll:g,onChange:y,is_select_mode:h,setIsSelectMode:v,is_selecting_all:p,setSelectedAll:_,setIsSelectingAll:j,getCheckboxProps:e=>({disabled:!n(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(m.jsx)(x.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<w.length)return b(i(w));f()}})})),[u,d,t,f,a,o,g,y,n,w,h,v,p])},$=a(597),S=a(232);const I=Object(s.lazy)((()=>Object(S.a)((()=>a.e(12).then(a.bind(null,968)))))),M=Object(s.lazy)((()=>Object(S.a)((()=>a.e(7).then(a.bind(null,969)))))),q=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(m.jsx)($.b,{title:t,onSearch:e,children:Object(m.jsx)(w.a,{Desktop:I,Mobile:M})})};q.displayName="DefaultHeader";var D=q,N=a(76);const R=Object(s.lazy)((()=>Object(S.a)((()=>a.e(94).then(a.bind(null,2909)))))),z=Object(s.lazy)((()=>Object(S.a)((()=>a.e(67).then(a.bind(null,3082)))))),G=e=>!(null===e||void 0===e||!e.active),L=e=>null===e||void 0===e?void 0:e.id,A=(e,t)=>{var a,p;const{columns:j,filters:x,extra_actions:k,query:$,getTotalCount:S,getData:I,select_all_query:M,validateRow:q=G,rowSelectorKey:A=L,Header:T,expandedRowKeys:E,title:P,storage_key:F=P,has_feature:H=!0,use_storage:K=!0,addon_id:Y,has_joyride:B=!0,show_create_button:J=!0,item_selectable:V=!0,parseFilters:W=g.d,rowClassName:X,mobileSwipeLeft:Q}=e,U=Object(y.a)((e=>e.current_user.permissions)),Z=Object(y.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${F}`,[te]=o.a.useForm(),ae=(null===(a=j.find((e=>e.sorter)))||void 0===a?void 0:a.key)||j[0].key,se=(null===(p=j.find((e=>e.defaultSortOrder)))||void 0===p?void 0:p.defaultSortOrder)||j[0].defaultSortOrder||"ascend",re=Object(s.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:s,local_storage_key:r,visible_columns:o,use_storage:l}=e,n=Object(d.c)(r);if(n&&l){const e=null===n||void 0===n?void 0:n.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...n,filters_value:{...n.filters_value,start_date:O(n.filters_value.start_date),end_date:O(n.filters_value.end_date),birthday_start_date:O(n.filters_value.birthday_start_date),birthday_end_date:O(n.filters_value.birthday_end_date),start_date_open:O(n.filters_value.start_date_open),start_date_close:O(n.filters_value.start_date_close),end_date_open:O(n.filters_value.end_date_open),end_date_close:O(n.filters_value.end_date_close)}}:n}const c=null===s||void 0===s?void 0:s.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:v[t],filters_value:c,visible_columns:o}})({local_storage_key:ee,filters:x,default_sort_field:ae,default_sort_order:se,visible_columns:j.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:K})),[j,ae,se,x,ee,K]),[oe,le]=Object(s.useReducer)(_,re);Object(n.a)((()=>{Object(d.d)(ee,{...oe,page:1})}),[oe]);const[ne,ce]=Object(s.useState)(""),[ie,de]=Object(s.useState)([]),[be,ue]=Object(s.useState)(0),_e=Object(s.useRef)(!1),pe=(e=>{const{columns:t,visible_columns:a=[],dispatch:s}=e,r=t.filter((e=>a.includes(e.key)||e.always_visible)),o=r.findIndex((e=>"actions"===e.key));return o&&(r[o]={...r[o],title:Object(m.jsx)(h.a,{columns:t,visible_columns:a,dispatch:s})}),r})({dispatch:le,columns:j,visible_columns:oe.visible_columns}),je={...Object(s.useMemo)((()=>j.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=oe.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[j,oe.visible_columns]),...W(oe.filters_value),is_mobile:Z,search_query:ne,sort_field:oe.sort_field,sort_order:oe.sort_order,page:oe.page,results:oe.results},{loading:he,refetch:me}=Object(f.f)($,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:je,skip:!H,onError:e=>{console.log(e),N.a.captureException(e),c.b.error(Object(r.b)("phrases.loading_error"))},onCompleted:e=>{ue(S(e)),1!==oe.page&&_e.current?de((t=>[...t,...I(e)||[]])):de(I(e)||[])}}),ve=Object(s.useCallback)((()=>{if(1===oe.page)return me();le({type:"set_page",payload:1})}),[oe.page,me]),Oe=Object(s.useCallback)((()=>{_e.current=!0,le({type:"set_page",payload:oe.page+1})}),[oe.page]),fe=Object(s.useCallback)(((e,t,a)=>{a.order&&(le({type:"set_sort_field",payload:a.field}),le({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&le({type:"set_page",payload:e.current}),e.pageSize&&le({type:"set_results",payload:e.pageSize})}),[]),ge=C({total_count:be,results:oe.results,records:ie,select_all_query:{query:M,variables:je,resolve:e=>t=>{let{data:a}=t;return e(I(a)||[])}},validateRow:q,rowSelector:Object(s.useCallback)((e=>e.filter(q).map(A)),[A,q])}),ye=Object(s.useMemo)((()=>E?E(ie):void 0),[ie,E]),we=Object(s.useCallback)((e=>{me(),ge.resetSelected();const t=Math.ceil((be-e)/oe.results);oe.page>t&&le({type:"set_page",payload:t})}),[oe.page,me,oe.results,ge,be]),xe=Object(s.useCallback)((e=>{le({type:"set_page",payload:1}),ce(e)}),[ce]),ke=Object(s.useCallback)((e=>{le({type:"set_filters_value",payload:e}),le({type:"set_page",payload:1})}),[]),Ce=Object(s.useMemo)((()=>H?e.permissions?e.permissions:e.permissions_key?{can_create:U[`can_create_${e.permissions_key}`],can_edit:U[`can_edit_${e.permissions_key}`],can_access:U[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[H,e.permissions,e.permissions_key,U]),$e=Object(s.useCallback)((()=>{if(ge.resetSelected(),Z)return 1===oe.page?void me():void le({type:"set_page",payload:1});me()}),[Z,me,ge,oe.page]);Object(s.useImperativeHandle)(t,(()=>({afterDestroyRecord:we,refetch:$e})));const Se=Object(s.useMemo)((()=>({onSearch:xe,row_selection:ge,onFiltersChange:ke,data_source:ie,form:te,total_count:be,loading:he,new_columns:pe,onChange:fe,expanded_row_keys:ye,refetch:ve,handleFetchMore:Oe,...e,has_feature:H,addon_id:Y,has_joyride:B,show_create_button:J,item_selectable:V,validateRow:q,rowSelectorKey:A,permissions:Ce,...oe,dispatch:le,rowClassName:X,extra_actions:k})),[xe,ge,ke,ie,te,be,he,pe,fe,ye,ve,Oe,e,H,B,J,q,A,Ce,oe,X,k,V,Y]),Ie=Object(s.useMemo)((()=>null===x||void 0===x?void 0:x.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[x]);return Object(m.jsx)(b.a.Provider,{value:Se,children:Object(m.jsxs)(i.b,{children:[T?Object(m.jsx)(T,{}):Object(m.jsx)(D,{}),Object(m.jsx)(o.a,{form:te,component:!1,layout:"vertical",onChange:Object(l.debounce)(ke,1e3),initialValues:{...Ie,...oe.filters_value},children:Object(m.jsx)(w.a,{Desktop:R,Mobile:z,mobileSwipeLeft:Q})})]})})};A.displayName="MagicTable";t.a=Object(s.memo)(Object(s.forwardRef)(A))},635:function(e,t,a){"use strict";var s=a(0),r=a(50),o=a(1809),l=a(852),n=a(1814),c=a(3052),i=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:n,setVisibleColumns:i}=e;const[b,_]=Object(s.useState)(!1),p=Object(s.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===n||void 0===n||n({type:"set_visible_columns",payload:e}),null===i||void 0===i||i(e)}),[t,n,i]),j=Object(s.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===n||void 0===n||n({type:"set_visible_columns",payload:t}),void(null===i||void 0===i||i(t))}const t=[...a,e];null===n||void 0===n||n({type:"set_visible_columns",payload:t}),null===i||void 0===i||i(t)}),[n,i,a]),h=Object(s.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const s={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>j(t.key),checked:a.includes(t.key),children:t.title})};return[...e,s]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(r.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:p,children:Object(r.b)("words.default")})]}),children:e}]}),[t,p,j,a]);return Object(d.jsx)(o.a,{menu:{items:h},trigger:["click"],open:b,onOpenChange:_,className:"no-print table-configuration",children:Object(d.jsx)(l.a,{title:Object(r.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(c.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(i.d)(n.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])},667:function(e,t,a){"use strict";var s=a(0),r=a(50),o=a(116);t.a=(e,t,a)=>Object(s.useCallback)((s=>{e?o.c.confirm({centered:!0,className:"webook-modal",title:Object(r.b)("words.attention"),maskClosable:!0,content:t(s),okText:Object(r.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(r.b)("verbs.cancel"),onOk:()=>{a(s)}}):o.b.warning(Object(r.b)("phrases.no_permission_to_do_this"))}),[a,e,t])}}]);
//# sourceMappingURL=93.908991a3.chunk.js.map