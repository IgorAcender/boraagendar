(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[29],{1216:function(e,t,a){"use strict";var s=a(13),n=a(0),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},r=a(71),i=function(e,t){return n.createElement(r.a,Object(s.a)({},e,{ref:t,icon:l}))},c=n.forwardRef(i);t.a=c},1651:function(e,t,a){"use strict";var s=a(0),n=a(50),l=a(1836),r=a(1216),i=a(598),c=a(582),o=a(597),d=a(232),b=a(22);const u=Object(s.lazy)((()=>Object(d.a)((()=>a.e(12).then(a.bind(null,968)))))),p=Object(s.lazy)((()=>Object(d.a)((()=>a.e(7).then(a.bind(null,969)))))),j=()=>{const e=Object(i.b)((e=>e.onSearch)),t=Object(i.b)((e=>e.title));return Object(b.jsx)(o.b,{title:t,onSearch:e,tabs:[{label:Object(n.b)("words.anamnesi",{count:2}),path:"/anamnesis",icon:l.a},{label:Object(n.b)("words.anamnesi_template",{count:2}),path:"/anamnesis-templates",icon:r.a}],children:Object(b.jsx)(c.a,{Desktop:u,Mobile:p})})};j.displayName="Header",t.a=j},1803:function(e,t,a){"use strict";var s=a(0),n=a(50),l=a(116),r=a(250),i=a(640),c=a(137);const o={required_signature:!1,fields:[]};var d=(e,t)=>{switch(console.debug("[AnamnesisTemplateReducer]",t.type,t.payload),t.type){case"reset_anamnesis_template":return o;case"set_anamnesis_template":return t.payload;case"change_name":return{...e,name:t.payload};case"change_required_signature":return{...e,required_signature:t.payload};case"change_field_type":return b(e,t.payload.id,t.payload.type);case"change_field_label":return u(e,t.payload.id,t.payload.label);case"change_field_required":return p(e,t.payload.id,t.payload.required);case"add_field":return{...e,fields:[...e.fields,t.payload]};case"remove_field":return j(e,t.payload.field_id);case"change_order":return O(e,t.payload.field_id,t.payload.direction);case"add_option":return _(e,t.payload.field_id,t.payload.option);case"change_option":return m(e,t.payload.field_id,t.payload.option_id,t.payload.value);case"remove_option":return h(e,t.payload.field_id,t.payload.option_id);default:return e}};const b=(e,t,a)=>{const s=Object(c.cloneDeep)(e.fields),n=s.find((e=>e.id===t));return n?(n.type=a,{...e,fields:s}):e},u=(e,t,a)=>{const s=Object(c.cloneDeep)(e.fields),n=s.find((e=>e.id===t));return n?(n.label=a,{...e,fields:s}):e},p=(e,t,a)=>{const s=Object(c.cloneDeep)(e.fields),n=s.find((e=>e.id===t));return n?(n.required=a,{...e,fields:s}):e},j=(e,t)=>{const a=Object(c.cloneDeep)(e.fields).filter((e=>e.id!==t));return{...e,fields:a}},_=(e,t,a)=>{const s=Object(c.cloneDeep)(e.fields),n=s.find((e=>e.id===t));return n?(n.options=[...n.options||[],a],{...e,fields:s}):e},m=(e,t,a,s)=>{var n;const l=Object(c.cloneDeep)(e.fields),r=l.find((e=>e.id===t));if(!r)return e;const i=null===(n=r.options)||void 0===n?void 0:n.find((e=>e.id===a));return i?(i.value=s,{...e,fields:l}):e},h=(e,t,a)=>{var s;const n=Object(c.cloneDeep)(e.fields),l=n.find((e=>e.id===t));if(!l)return e;const r=null===(s=l.options)||void 0===s?void 0:s.filter((e=>e.id!==a));return l.options=r,{...e,fields:n}},O=(e,t,a)=>{const s=Object(c.cloneDeep)(e.fields),n=s.findIndex((e=>e.id===t)),l=n+a;if(-1===l)return e;const r=s.splice(n,1)[0];return s.splice(l,0,r),{...e,fields:s}},v=Object(i.a)({anamnesis_template:o,save_loading:!1,loading:!1,anamnesisTemplateDispatch:e=>{}});var f=e=>Object(i.b)(v,e),g=a(37),y=a(1850),x=a(76);const w=g.e`
  mutation SaleDrawerSaveSale ($data: SaveAnamnesisTemplateInput!) {
    saveAnamnesisTemplate (input: $data) {
      success
      errors
    }
  }
`;var k=()=>{const[e,{loading:t}]=Object(y.a)(w);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:s=!1,errors:n=[]}=(null===a||void 0===a?void 0:a.saveAnamnesisTemplate)||{};return null===n||void 0===n||n.forEach((e=>l.b.error(e))),{success:s}}catch(a){return x.a.captureException(a),l.b.error(Object(n.b)("phrases.generic_save_error_message")),console.error(a),{success:!1}}},{loading:t}]},C=a(2879);const S=g.e`
  query AnamnesisTemplateDrawerFetch ($id: ID) {
    anamnesis_template(id: $id, with_deleted: true) {
      id
      name
      fields
      required_signature
    }
  }
`;var q=e=>Object(C.a)(S,{fetchPolicy:"network-only",onCompleted:t=>{const{anamnesis_template:a}=t;(t=>{var a;const s=null===(a=JSON.parse(t.fields))||void 0===a?void 0:a.map((e=>({id:e.key_number,type:e.type,required:e.required,label:e.label,options:e.options}))),n={id:t.id,required_signature:t.required_signature,name:t.name,fields:s};e({type:"set_anamnesis_template",payload:n})})(a)},onError:e=>{x.a.captureException(e),console.log(e)}}),D=a(27),I=a(2937),M=a(2883),R=a(2824),T=a(1227),z=a(3023),N=a(447),E=a(3050),H=a(3051),$=a(543),A=a(159),V=a(1256),F=a(1438),L=a(22);var P=()=>{const[e,t]=Object(s.useState)(),[a,l]=Object(s.useState)(!1),r=f((e=>e.anamnesisTemplateDispatch));return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)($.a,{gutter:8,children:[Object(L.jsx)(M.a,{xs:{span:8,order:4},md:{span:3,order:1},children:Object(L.jsxs)(I.a.Item,{label:Object(n.b)("verbs.sort"),children:[Object(L.jsx)(A.a,{style:{padding:"6px 12px"},type:"text",disabled:!0,children:Object(L.jsx)(E.a,{})}),Object(L.jsx)(A.a,{style:{padding:"6px 12px"},type:"text",disabled:!0,children:Object(L.jsx)(H.a,{})})]})}),Object(L.jsx)(M.a,{xs:{span:17,order:1},md:{span:6,order:2},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.type"),children:Object(L.jsxs)(V.a,{placeholder:Object(n.b)("phrases.select",{model:Object(n.b)("words.type").toLocaleLowerCase()}),value:null,onChange:s=>{r({type:"add_field",payload:{id:Object(N.a)(),label:e,required:a,type:s}}),t(void 0),l(!1)},children:[Object(L.jsx)(V.a.Option,{value:"string",children:Object(n.b)("words.short_text")}),Object(L.jsx)(V.a.Option,{value:"text",children:Object(n.b)("words.text")}),Object(L.jsx)(V.a.Option,{value:"number",children:Object(n.b)("words.number")}),Object(L.jsx)(V.a.Option,{value:"multiple_choices",children:Object(n.b)("words.multiple_choices")}),Object(L.jsx)(V.a.Option,{value:"combobox",children:Object(n.b)("words.list")}),Object(L.jsx)(V.a.Option,{value:"radio",children:Object(n.b)("words.single_choice")}),Object(L.jsx)(V.a.Option,{value:"image",children:Object(n.b)("words.image")})]})})}),Object(L.jsx)(M.a,{xs:{span:14,order:3},md:{span:10,order:3},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.label"),children:Object(L.jsx)(R.a,{placeholder:Object(n.b)("anamnesis.inform_the_label"),value:e,onChange:e=>t(e.target.value)})})}),Object(L.jsx)(M.a,{xs:{span:7,order:2},md:{span:3,order:4},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.required"),children:Object(L.jsx)(z.a,{checked:a,onChange:e=>l(e)})})}),Object(L.jsx)(M.a,{span:2,order:5})]}),Object(L.jsx)(F.a,{style:{marginTop:10,marginBottom:15}})]})},B=a(2854),K=a(2843);const Y=e=>{let{field_id:t,options:a}=e;const s=Object(D.a)((e=>e.is_mobile)),l=f((e=>e.anamnesisTemplateDispatch));return Object(L.jsxs)("div",{style:{marginLeft:s?20:100},children:[null===a||void 0===a?void 0:a.map(((e,a)=>Object(L.jsxs)($.a,{gutter:8,children:[Object(L.jsx)(M.a,{flex:"1",children:Object(L.jsx)(I.a.Item,{style:{marginBottom:12},label:`${Object(n.b)("words.option")} ${a+1}`,children:Object(L.jsx)(R.a,{placeholder:Object(n.b)("anamnesis.insert_the_option"),value:e.value,onChange:a=>{return s=e.id,n=a.target.value,void l({type:"change_option",payload:{field_id:t,option_id:s,value:n}});var s,n}})})}),Object(L.jsx)(M.a,{flex:"54px",children:Object(L.jsx)(A.a,{type:"text",size:"large",style:{marginTop:28},className:"link color-red",onClick:()=>{return a=e.id,void l({type:"remove_option",payload:{field_id:t,option_id:a}});var a},children:Object(L.jsx)(B.a,{})})})]},e.id))),Object(L.jsx)($.a,{gutter:8,style:{marginBottom:5},children:Object(L.jsxs)(r.i,{onClick:()=>{l({type:"add_option",payload:{field_id:t,option:{id:Object(N.a)()}}})},children:[Object(L.jsx)(K.a,{})," ",Object(n.b)("anamnesis.add_option")]})})]})};Y.displayName="Options";var J=Y;var G=e=>{let{field:t}=e;const a=Object(D.a)((e=>e.is_mobile)),s=f((e=>e.anamnesisTemplateDispatch)),l=e=>{s({type:"change_order",payload:{field_id:t.id,direction:e}})},r="combobox"===t.type||"multiple_choices"===t.type||"radio"===t.type;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)($.a,{gutter:8,children:[Object(L.jsx)(M.a,{xs:{span:8,order:4},md:{span:3,order:1},children:Object(L.jsxs)(I.a.Item,{label:Object(n.b)("verbs.sort"),children:[Object(L.jsx)(A.a,{style:{padding:"6px 12px"},type:"text",onClick:()=>l(-1),children:Object(L.jsx)(E.a,{})}),Object(L.jsx)(A.a,{style:{padding:"6px 12px"},type:"text",onClick:()=>l(1),children:Object(L.jsx)(H.a,{})})]})}),Object(L.jsx)(M.a,{xs:{span:18,order:1},md:{span:6,order:2},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.type"),children:Object(L.jsxs)(V.a,{value:t.type,onChange:e=>{s({type:"change_field_type",payload:{id:t.id,type:e}})},children:[Object(L.jsx)(V.a.Option,{value:"string",children:Object(n.b)("words.short_text")}),Object(L.jsx)(V.a.Option,{value:"text",children:Object(n.b)("words.text")}),Object(L.jsx)(V.a.Option,{value:"number",children:Object(n.b)("words.number")}),Object(L.jsx)(V.a.Option,{value:"multiple_choices",children:Object(n.b)("words.multiple_choices")}),Object(L.jsx)(V.a.Option,{value:"combobox",children:Object(n.b)("words.list")}),Object(L.jsx)(V.a.Option,{value:"radio",children:Object(n.b)("words.single_choice")}),Object(L.jsx)(V.a.Option,{value:"image",children:Object(n.b)("words.image")})]})})}),Object(L.jsx)(M.a,{xs:{span:14,order:3},md:{span:10,order:3},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.label"),children:Object(L.jsx)(R.a,{placeholder:Object(n.b)("anamnesis.inform_the_label"),value:t.label,onChange:e=>{return a=e.target.value,void s({type:"change_field_label",payload:{id:t.id,label:a}});var a}})})}),Object(L.jsx)(M.a,{xs:{span:6,order:2},md:{span:3,order:4},children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.required"),children:Object(L.jsx)(z.a,{checked:t.required,onChange:e=>{s({type:"change_field_required",payload:{id:t.id,required:e}})}})})}),Object(L.jsx)(M.a,{span:2,order:5,children:Object(L.jsx)(A.a,{size:"large",type:"text",style:{marginTop:a?25:30,padding:"6px 0"},className:"link color-red",onClick:()=>{s({type:"remove_field",payload:{field_id:t.id}})},children:Object(L.jsx)(B.a,{})})})]}),r&&Object(L.jsx)(J,{field_id:t.id,options:t.options}),Object(L.jsx)(F.a,{style:{marginTop:5,marginBottom:15}})]})},Q=a(3048);const U=()=>{const[e,t]=Object(s.useState)(),[a,l]=Object(s.useState)(!1),i=Object(s.useRef)(),c=f((e=>e.anamnesis_template.name)),o=f((e=>e.anamnesis_template.required_signature)),d=f((e=>e.anamnesisTemplateDispatch)),b=f((e=>e.anamnesis_template.fields));return Object(s.useEffect)((()=>{a||c&&(l(!0),t(c))}),[a,c]),Object(s.useEffect)((()=>{const e=setTimeout((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.focus()}),500);return()=>{clearTimeout(e)}}),[]),Object(L.jsxs)(I.a,{layout:"vertical",style:{width:"100%"},children:[Object(L.jsxs)(r.g,{gutter:8,$wrap:!0,children:[Object(L.jsx)(M.a,{xs:24,sm:18,children:Object(L.jsx)(I.a.Item,{label:Object(n.b)("words.name"),required:!0,children:Object(L.jsx)(R.a,{ref:i,placeholder:Object(n.b)("anamnesis.inform_the_model_name"),value:e,onChange:e=>{const a=e.target.value;t(a),d({type:"change_name",payload:a})}})})}),Object(L.jsx)(M.a,{xs:24,sm:6,children:Object(L.jsx)(I.a.Item,{label:Object(L.jsxs)(L.Fragment,{children:[Object(n.b)("anamnesis_template.need_to_sign"),Object(L.jsx)(T.a,{trigger:["hover","click"],title:Object(n.b)("phrases.digital_signature"),content:Object(n.b)("anamnesis_template.need_to_sign_description"),children:Object(L.jsx)(Q.a,{style:{paddingLeft:5}})})]}),children:Object(L.jsx)(z.a,{checked:o,onChange:e=>{d({type:"change_required_signature",payload:e})}})})})]}),b.map((e=>Object(L.jsx)(G,{field:e},e.id))),Object(L.jsx)(P,{})]})};U.displayName="AnamnesisTemplateForm";var W=U,X=a(339),Z=a(581),ee=a(19);const te=(e,t)=>{let{afterSave:a}=e;const i=Object(D.a)((e=>e.is_mobile)),[c,b]=Object(s.useState)(!1),[u,p]=Object(s.useReducer)(d,o),[j,{loading:_}]=k(),[m,{loading:h}]=q(p),O=Object(s.useCallback)((e=>{e&&m({variables:{id:e}}),b(!0)}),[m]),f=Object(s.useCallback)((()=>{b(!1)}),[]);Object(s.useImperativeHandle)(t,(()=>({open:O,close:f})));const g=Object(s.useMemo)((()=>({anamnesis_template:u,anamnesisTemplateDispatch:p,save_loading:_,loading:h})),[u,h,_]);return Object(L.jsx)(r.a,{open:c,title:Object(n.b)("words.anamnesi_template"),placement:i?"bottom":"right",height:"100%",onClose:f,width:800,closable:!0,destroyOnClose:!0,afterOpenChange:e=>{e||p({type:"reset_anamnesis_template"})},footer:Object(L.jsx)(Z.a,{close:f,submit:async()=>{if(!u.name)return void l.b.error(Object(n.b)("anamnesis.inform_the_model_name"));const e=u.fields.filter((e=>e.label)).map((e=>{var t;const a="combobox"===e.type||"multiple_choices"===e.type||"radio"===e.type,s=null===(t=e.options)||void 0===t?void 0:t.filter((e=>!!e.value));return{key_number:e.id,type:e.type,required:e.required,label:e.label,options:a?s:void 0}}));if(0===e.length)return void l.b.error(Object(n.b)("anamnesis.inform_at_least_one_field"));const t={id:u.id,required_signature:u.required_signature,name:u.name,fields:e},{success:s}=await j(t);s&&(l.b.success(Object(n.b)("phrases.saved_successfully",{prefix:Object(n.b)("words.anamnesi_template")})),f(),null===a||void 0===a||a())},loading:_||h}),push:!1,children:Object(L.jsx)(v.Provider,{value:g,children:Object(L.jsxs)(ae,{children:[Object(L.jsx)(X.a,{loading:h}),Object(L.jsx)(W,{})]})})})};te.displayName="AnamnesisTemplateDrawer";t.a=Object(s.forwardRef)(te);const ae=ee.d.div.withConfig({componentId:"wb__sc-s65bxj-0"})(["position:relative;height:100%;width:100%;"])},1836:function(e,t,a){"use strict";var s=a(13),n=a(0),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 112H724V72c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v40H500V72c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v40H320c-17.7 0-32 14.3-32 32v120h-96c-17.7 0-32 14.3-32 32v632c0 17.7 14.3 32 32 32h512c17.7 0 32-14.3 32-32v-96h96c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM664 888H232V336h218v174c0 22.1 17.9 40 40 40h174v338zm0-402H514V336h.2L664 485.8v.2zm128 274h-56V456L544 264H360v-80h68v32c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-32h152v32c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-32h68v576z"}}]},name:"snippets",theme:"outlined"},r=a(71),i=function(e,t){return n.createElement(r.a,Object(s.a)({},e,{ref:t,icon:l}))},c=n.forwardRef(i);t.a=c},609:function(e,t,a){"use strict";var s=a(0),n=a(50),l=a(159),r=a(53),i=a.n(r),c=a(19),o=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(o.jsx)(b,{children:u.map((e=>{let{label:a,value:s}=e;return Object(o.jsx)(l.a,{type:"primary",onClick:()=>t(s),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(s.memo)(d);const b=c.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(n.b)("words.today"),value:[i()(),i()()]},{label:Object(n.b)("date.last_week"),value:[i()().startOf("week").subtract(1,"week"),i()().endOf("week").subtract(1,"week")]},{label:Object(n.b)("date.last_month"),value:[i()().subtract(1,"month").startOf("month"),i()().subtract(1,"month").endOf("month")]},{label:Object(n.b)("date.current_month"),value:[i()().startOf("month"),i()().endOf("month")]},{label:Object(n.b)("date.six_months_ago"),value:[i()().subtract(6,"month"),i()()]},{label:Object(n.b)("date.one_year_ago"),value:[i()().subtract(12,"month"),i()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return _})),a.d(t,"a",(function(){return m}));var s=a(19),n=a(0),l=a(2934),r=a(609),i=a(22);const c=(e,t)=>{let{onRangeChange:a,...s}=e;const[c,o]=Object(n.useState)(!1),b=Object(n.useCallback)((e=>{a(e)}),[a]);return Object(i.jsx)(l.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(i.jsx)(d,{children:Object(i.jsx)(r.a,{handleChangeRange:b})}),...s,open:c,onOpenChange:o})};c.displayName="SimpleRangePicker";var o=Object(n.memo)(Object(n.forwardRef)(c));const d=s.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,s]=e;s in b&&(t[a]=b[s])})),Object.entries(e).forEach((e=>{let[t,s]=e;u.includes(t)&&(a[t]=null===s||void 0===s?void 0:s.format("YYYY-MM-DD"))})),{...e,...t,...a}},j=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(s.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),_=Object(s.d)(o).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),m=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(s.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var s=a(0),n=a(50),l=a(2937),r=a(137),i=a(578),c=a(116),o=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var p=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},j=a(53),_=a.n(j),m=a(635),h=a(22);const O={ascend:"ASC",descend:"DESC"},v=e=>e?_()(e):null;var f=a(405),g=a(610),y=a(27),x=a(582),w=a(1814),k=a(148);var C=e=>{const{total_count:t,records:a,results:l,select_all_query:r,validateRow:i=(e=>!0),rowSelector:o=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(s.useState)([]),[u,p]=Object(s.useState)(!1),[j,_]=Object(s.useState)(!1),[m,O]=Object(s.useState)(!1),v=Object(k.a)(),f=Object(s.useCallback)((()=>{p(!1),b([]),O(!1)}),[]),g=Object(s.useCallback)((()=>{const e=c.b.loading(`${Object(n.b)("verbs.selecting")}...`,0);_(!0);const{query:t,variables:a,resolve:s}=r;v.query({query:t,variables:a,fetchPolicy:"network-only"}).then(s((e=>{p(!0),b(o(e))}))).catch((e=>console.error(e))).then((()=>{e(),_(!1)}))}),[v,o,r]),y=Object(s.useCallback)(((e,t)=>{b(o(t))}),[]),x=Object(s.useMemo)((()=>a.filter(i)),[a,i]);return Object(s.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:x,total_count:t,resetSelected:f,records:a,results:l,selectAll:g,onChange:y,is_select_mode:m,setIsSelectMode:O,is_selecting_all:j,setSelectedAll:p,setIsSelectingAll:_,getCheckboxProps:e=>({disabled:!i(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(h.jsx)(w.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<x.length)return b(o(x));f()}})})),[u,d,t,f,a,l,g,y,i,x,m,O,j])},S=a(597),q=a(232);const D=Object(s.lazy)((()=>Object(q.a)((()=>a.e(12).then(a.bind(null,968)))))),I=Object(s.lazy)((()=>Object(q.a)((()=>a.e(7).then(a.bind(null,969)))))),M=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(h.jsx)(S.b,{title:t,onSearch:e,children:Object(h.jsx)(x.a,{Desktop:D,Mobile:I})})};M.displayName="DefaultHeader";var R=M,T=a(76);const z=Object(s.lazy)((()=>Object(q.a)((()=>a.e(94).then(a.bind(null,2909)))))),N=Object(s.lazy)((()=>Object(q.a)((()=>a.e(67).then(a.bind(null,3082)))))),E=e=>!(null===e||void 0===e||!e.active),H=e=>null===e||void 0===e?void 0:e.id,$=(e,t)=>{var a,j;const{columns:_,filters:w,extra_actions:k,query:S,getTotalCount:q,getData:D,select_all_query:I,validateRow:M=E,rowSelectorKey:$=H,Header:A,expandedRowKeys:V,title:F,storage_key:L=F,has_feature:P=!0,use_storage:B=!0,addon_id:K,has_joyride:Y=!0,show_create_button:J=!0,item_selectable:G=!0,parseFilters:Q=g.d,rowClassName:U,mobileSwipeLeft:W}=e,X=Object(y.a)((e=>e.current_user.permissions)),Z=Object(y.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${L}`,[te]=l.a.useForm(),ae=(null===(a=_.find((e=>e.sorter)))||void 0===a?void 0:a.key)||_[0].key,se=(null===(j=_.find((e=>e.defaultSortOrder)))||void 0===j?void 0:j.defaultSortOrder)||_[0].defaultSortOrder||"ascend",ne=Object(s.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:s,local_storage_key:n,visible_columns:l,use_storage:r}=e,i=Object(d.c)(n);if(i&&r){const e=null===i||void 0===i?void 0:i.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...i,filters_value:{...i.filters_value,start_date:v(i.filters_value.start_date),end_date:v(i.filters_value.end_date),birthday_start_date:v(i.filters_value.birthday_start_date),birthday_end_date:v(i.filters_value.birthday_end_date),start_date_open:v(i.filters_value.start_date_open),start_date_close:v(i.filters_value.start_date_close),end_date_open:v(i.filters_value.end_date_open),end_date_close:v(i.filters_value.end_date_close)}}:i}const c=null===s||void 0===s?void 0:s.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:O[t],filters_value:c,visible_columns:l}})({local_storage_key:ee,filters:w,default_sort_field:ae,default_sort_order:se,visible_columns:_.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:B})),[_,ae,se,w,ee,B]),[le,re]=Object(s.useReducer)(p,ne);Object(i.a)((()=>{Object(d.d)(ee,{...le,page:1})}),[le]);const[ie,ce]=Object(s.useState)(""),[oe,de]=Object(s.useState)([]),[be,ue]=Object(s.useState)(0),pe=Object(s.useRef)(!1),je=(e=>{const{columns:t,visible_columns:a=[],dispatch:s}=e,n=t.filter((e=>a.includes(e.key)||e.always_visible)),l=n.findIndex((e=>"actions"===e.key));return l&&(n[l]={...n[l],title:Object(h.jsx)(m.a,{columns:t,visible_columns:a,dispatch:s})}),n})({dispatch:re,columns:_,visible_columns:le.visible_columns}),_e={...Object(s.useMemo)((()=>_.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=le.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[_,le.visible_columns]),...Q(le.filters_value),is_mobile:Z,search_query:ie,sort_field:le.sort_field,sort_order:le.sort_order,page:le.page,results:le.results},{loading:me,refetch:he}=Object(f.f)(S,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:_e,skip:!P,onError:e=>{console.log(e),T.a.captureException(e),c.b.error(Object(n.b)("phrases.loading_error"))},onCompleted:e=>{ue(q(e)),1!==le.page&&pe.current?de((t=>[...t,...D(e)||[]])):de(D(e)||[])}}),Oe=Object(s.useCallback)((()=>{if(1===le.page)return he();re({type:"set_page",payload:1})}),[le.page,he]),ve=Object(s.useCallback)((()=>{pe.current=!0,re({type:"set_page",payload:le.page+1})}),[le.page]),fe=Object(s.useCallback)(((e,t,a)=>{a.order&&(re({type:"set_sort_field",payload:a.field}),re({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&re({type:"set_page",payload:e.current}),e.pageSize&&re({type:"set_results",payload:e.pageSize})}),[]),ge=C({total_count:be,results:le.results,records:oe,select_all_query:{query:I,variables:_e,resolve:e=>t=>{let{data:a}=t;return e(D(a)||[])}},validateRow:M,rowSelector:Object(s.useCallback)((e=>e.filter(M).map($)),[$,M])}),ye=Object(s.useMemo)((()=>V?V(oe):void 0),[oe,V]),xe=Object(s.useCallback)((e=>{he(),ge.resetSelected();const t=Math.ceil((be-e)/le.results);le.page>t&&re({type:"set_page",payload:t})}),[le.page,he,le.results,ge,be]),we=Object(s.useCallback)((e=>{re({type:"set_page",payload:1}),ce(e)}),[ce]),ke=Object(s.useCallback)((e=>{re({type:"set_filters_value",payload:e}),re({type:"set_page",payload:1})}),[]),Ce=Object(s.useMemo)((()=>P?e.permissions?e.permissions:e.permissions_key?{can_create:X[`can_create_${e.permissions_key}`],can_edit:X[`can_edit_${e.permissions_key}`],can_access:X[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[P,e.permissions,e.permissions_key,X]),Se=Object(s.useCallback)((()=>{if(ge.resetSelected(),Z)return 1===le.page?void he():void re({type:"set_page",payload:1});he()}),[Z,he,ge,le.page]);Object(s.useImperativeHandle)(t,(()=>({afterDestroyRecord:xe,refetch:Se})));const qe=Object(s.useMemo)((()=>({onSearch:we,row_selection:ge,onFiltersChange:ke,data_source:oe,form:te,total_count:be,loading:me,new_columns:je,onChange:fe,expanded_row_keys:ye,refetch:Oe,handleFetchMore:ve,...e,has_feature:P,addon_id:K,has_joyride:Y,show_create_button:J,item_selectable:G,validateRow:M,rowSelectorKey:$,permissions:Ce,...le,dispatch:re,rowClassName:U,extra_actions:k})),[we,ge,ke,oe,te,be,me,je,fe,ye,Oe,ve,e,P,Y,J,M,$,Ce,le,U,k,G,K]),De=Object(s.useMemo)((()=>null===w||void 0===w?void 0:w.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[w]);return Object(h.jsx)(b.a.Provider,{value:qe,children:Object(h.jsxs)(o.b,{children:[A?Object(h.jsx)(A,{}):Object(h.jsx)(R,{}),Object(h.jsx)(l.a,{form:te,component:!1,layout:"vertical",onChange:Object(r.debounce)(ke,1e3),initialValues:{...De,...le.filters_value},children:Object(h.jsx)(x.a,{Desktop:z,Mobile:N,mobileSwipeLeft:W})})]})})};$.displayName="MagicTable";t.a=Object(s.memo)(Object(s.forwardRef)($))},635:function(e,t,a){"use strict";var s=a(0),n=a(50),l=a(1809),r=a(852),i=a(1814),c=a(3052),o=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:i,setVisibleColumns:o}=e;const[b,p]=Object(s.useState)(!1),j=Object(s.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===i||void 0===i||i({type:"set_visible_columns",payload:e}),null===o||void 0===o||o(e)}),[t,i,o]),_=Object(s.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===i||void 0===i||i({type:"set_visible_columns",payload:t}),void(null===o||void 0===o||o(t))}const t=[...a,e];null===i||void 0===i||i({type:"set_visible_columns",payload:t}),null===o||void 0===o||o(t)}),[i,o,a]),m=Object(s.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const s={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>_(t.key),checked:a.includes(t.key),children:t.title})};return[...e,s]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(n.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:j,children:Object(n.b)("words.default")})]}),children:e}]}),[t,j,_,a]);return Object(d.jsx)(l.a,{menu:{items:m},trigger:["click"],open:b,onOpenChange:p,className:"no-print table-configuration",children:Object(d.jsx)(r.a,{title:Object(n.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(c.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(o.d)(i.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])}}]);
//# sourceMappingURL=29.890529fc.chunk.js.map