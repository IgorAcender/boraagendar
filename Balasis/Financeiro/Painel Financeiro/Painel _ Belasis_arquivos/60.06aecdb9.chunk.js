(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[60,108],{1004:function(e,t,a){"use strict";var c=a(13),s=a(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 256c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm192 200v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8zm-48 396H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm104.1-115.6c1.8-34.5 16.2-66.8 40.8-91.4 26.2-26.2 62-41 99.1-41 37.4 0 72.6 14.6 99.1 41 3.2 3.2 6.3 6.6 9.2 10.1L769.2 673a8 8 0 003 14.1l93.3 22.5c5 1.2 9.8-2.6 9.9-7.7l.6-95.4a8 8 0 00-12.9-6.4l-20.3 15.8C805.4 569.6 748.1 540 684 540c-109.9 0-199.6 86.9-204 195.7-.2 4.5 3.5 8.3 8 8.3h48.1c4.3 0 7.8-3.3 8-7.6zM880 744h-48.1c-4.3 0-7.8 3.3-8 7.6-1.8 34.5-16.2 66.8-40.8 91.4-26.2 26.2-62 41-99.1 41-37.4 0-72.6-14.6-99.1-41-3.2-3.2-6.3-6.6-9.2-10.1l23.1-17.9a8 8 0 00-3-14.1l-93.3-22.5c-5-1.2-9.8 2.6-9.9 7.7l-.6 95.4a8 8 0 0012.9 6.4l20.3-15.8C562.6 918.4 619.9 948 684 948c109.9 0 199.6-86.9 204-195.7.2-4.5-3.5-8.3-8-8.3z"}}]},name:"file-sync",theme:"outlined"},n=a(71),i=function(e,t){return s.createElement(n.a,Object(c.a)({},e,{ref:t,icon:r}))},l=s.forwardRef(i);t.a=l},1041:function(e,t,a){"use strict";var c=a(116),s=a(37),r=a(1850),n=a(76),i=a(50);const l=s.e`
  mutation MassActionUpdateProducts($data: UpdateInventoryProductsInput!) {
    updateInventoryProducts(input: $data) {
      success
      errors
    }
  }
`;t.a=()=>{const[e,{loading:t}]=Object(r.a)(l);return[async t=>{const a=c.b.loading(`${Object(i.b)("verbs.wait")}...`,0);try{const{data:s}=await e({variables:{data:t}}),{success:r,errors:n}=(null===s||void 0===s?void 0:s.updateInventoryProducts)||{};return null===n||void 0===n||n.map((e=>c.b.error(e))),{success:r,errors:n||[]}}catch(s){return n.a.captureException(s),console.error(s),c.b.error(Object(i.b)("phrases.generic_save_error_message")),{success:!1,errors:[]}}finally{a()}},{loading:t}]}},1207:function(e,t,a){"use strict";var c=a(0),s=a.n(c),r=a(7),n=a.n(r),i=a(821),l=a(12),o=a(193);var d=function(e){let t=null;const a=a=>()=>{t=null,e.apply(void 0,Object(l.a)(a))},c=function(){if(null===t){for(var e=arguments.length,c=new Array(e),s=0;s<e;s++)c[s]=arguments[s];t=Object(o.a)(a(c))}};return c.cancel=()=>{o.a.cancel(t),t=null},c},b=a(46),u=a(310);var _=Object(u.b)("Affix",(e=>{const{componentCls:t}=e;return{[t]:{position:"fixed",zIndex:e.zIndexPopup}}}),(e=>({zIndexPopup:e.zIndexBase+10})));function h(e){return e!==window?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function j(e,t,a){if(void 0!==a&&Math.round(t.top)>Math.round(e.top)-a)return a+t.top}function p(e,t,a){if(void 0!==a&&Math.round(t.bottom)<Math.round(e.bottom)+a){return a+(window.innerHeight-t.bottom)}}var m=function(e,t){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(a[c]=e[c]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(c=Object.getOwnPropertySymbols(e);s<c.length;s++)t.indexOf(c[s])<0&&Object.prototype.propertyIsEnumerable.call(e,c[s])&&(a[c[s]]=e[c[s]])}return a};const v=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"];function O(){return"undefined"!==typeof window?window:null}const f=s.a.forwardRef(((e,t)=>{var a;const{style:c,offsetTop:r,offsetBottom:l,prefixCls:o,className:u,rootClassName:f,children:g,target:y,onChange:x,onTestUpdatePosition:k}=e,w=m(e,["style","offsetTop","offsetBottom","prefixCls","className","rootClassName","children","target","onChange","onTestUpdatePosition"]),{getPrefixCls:C,getTargetContainer:S}=s.a.useContext(b.a),I=C("affix",o),[$,z]=s.a.useState(!1),[M,N]=s.a.useState(),[R,F]=s.a.useState(),E=s.a.useRef(0),P=s.a.useRef(null),V=s.a.useRef(null),q=s.a.useRef(null),H=s.a.useRef(null),B=s.a.useRef(null),A=null!==(a=null!==y&&void 0!==y?y:S)&&void 0!==a?a:O,D=void 0===l&&void 0===r?0:r,L=()=>{E.current=1,(()=>{if(1!==E.current||!H.current||!q.current||!A)return;const e=A();if(e){const t={status:0},a=h(q.current);if(0===a.top&&0===a.left&&0===a.width&&0===a.height)return;const c=h(e),s=j(a,c,D),r=p(a,c,l);void 0!==s?(t.affixStyle={position:"fixed",top:s,width:a.width,height:a.height},t.placeholderStyle={width:a.width,height:a.height}):void 0!==r&&(t.affixStyle={position:"fixed",bottom:r,width:a.width,height:a.height},t.placeholderStyle={width:a.width,height:a.height}),t.lastAffix=!!t.affixStyle,$!==t.lastAffix&&(null===x||void 0===x||x(t.lastAffix)),E.current=t.status,N(t.affixStyle),F(t.placeholderStyle),z(t.lastAffix)}})()},T=d((()=>{L()})),K=d((()=>{if(A&&M){const e=A();if(e&&q.current){const t=h(e),a=h(q.current),c=j(a,t,D),s=p(a,t,l);if(void 0!==c&&M.top===c||void 0!==s&&M.bottom===s)return}}L()})),U=()=>{const e=null===A||void 0===A?void 0:A();e&&(v.forEach((t=>{var a;V.current&&(null===(a=P.current)||void 0===a||a.removeEventListener(t,V.current)),null===e||void 0===e||e.addEventListener(t,K)})),P.current=e,V.current=K)},Y=()=>{const e=null===A||void 0===A?void 0:A();v.forEach((t=>{var a;null===e||void 0===e||e.removeEventListener(t,K),V.current&&(null===(a=P.current)||void 0===a||a.removeEventListener(t,V.current))})),T.cancel(),K.cancel()};s.a.useImperativeHandle(t,(()=>({updatePosition:T}))),s.a.useEffect((()=>(B.current=setTimeout(U),()=>{B.current&&(clearTimeout(B.current),B.current=null),Y()})),[]),s.a.useEffect((()=>(U(),()=>Y())),[y,M,$,r,l]),s.a.useEffect((()=>{T()}),[y,r,l]);const[J,G,W]=_(I),Q=n()(f,G,I,W),X=n()({[Q]:M});return J(s.a.createElement(i.default,{onResize:T},s.a.createElement("div",Object.assign({style:c,className:u,ref:q},w),M&&s.a.createElement("div",{style:R,"aria-hidden":"true"}),s.a.createElement("div",{className:X,ref:H,style:M},s.a.createElement(i.default,{onResize:T},g)))))}));t.a=f},2933:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a(20),r=a(18),n=a(593),i=a(50),l=a(340),o=a(585),d=a(116),b=a(2937),u=a(2976),_=a(3023),h=a(538),j=a(1256),p=a(2838),m=a(999),v=a(579),O=a(758),f=a(37),g=a(405),y=a(76);const x=f.e`
  query Salon {
    current_salon {
      id
      salon_configuration {
        id
        cashback_active
        cashback_default_value
        cashback_minimum_value_cents
        cashback_value_type
        can_redeem_cashback
      }
    }
  }
`;var k=e=>Object(g.f)(x,{fetchPolicy:"network-only",onCompleted:t=>{const a=t.current_salon.salon_configuration;e(a)},onError:e=>{y.a.captureException(e),console.log({error:e})}}),w=a(27),C=a(812),S=a(584),I=a(339),$=a(623),z=a(159),M=a(1809),N=a(3034),R=a(3053),F=a(3052),E=a(1444),P=a(2855),V=a(687),q=a(3041),H=a(2843),B=a(597),A=a(598),D=a(22);const L=()=>{const[e,t]=Object(c.useState)(!1),a=Object(A.b)((e=>e.permissions)),s=Object(A.b)((e=>e.onSearch)),r=Object(A.b)((e=>e.show_filters)),n=Object(A.b)((e=>e.dispatch)),l=Object(A.b)((e=>e.openDrawer)),o=Object(A.b)((e=>e.search_placeholder)),b=Object(A.b)((e=>e.filters)),u=Object(A.b)((e=>e.row_selection)),_=Object(A.b)((e=>e.mass_actions)),h=Object(A.b)((e=>e.show_create_button)),j=Object(c.useMemo)((()=>null===_||void 0===_?void 0:_.map((e=>({key:e.label,onClick:()=>null===e||void 0===e?void 0:e.onClick(null===u||void 0===u?void 0:u.selected_rows),icon:e.icon,title:e.title,label:e.label})))),[_,null===u||void 0===u?void 0:u.selected_rows]);return Object(D.jsxs)(B.b,{$showBottomBorder:!0,title:Object(i.b)("words.cashback"),tabs:[{path:"/cashback",label:Object(i.b)("cashback.products_services"),icon:N.a},{path:"/cashback/clients",label:Object(i.b)("words.client_other"),icon:R.a},{label:Object(i.b)("words.setting_other"),path:"/cashback/settings",icon:F.a}],children:[e&&Object(D.jsx)(B.a,{autoFocus:!0,width:350,allowClear:!0,placeholder:o,onSearch:e=>s(e),onChange:e=>{let{target:{value:t}}=e;0===t.length&&s("")}}),!e&&!!o&&Object(D.jsx)(z.a,{icon:Object(D.jsx)(E.a,{}),onClick:()=>t(!0),children:Object(i.b)("verbs.search")}),!!b&&Object(D.jsx)(z.a,{className:r?"ant-btn-gold":void 0,type:r?"primary":"default",onClick:()=>n({type:"set_show_filters",payload:!r}),icon:r?Object(D.jsx)(P.a,{}):Object(D.jsx)(V.a,{}),children:Object(i.b)("verbs.filter")}),(null===u||void 0===u?void 0:u.selectedRowKeys.length)>0&&Object(D.jsx)(M.a,{menu:{items:j},trigger:["click"],className:"table-mass-actions",children:Object(D.jsx)(z.a,{icon:Object(D.jsx)(q.a,{}),children:Object(i.b)("phrases.mass_actions")})}),l&&h&&Object(D.jsx)(z.a,{icon:Object(D.jsx)(H.a,{}),type:"primary",onClick:()=>{null!==a&&void 0!==a&&a.can_create?l():d.b.warning(Object(i.b)("phrases.no_permission_to_do_this"))},children:Object(i.b)("words.new")})]})};L.displayName="Header";var T=L;const K=()=>{const e=Object(w.a)((e=>e.is_mobile)),t=Object(w.a)((e=>{let{current_user:{features:t,addons:a}}=e;return t.has_cashback||a.has_cashback})),a=Object(w.a)((e=>e.current_user.permissions)),c=Object(n.b)(),[s]=b.a.useForm(),{submit:f,setFieldsValue:g}=s,[y,{loading:x}]=Object(O.a)(),{loading:z}=k((e=>{g(e)}));return Object(D.jsxs)(o.b,{children:[Object(D.jsx)(T,{}),Object(D.jsx)(o.c,{$pageFull:!0,has_permission:a.is_admin,children:Object(D.jsx)(m.SettingsContainer,{children:Object(D.jsxs)(b.a,{form:s,onFinish:async e=>{const{data:t}=await y({variables:{data:{salon_configuration_attributes:e}}}),{success:a=!1,errors:c=[]}=(null===t||void 0===t?void 0:t.saveSalon)||{};null===c||void 0===c||c.map((e=>d.b.error(e))),a&&d.b.success(Object(i.b)("phrases.saved_successfully",{prefix:Object(i.b)("words.setting"),context:"female"}))},children:[Object(D.jsx)(I.a,{loading:z}),Object(D.jsx)(u.a,{type:"info",message:Object(D.jsx)(l.a,{i18nKey:"settings.cashback.customize_cashback",components:[Object(D.jsx)("strong",{}),Object(D.jsx)("br",{})]}),style:{width:"100%",marginBottom:10,padding:10}}),Object(D.jsx)($.a,{title:Object(i.b)("settings.cashback.activate_cashback"),description:Object(i.b)("settings.cashback.enable_cashback_module"),is_column:e,align_items:e?"start":void 0,children:Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_active",valuePropName:"checked",initialValue:!1,children:Object(D.jsx)(_.a,{onChange:e=>{!t&&e&&(g({cashback_active:!1}),c({is_addon:!0,search:r.a.ID_CASHBACK}))}})})}),Object(D.jsx)($.a,{title:Object(i.b)("settings.cashback.default_value"),description:Object(i.b)("settings.cashback.set_default_cashback_value"),is_column:!0,children:Object(D.jsxs)(h.a.Compact,{block:!0,children:[Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_value_type",initialValue:"value",children:Object(D.jsx)(j.a,{style:{width:70},size:e?"large":"middle",options:[{label:Object(v.h)(),value:"value"},{label:"%",value:"percentage"}]})}),Object(D.jsx)(b.a.Item,{noStyle:!0,dependencies:["cashback_value_type"],children:t=>{let{getFieldValue:a}=t;const c=a("cashback_value_type");return Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_default_value",initialValue:0,children:"percentage"===c?Object(D.jsx)(p.a,{min:0,max:100,parser:v.t,formatter:e=>Object(v.s)(e),className:"hide-number-button",size:e?"large":"middle",style:{width:"calc(100% - 70px)"}}):Object(D.jsx)(p.a,{min:0,className:"hide-number-button",style:{width:"calc(100% - 70px)"},parser:v.t,size:e?"large":"middle",formatter:e=>Object(v.s)(e)})})}})]})}),Object(D.jsx)($.a,{title:Object(i.b)("settings.cashback.allow_cashback_redemption"),description:Object(i.b)("settings.cashback.enable_cashback_redemption"),is_column:e,align_items:e?"start":void 0,children:Object(D.jsx)(b.a.Item,{noStyle:!0,name:"can_redeem_cashback",initialValue:!1,valuePropName:"checked",children:Object(D.jsx)(_.a,{})})}),Object(D.jsx)($.a,{title:Object(i.b)("settings.cashback.minimum_redemption_value"),description:Object(i.b)("settings.cashback.define_minimum_redemption_value"),is_column:!0,children:Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_minimum_value_cents",initialValue:0,children:Object(D.jsx)(S.a,{size:e?"large":"middle"})})}),Object(D.jsx)(C.a,{loading:x,submit:f})]})})})]})};K.displayName="Settings";var U=K;const Y=f.e`
  query ProductsList (
    $page: Int,
    $results: Int,
    $search_query: String,
    $service: Boolean,
    $sort_field: String,
    $sort_order: String
  ) {
    all_inventory_products (
      page: $page,
      results: $results,
      search_term: $search_query,
      service: $service,
      sort_field: $sort_field,
      sort_order: $sort_order,
      actives: true,
      use_replica: true
    ) {
      all {
        id
        image_url: small_thumb_url
        image_blurhash
        description
        service
        active
        cashback_active
        cashback_value
        cashback_value_type
      }
      total_count
    }
  }
`,J=f.e`
  query ProductsIdsList ($service: Boolean, $search_query: String) {
    all_inventory_products (actives: true, service: $service, search_term: $search_query) {
      all {
        id active favorite
      }
    },
  }
`;var G=a(250),W=a(543),Q=a(2883),X=a(622),Z=a(1850),ee=a(188);const te=f.e`
  mutation SaveService ($data: SaveInventoryProductInput!) {
    saveInventoryProduct (input: $data) {
      success
      errors

      inventory_product {
        ...InventoryProductsAttributes
      }
    }
  }

  ${ee.b}
`;var ae=()=>{const[e,{loading:t}]=Object(Z.a)(te);return[Object(c.useCallback)((async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:c=!1,errors:s=[],inventory_product:r}=(null===a||void 0===a?void 0:a.saveInventoryProduct)||{};return c&&d.b.success(Object(i.b)("phrases.saved_successfully",{prefix:Object(i.b)("words.setting"),context:"female"})),null===s||void 0===s||s.forEach((e=>d.b.error(e))),{success:c,inventory_product:r}}catch(a){return y.a.captureException(a),d.b.error(Object(i.b)("phrases.generic_save_error_message")),console.error(a),{success:!1,inventory_product:void 0}}}),[e]),{loading:t}]},ce=a(19),se=a(581),re=a(693);const ne=(e,t)=>{let{afterSave:a}=e;const[s,r]=Object(c.useState)(!1),n=Object(w.a)((e=>e.is_mobile)),l=Object(w.a)((e=>e.current_user.salon.salon_configuration)),[o]=b.a.useForm(),{resetFields:_,submit:m,setFieldsValue:O}=o,[f,{loading:g}]=ae(),y=Object(c.useCallback)((()=>{r(!0)}),[]),x=Object(c.useCallback)((()=>{r(!1)}),[]);Object(c.useImperativeHandle)(t,(()=>({close:x,open:y})));const k=Object(c.useCallback)((e=>{e||_()}),[_]),C=Object(c.useCallback)((e=>{O({cashback_value_type:null===e||void 0===e?void 0:e.cashback_value_type,cashback_value:null===e||void 0===e?void 0:e.cashback_value})}),[O]),S=Object(c.useCallback)((async e=>{let{cashback_value:t,cashback_value_type:c,inventory_product:s}=e;if(!s)return void d.b.warning(Object(i.b)("cashback.inform_the_service_or_product"));const r={id:s.id,cashback_value:t,cashback_value_type:c},{success:n}=await f(r);n&&(null===a||void 0===a||a(),x())}),[a,x,f]),I=Object(c.useMemo)((()=>"percentage"===l.cashback_value_type?Object(v.u)(l.cashback_default_value,{symbol_position:"right"}):Object(v.d)(l.cashback_default_value,{cents:!1})),[l.cashback_default_value,l.cashback_value_type]);return Object(D.jsx)(G.a,{closable:!0,push:!1,width:550,height:"100%",destroyOnClose:!0,open:s,onClose:x,title:Object(i.b)("cashback.new_item_in_cashback"),afterOpenChange:k,placement:n?"bottom":"right",footer:Object(D.jsx)(se.a,{close:x,submit:m,loading:g}),children:Object(D.jsx)(b.a,{form:o,layout:"vertical",initialValues:{is_service:!0},onFinish:S,children:Object(D.jsxs)(W.a,{gutter:8,children:[Object(D.jsx)(Q.a,{xs:24,sm:24,children:Object(D.jsx)(b.a.Item,{dependencies:["is_service"],label:Object(i.b)("words.item"),children:e=>{let{getFieldValue:t}=e;const a=t("is_service");return Object(D.jsxs)(le,{block:!0,children:[Object(D.jsx)(b.a.Item,{name:"is_service",noStyle:!0,children:Object(D.jsx)(re.a,{})}),Object(D.jsx)(b.a.Item,{noStyle:!0,name:"inventory_product",getValueFromEvent:(e,t)=>null===t||void 0===t?void 0:t.item,getValueProps:e=>({value:null===e||void 0===e?void 0:e.id,item:e}),children:Object(D.jsx)(X.a,{is_service:a,style:{width:"100%"},onChange:(e,t)=>C(t.item),size:n?"large":"middle"})})]})}})}),Object(D.jsxs)(Q.a,{span:24,children:[Object(D.jsx)(u.a,{type:"info",message:Object(i.b)("cashback.customize_the_value"),description:Object(i.b)("cashback.customize_description",{value:I}),style:{width:"100%",marginBottom:10,padding:10}}),Object(D.jsx)(b.a.Item,{label:Object(i.b)("words.value"),children:Object(D.jsxs)(h.a.Compact,{block:!0,children:[Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_value_type",initialValue:"value",children:Object(D.jsx)(j.a,{style:{width:70},size:n?"large":"middle",options:[{label:Object(v.h)(),value:"value"},{label:"%",value:"percentage"}]})}),Object(D.jsx)(b.a.Item,{noStyle:!0,dependencies:["cashback_value_type"],children:e=>{let{getFieldValue:t}=e;const a=t("cashback_value_type");return Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_value",initialValue:0,children:Object(D.jsx)(p.a,{min:0,max:"percentage"===a?100:void 0,className:"hide-number-button",size:n?"large":"middle",style:{width:n?"calc(100% - 65px)":150},parser:v.t,formatter:e=>Object(v.s)(e)})})}})]})})]})]})})})};ne.displayName="ItemDrawer";var ie=Object(c.forwardRef)(ne);const le=Object(ce.d)(h.a.Compact).withConfig({componentId:"wb__sc-1y1xuwl-0"})(["& > div:last-child{width:calc(100% - 32px) !important;}"]);var oe=a(627),de=a(713),be=a(770),ue=a(1041);const _e=(e,t)=>{let{afterSave:a}=e;const s=Object(w.a)((e=>e.is_mobile)),r=Object(w.a)((e=>e.current_user.salon.salon_configuration)),[n,l]=Object(c.useState)(!1),[o,_]=Object(c.useState)(),[m,{loading:O}]=Object(ue.a)(),[f]=b.a.useForm(),{submit:g}=f,y=e=>{_(e),l(!0)},x=()=>{l(!1)};Object(c.useImperativeHandle)(t,(()=>({close:x,open:y})));const k=Object(c.useCallback)((e=>{e||_(void 0)}),[]),C=Object(c.useCallback)((async e=>{let{cashback_value_type:t,cashback_value:c}=e;const s={product_ids:o,field:"cashback",value_type:t,value:c},{success:r,errors:n}=await m(s);if(!r)return;const l=o.length-n.length,b=Object(i.b)("phrases.update_successfully",{prefix:`${l} ${Object(i.b)("words.product",{count:l}).toLocaleLowerCase()}`,count:l});d.b.success(b),null===a||void 0===a||a(),x()}),[a,o,m]),S=Object(c.useMemo)((()=>"percentage"===r.cashback_value_type?Object(v.u)(r.cashback_default_value,{symbol_position:"right"}):Object(v.d)(r.cashback_default_value,{cents:!1})),[r.cashback_default_value,r.cashback_value_type]);return Object(D.jsx)(G.a,{closable:!0,push:!1,width:400,height:"100%",destroyOnClose:!0,open:n,onClose:x,title:Object(i.b)("cashback.new_item_in_cashback"),afterOpenChange:k,placement:s?"bottom":"right",footer:Object(D.jsx)(se.a,{close:x,submit:g,loading:O}),children:Object(D.jsx)(b.a,{layout:"vertical",form:f,onFinish:C,children:Object(D.jsx)(W.a,{children:Object(D.jsxs)(Q.a,{span:24,children:[Object(D.jsx)(u.a,{type:"info",message:Object(i.b)("cashback.customize_the_value"),description:Object(i.b)("cashback.customize_description",{value:S}),style:{width:"100%",marginBottom:10,padding:10}}),Object(D.jsx)(b.a.Item,{label:Object(i.b)("words.value"),children:Object(D.jsxs)(h.a.Compact,{block:!0,children:[Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_value_type",initialValue:"value",children:Object(D.jsx)(j.a,{style:{width:70},size:s?"large":"middle",options:[{label:Object(v.h)(),value:"value"},{label:"%",value:"percentage"}]})}),Object(D.jsx)(b.a.Item,{noStyle:!0,dependencies:["cashback_value_type"],children:e=>{let{getFieldValue:t}=e;const a=t("cashback_value_type");return Object(D.jsx)(b.a.Item,{noStyle:!0,name:"cashback_value",initialValue:0,children:Object(D.jsx)(p.a,{min:0,max:"percentage"===a?100:void 0,className:"hide-number-button",size:s?"large":"middle",style:{width:"calc(100% - 70px)"},parser:v.t,formatter:e=>Object(v.s)(e)})})}})]})})]})})})})};_e.displayName="MassActionsDrawer";var he=Object(c.forwardRef)(_e),je=a(852),pe=a(616),me=a(599);const ve=e=>{let{cashback_active:t,product:a,refetch:s}=e;const[r,{loading:n}]=ae(),i=Object(c.useCallback)((async(e,t)=>{const{success:a}=await r({id:e.id,cashback_active:t});a&&s()}),[s,r]);return Object(D.jsx)(_.a,{checked:t,loading:n,onChange:e=>i(a,e)})};ve.displayName="CashbackSwitch";var Oe=ve;var fe=(e,t)=>Object(c.useMemo)((()=>[{title:Object(i.b)("words.name"),default_visible:!0,always_visible:!0,key:"description",dataIndex:"description",sorter:!0,defaultSortOrder:"ascend",render:(e,t)=>Object(D.jsxs)("div",{children:[Object(D.jsx)(me.a,{type:"image",src:t.image_url,blurhash:t.image_blurhash,size:"small"}),"\xa0",e]})},{title:Object(i.b)("cashback.item_type"),default_visible:!0,key:"service",dataIndex:"service",width:120,render:e=>e?Object(i.b)("words.service"):Object(i.b)("words.product")},{title:Object(i.b)("cashback.cashback_value"),default_visible:!0,key:"cashback_value",dataIndex:"cashback_value",align:"right",ellipsis:!0,width:160,render:(e,t)=>"value"===t.cashback_value_type?Object(v.d)(e,{cents:!1}):Object(v.u)(e)},{title:Object(i.b)("words.active"),default_visible:!0,key:"cashback_active",dataIndex:"cashback_active",ellipsis:!0,width:80,render:(e,a)=>Object(D.jsx)(Oe,{cashback_active:e,product:a,refetch:t})},{default_visible:!0,key:"actions",align:"center",width:50,render:(t,a)=>Object(D.jsx)(pe.a,{width:50,children:Object(D.jsx)(je.a,{title:Object(i.b)("verbs.edit"),placement:"bottom",children:Object(D.jsx)(G.i,{className:"link",onClick:()=>e(a),children:Object(D.jsx)(N.a,{})})})})}]),[e,t]);var ge=()=>Object(c.useMemo)((()=>[{label:Object(i.b)("cashback.item_type"),name:"service",double_checkbox:{true:Object(i.b)("words.service"),false:Object(i.b)("words.product")}}]),[]),ye=a(583);const xe=e=>{let{item:t}=e;const a=Object(c.useMemo)((()=>t?"value"===t.cashback_value_type?Object(v.d)(t.cashback_value,{cents:!1}):Object(v.u)(t.cashback_value):0),[t]);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("div",{children:Object(D.jsx)(we,{src:null===t||void 0===t?void 0:t.image_url,blurhash:null===t||void 0===t?void 0:t.image_blurhash})}),Object(D.jsxs)("div",{style:{width:"100%",overflow:"hidden"},children:[Object(D.jsx)(G.g,{justify:"space-between",children:Object(D.jsx)(ye.b,{width:10,$block:!0,children:null===t||void 0===t?void 0:t.description})}),Object(D.jsxs)(G.g,{justify:"space-between",$top:5,children:[Object(D.jsx)(ye.b,{width:12,$block:!0,$color:"gray_1",$size:12,children:null!==t&&void 0!==t&&t.service?Object(i.b)("words.service"):Object(i.b)("words.product")}),Object(D.jsx)(ye.b,{width:6,$block:!0,$color:"gray_1",$size:12,children:a})]})]})]})};var ke=Object(c.memo)(xe);const we=Object(ce.d)(me.a).attrs({type:"image"}).withConfig({componentId:"wb__sc-19zlwnm-0"})(["width:40px !important;height:40px !important;border-radius:5px !important;margin-right:10px !important;border:1px solid #eee;"]),Ce={true:!0,false:!1,all:void 0,none:void 0};var Se=()=>{const e=Object(c.useRef)(null),t=Object(c.useRef)(null),a=Object(c.useRef)(null),s=Object(c.useRef)(null),r=Object(c.useRef)(null),n=Object(w.a)((e=>e.current_user.permissions)),l=Object(w.a)((e=>e.current_user.permissions.is_admin)),o=Object(c.useCallback)((a=>{var c,s;a&&(a.service?null===(s=e.current)||void 0===s||s.open({id:a.id,initial_active_bar:"cashback"}):null===(c=t.current)||void 0===c||c.open({id:a.id,initial_active_bar:"cashback"}))}),[]),b=Object(c.useCallback)((e=>{var t;e?o(e):null===(t=a.current)||void 0===t||t.open()}),[o]),u=Object(c.useCallback)((()=>{var e;null===(e=s.current)||void 0===e||e.refetch()}),[]),_=fe(o,u),h=ge(),j=Object(c.useCallback)((e=>{const t={};return Object.entries(e).forEach((e=>{let[a,c]=e;c in Ce&&(t[a]=Ce[c])})),t}),[]),p=Object(c.useMemo)((()=>[{label:Object(i.b)("verbs.edit"),icon:Object(D.jsx)(N.a,{className:"link"}),onClick:e=>{var t;n.can_edit_product?null===(t=r.current)||void 0===t||t.open(e):d.b.warning(Object(i.b)("phrases.no_permission_to_do_this"))}}]),[n.can_edit_product]);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(oe.a,{ref:s,Header:T,title:Object(i.b)("words.cashback"),storage_key:"cashback-products-list",permissions:Object(c.useMemo)((()=>({can_create:l,can_edit:l,can_access:l})),[l]),search_placeholder:Object(i.b)("cashback.search_placeholder"),columns:_,filters:h,item_selectable:!1,mass_actions:p,query:Y,select_all_query:J,getData:e=>{var t;return null===e||void 0===e||null===(t=e.all_inventory_products)||void 0===t?void 0:t.all},getTotalCount:e=>{var t;return(null===e||void 0===e||null===(t=e.all_inventory_products)||void 0===t?void 0:t.total_count)||0},MobileItem:ke,parseFilters:j,openDrawer:b}),Object(D.jsx)(de.a,{ref:e}),Object(D.jsx)(be.a,{ref:t}),Object(D.jsx)(ie,{ref:a,afterSave:u}),Object(D.jsx)(he,{ref:r,afterSave:u})]})};const Ie=f.e`
  query ClientsCashbackList (
    $page: Int,
    $results: Int,
    $search_query: String,
    $can_reedem_cashback: Boolean,
    $sort_field: String,
    $sort_order: String
  ) {
    all_clients (
      page: $page,
      results: $results,
      search_with_tag: $search_query,
      can_reedem_cashback: $can_reedem_cashback,
      sort_field: $sort_field,
      sort_order: $sort_order,
      with_cashback: true,
      actives: true,
      use_replica: true
    ) {
      all {
        id name cashback_balance_cents has_avatar avatar_url: small_thumb_url avatar_blurhash name_initials
      }
      total_count
    }
  }
`;var $e=a(596),ze=a(2975),Me=a(1440);var Ne=e=>{const t=Object(ce.f)();return Object(c.useMemo)((()=>[{title:Object(i.b)("words.name"),default_visible:!0,always_visible:!0,key:"name",dataIndex:"name",sorter:!0,defaultSortOrder:"ascend",render:(a,c)=>Object(D.jsxs)("div",{style:{cursor:"pointer"},onClick:()=>e(c),children:[c.has_avatar?Object(D.jsx)(me.a,{src:c.avatar_url,size:"small",blurhash:c.avatar_blurhash}):Object(D.jsx)(ze.a,{style:{backgroundColor:t.color_primary},size:"small",children:c.name_initials.toUpperCase()}),"\xa0",a]})},{title:Object(i.b)("words.cashback"),default_visible:!0,key:"cashback_balance_cents",dataIndex:"cashback_balance_cents",align:"right",width:100,ellipsis:!0,sorter:!0,defaultSortOrder:"ascend",render:e=>Object(v.d)(e)},{default_visible:!0,key:"actions",align:"center",width:60,render:(t,a)=>Object(D.jsx)(pe.a,{width:60,children:Object(D.jsx)(je.a,{title:Object(i.b)("verbs.edit"),placement:"bottom",children:Object(D.jsx)(G.i,{className:"link",onClick:()=>e(a),children:Object(D.jsx)(Me.a,{})})})})}]),[e,t.color_primary])};var Re=()=>Object(c.useMemo)((()=>[{label:Object(i.b)("words.redeem"),name:"can_reedem_cashback",double_checkbox:{true:Object(i.b)("cashback.available_for_redeem"),false:Object(i.b)("cashback.below_balance")}}]),[]);const Fe=e=>{const{item:t}=e;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("div",{children:Object(D.jsx)(Pe,{src:null===t||void 0===t?void 0:t.avatar_url,blurhash:null===t||void 0===t?void 0:t.avatar_blurhash})}),Object(D.jsxs)("div",{style:{overflow:"hidden"},children:[Object(D.jsx)(ye.b,{width:20,$block:!0,children:null===t||void 0===t?void 0:t.name}),Object(D.jsx)(ye.b,{width:12,$block:!0,$color:"gray_1",$size:12,children:Object(v.d)(null===t||void 0===t?void 0:t.cashback_balance_cents)})]})]})};var Ee=Object(c.memo)(Fe);const Pe=Object(ce.d)(me.a).withConfig({componentId:"wb__sc-1w69oca-0"})(["width:40px !important;height:40px !important;margin-right:10px !important;"]);var Ve=()=>{const e=Object(w.a)((e=>e.current_user.permissions.is_admin)),t=Object(c.useRef)(null),a=e=>{var a;e&&(null===(a=t.current)||void 0===a||a.open({id:e.id,initial_active_bar:"cashback"}))},s=Ne(a),r=Re(),n=Object(c.useCallback)((e=>{const t={};return Object.entries(e).forEach((e=>{let[a,c]=e;c in Ce&&(t[a]=Ce[c])})),t}),[]),l=Object(c.useCallback)((()=>!0),[]);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(oe.a,{Header:T,title:Object(i.b)("words.client",{count:2}),storage_key:"cashback-clients-list",permissions:{can_create:!1,can_edit:e,can_access:e},search_placeholder:Object(i.b)("input.search_by_name_phone_cpf"),columns:s,filters:r,parseFilters:n,validateRow:l,query:Ie,getData:e=>{var t;return null===e||void 0===e||null===(t=e.all_clients)||void 0===t?void 0:t.all},getTotalCount:e=>{var t;return(null===e||void 0===e||null===(t=e.all_clients)||void 0===t?void 0:t.total_count)||0},MobileItem:Ee,openDrawer:a,show_create_button:!1}),Object(D.jsx)($e.a,{ref:t})]})};const qe=()=>(Object(n.a)({feature_keys:["has_cashback"],addon_keys:["has_cashback"],search:r.a.ID_CASHBACK}),Object(D.jsxs)(s.d,{children:[Object(D.jsx)(s.b,{path:"/",element:Object(D.jsx)(Se,{})}),Object(D.jsx)(s.b,{path:"/clients",element:Object(D.jsx)(Ve,{})}),Object(D.jsx)(s.b,{path:"/settings",element:Object(D.jsx)(U,{})}),Object(D.jsx)(s.b,{path:"*",element:Object(D.jsx)(s.a,{to:"/cashback"})})]}));qe.displayName="Cashback";t.default=qe},609:function(e,t,a){"use strict";var c=a(0),s=a(50),r=a(159),n=a(53),i=a.n(n),l=a(19),o=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(o.jsx)(b,{children:u.map((e=>{let{label:a,value:c}=e;return Object(o.jsx)(r.a,{type:"primary",onClick:()=>t(c),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(c.memo)(d);const b=l.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(s.b)("words.today"),value:[i()(),i()()]},{label:Object(s.b)("date.last_week"),value:[i()().startOf("week").subtract(1,"week"),i()().endOf("week").subtract(1,"week")]},{label:Object(s.b)("date.last_month"),value:[i()().subtract(1,"month").startOf("month"),i()().subtract(1,"month").endOf("month")]},{label:Object(s.b)("date.current_month"),value:[i()().startOf("month"),i()().endOf("month")]},{label:Object(s.b)("date.six_months_ago"),value:[i()().subtract(6,"month"),i()()]},{label:Object(s.b)("date.one_year_ago"),value:[i()().subtract(12,"month"),i()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return _})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return j})),a.d(t,"a",(function(){return p}));var c=a(19),s=a(0),r=a(2934),n=a(609),i=a(22);const l=(e,t)=>{let{onRangeChange:a,...c}=e;const[l,o]=Object(s.useState)(!1),b=Object(s.useCallback)((e=>{a(e)}),[a]);return Object(i.jsx)(r.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(i.jsx)(d,{children:Object(i.jsx)(n.a,{handleChangeRange:b})}),...c,open:l,onOpenChange:o})};l.displayName="SimpleRangePicker";var o=Object(s.memo)(Object(s.forwardRef)(l));const d=c.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,c]=e;c in b&&(t[a]=b[c])})),Object.entries(e).forEach((e=>{let[t,c]=e;u.includes(t)&&(a[t]=null===c||void 0===c?void 0:c.format("YYYY-MM-DD"))})),{...e,...t,...a}},h=c.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(c.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),j=Object(c.d)(o).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),p=c.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(c.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var c=a(0),s=a(50),r=a(2937),n=a(137),i=a(578),l=a(116),o=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var _=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},h=a(53),j=a.n(h),p=a(635),m=a(22);const v={ascend:"ASC",descend:"DESC"},O=e=>e?j()(e):null;var f=a(405),g=a(610),y=a(27),x=a(582),k=a(1814),w=a(148);var C=e=>{const{total_count:t,records:a,results:r,select_all_query:n,validateRow:i=(e=>!0),rowSelector:o=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(c.useState)([]),[u,_]=Object(c.useState)(!1),[h,j]=Object(c.useState)(!1),[p,v]=Object(c.useState)(!1),O=Object(w.a)(),f=Object(c.useCallback)((()=>{_(!1),b([]),v(!1)}),[]),g=Object(c.useCallback)((()=>{const e=l.b.loading(`${Object(s.b)("verbs.selecting")}...`,0);j(!0);const{query:t,variables:a,resolve:c}=n;O.query({query:t,variables:a,fetchPolicy:"network-only"}).then(c((e=>{_(!0),b(o(e))}))).catch((e=>console.error(e))).then((()=>{e(),j(!1)}))}),[O,o,n]),y=Object(c.useCallback)(((e,t)=>{b(o(t))}),[]),x=Object(c.useMemo)((()=>a.filter(i)),[a,i]);return Object(c.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:x,total_count:t,resetSelected:f,records:a,results:r,selectAll:g,onChange:y,is_select_mode:p,setIsSelectMode:v,is_selecting_all:h,setSelectedAll:_,setIsSelectingAll:j,getCheckboxProps:e=>({disabled:!i(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(m.jsx)(k.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<x.length)return b(o(x));f()}})})),[u,d,t,f,a,r,g,y,i,x,p,v,h])},S=a(597),I=a(232);const $=Object(c.lazy)((()=>Object(I.a)((()=>a.e(12).then(a.bind(null,968)))))),z=Object(c.lazy)((()=>Object(I.a)((()=>a.e(7).then(a.bind(null,969)))))),M=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(m.jsx)(S.b,{title:t,onSearch:e,children:Object(m.jsx)(x.a,{Desktop:$,Mobile:z})})};M.displayName="DefaultHeader";var N=M,R=a(76);const F=Object(c.lazy)((()=>Object(I.a)((()=>a.e(94).then(a.bind(null,2909)))))),E=Object(c.lazy)((()=>Object(I.a)((()=>a.e(67).then(a.bind(null,3082)))))),P=e=>!(null===e||void 0===e||!e.active),V=e=>null===e||void 0===e?void 0:e.id,q=(e,t)=>{var a,h;const{columns:j,filters:k,extra_actions:w,query:S,getTotalCount:I,getData:$,select_all_query:z,validateRow:M=P,rowSelectorKey:q=V,Header:H,expandedRowKeys:B,title:A,storage_key:D=A,has_feature:L=!0,use_storage:T=!0,addon_id:K,has_joyride:U=!0,show_create_button:Y=!0,item_selectable:J=!0,parseFilters:G=g.d,rowClassName:W,mobileSwipeLeft:Q}=e,X=Object(y.a)((e=>e.current_user.permissions)),Z=Object(y.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${D}`,[te]=r.a.useForm(),ae=(null===(a=j.find((e=>e.sorter)))||void 0===a?void 0:a.key)||j[0].key,ce=(null===(h=j.find((e=>e.defaultSortOrder)))||void 0===h?void 0:h.defaultSortOrder)||j[0].defaultSortOrder||"ascend",se=Object(c.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:c,local_storage_key:s,visible_columns:r,use_storage:n}=e,i=Object(d.c)(s);if(i&&n){const e=null===i||void 0===i?void 0:i.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...i,filters_value:{...i.filters_value,start_date:O(i.filters_value.start_date),end_date:O(i.filters_value.end_date),birthday_start_date:O(i.filters_value.birthday_start_date),birthday_end_date:O(i.filters_value.birthday_end_date),start_date_open:O(i.filters_value.start_date_open),start_date_close:O(i.filters_value.start_date_close),end_date_open:O(i.filters_value.end_date_open),end_date_close:O(i.filters_value.end_date_close)}}:i}const l=null===c||void 0===c?void 0:c.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:v[t],filters_value:l,visible_columns:r}})({local_storage_key:ee,filters:k,default_sort_field:ae,default_sort_order:ce,visible_columns:j.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:T})),[j,ae,ce,k,ee,T]),[re,ne]=Object(c.useReducer)(_,se);Object(i.a)((()=>{Object(d.d)(ee,{...re,page:1})}),[re]);const[ie,le]=Object(c.useState)(""),[oe,de]=Object(c.useState)([]),[be,ue]=Object(c.useState)(0),_e=Object(c.useRef)(!1),he=(e=>{const{columns:t,visible_columns:a=[],dispatch:c}=e,s=t.filter((e=>a.includes(e.key)||e.always_visible)),r=s.findIndex((e=>"actions"===e.key));return r&&(s[r]={...s[r],title:Object(m.jsx)(p.a,{columns:t,visible_columns:a,dispatch:c})}),s})({dispatch:ne,columns:j,visible_columns:re.visible_columns}),je={...Object(c.useMemo)((()=>j.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=re.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[j,re.visible_columns]),...G(re.filters_value),is_mobile:Z,search_query:ie,sort_field:re.sort_field,sort_order:re.sort_order,page:re.page,results:re.results},{loading:pe,refetch:me}=Object(f.f)(S,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:je,skip:!L,onError:e=>{console.log(e),R.a.captureException(e),l.b.error(Object(s.b)("phrases.loading_error"))},onCompleted:e=>{ue(I(e)),1!==re.page&&_e.current?de((t=>[...t,...$(e)||[]])):de($(e)||[])}}),ve=Object(c.useCallback)((()=>{if(1===re.page)return me();ne({type:"set_page",payload:1})}),[re.page,me]),Oe=Object(c.useCallback)((()=>{_e.current=!0,ne({type:"set_page",payload:re.page+1})}),[re.page]),fe=Object(c.useCallback)(((e,t,a)=>{a.order&&(ne({type:"set_sort_field",payload:a.field}),ne({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&ne({type:"set_page",payload:e.current}),e.pageSize&&ne({type:"set_results",payload:e.pageSize})}),[]),ge=C({total_count:be,results:re.results,records:oe,select_all_query:{query:z,variables:je,resolve:e=>t=>{let{data:a}=t;return e($(a)||[])}},validateRow:M,rowSelector:Object(c.useCallback)((e=>e.filter(M).map(q)),[q,M])}),ye=Object(c.useMemo)((()=>B?B(oe):void 0),[oe,B]),xe=Object(c.useCallback)((e=>{me(),ge.resetSelected();const t=Math.ceil((be-e)/re.results);re.page>t&&ne({type:"set_page",payload:t})}),[re.page,me,re.results,ge,be]),ke=Object(c.useCallback)((e=>{ne({type:"set_page",payload:1}),le(e)}),[le]),we=Object(c.useCallback)((e=>{ne({type:"set_filters_value",payload:e}),ne({type:"set_page",payload:1})}),[]),Ce=Object(c.useMemo)((()=>L?e.permissions?e.permissions:e.permissions_key?{can_create:X[`can_create_${e.permissions_key}`],can_edit:X[`can_edit_${e.permissions_key}`],can_access:X[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[L,e.permissions,e.permissions_key,X]),Se=Object(c.useCallback)((()=>{if(ge.resetSelected(),Z)return 1===re.page?void me():void ne({type:"set_page",payload:1});me()}),[Z,me,ge,re.page]);Object(c.useImperativeHandle)(t,(()=>({afterDestroyRecord:xe,refetch:Se})));const Ie=Object(c.useMemo)((()=>({onSearch:ke,row_selection:ge,onFiltersChange:we,data_source:oe,form:te,total_count:be,loading:pe,new_columns:he,onChange:fe,expanded_row_keys:ye,refetch:ve,handleFetchMore:Oe,...e,has_feature:L,addon_id:K,has_joyride:U,show_create_button:Y,item_selectable:J,validateRow:M,rowSelectorKey:q,permissions:Ce,...re,dispatch:ne,rowClassName:W,extra_actions:w})),[ke,ge,we,oe,te,be,pe,he,fe,ye,ve,Oe,e,L,U,Y,M,q,Ce,re,W,w,J,K]),$e=Object(c.useMemo)((()=>null===k||void 0===k?void 0:k.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[k]);return Object(m.jsx)(b.a.Provider,{value:Ie,children:Object(m.jsxs)(o.b,{children:[H?Object(m.jsx)(H,{}):Object(m.jsx)(N,{}),Object(m.jsx)(r.a,{form:te,component:!1,layout:"vertical",onChange:Object(n.debounce)(we,1e3),initialValues:{...$e,...re.filters_value},children:Object(m.jsx)(x.a,{Desktop:F,Mobile:E,mobileSwipeLeft:Q})})]})})};q.displayName="MagicTable";t.a=Object(c.memo)(Object(c.forwardRef)(q))},635:function(e,t,a){"use strict";var c=a(0),s=a(50),r=a(1809),n=a(852),i=a(1814),l=a(3052),o=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:i,setVisibleColumns:o}=e;const[b,_]=Object(c.useState)(!1),h=Object(c.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===i||void 0===i||i({type:"set_visible_columns",payload:e}),null===o||void 0===o||o(e)}),[t,i,o]),j=Object(c.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===i||void 0===i||i({type:"set_visible_columns",payload:t}),void(null===o||void 0===o||o(t))}const t=[...a,e];null===i||void 0===i||i({type:"set_visible_columns",payload:t}),null===o||void 0===o||o(t)}),[i,o,a]),p=Object(c.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const c={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>j(t.key),checked:a.includes(t.key),children:t.title})};return[...e,c]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(s.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:h,children:Object(s.b)("words.default")})]}),children:e}]}),[t,h,j,a]);return Object(d.jsx)(r.a,{menu:{items:p},trigger:["click"],open:b,onOpenChange:_,className:"no-print table-configuration",children:Object(d.jsx)(n.a,{title:Object(s.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(l.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(o.d)(i.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])},687:function(e,t,a){"use strict";var c=a(13),s=a(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},n=a(71),i=function(e,t){return s.createElement(n.a,Object(c.a)({},e,{ref:t,icon:r}))},l=s.forwardRef(i);t.a=l},812:function(e,t,a){"use strict";var c=a(50),s=a(159),r=a(1207),n=a(250),i=a(0),l=a(27),o=a(19),d=a(22);const b=e=>{let{loading:t,submit:a}=e;const i=Object(l.a)((e=>e.is_mobile));return i?Object(d.jsx)(n.g,{$paddings:i?15:[15,0],justify:"end",children:Object(d.jsx)(s.a,{size:"large",block:!0,type:"primary",onClick:a,loading:t,children:Object(c.b)("verbs.save")})}):Object(d.jsx)(r.a,{offsetBottom:0,children:Object(d.jsx)(u,{children:Object(d.jsx)(s.a,{type:"primary",onClick:a,loading:t,size:"middle",children:Object(c.b)("verbs.save")})})})};b.displayName="SettingsFooter",t.a=Object(i.memo)(b);const u=o.d.div.withConfig({componentId:"wb__sc-ks2z7o-0"})(["background:",";padding:15px 20px;display:flex;justify-content:flex-end;"],(e=>e.theme.colors.white))},854:function(e,t,a){"use strict";var c=a(13),s=a(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 250c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm184 144H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm-48 458H208V148h560v320c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm440-88H728v-36.6c46.3-13.8 80-56.6 80-107.4 0-61.9-50.1-112-112-112s-112 50.1-112 112c0 50.7 33.7 93.6 80 107.4V764H520c-8.8 0-16 7.2-16 16v152c0 8.8 7.2 16 16 16h352c8.8 0 16-7.2 16-16V780c0-8.8-7.2-16-16-16zM646 620c0-27.6 22.4-50 50-50s50 22.4 50 50-22.4 50-50 50-50-22.4-50-50zm180 266H566v-60h260v60z"}}]},name:"audit",theme:"outlined"},n=a(71),i=function(e,t){return s.createElement(n.a,Object(c.a)({},e,{ref:t,icon:r}))},l=s.forwardRef(i);t.a=l},999:function(e,t,a){"use strict";a.r(t),a.d(t,"SettingsContainer",(function(){return F}));var c=a(0),s=a(50),r=a(116),n=a(2937),i=a(2824),l=a(538),o=a(159),d=a(3023),b=a(585),u=a(18),_=a(742),h=a(743),j=a(19),p=a(654),m=a(27),v=a(812),O=a(623),f=a(37),g=a(1850),y=a(76);const x=f.e`
  mutation saveSubscriptionSaleSettingsMutation($data: SaveSalonConfigurationInput!) {
    saveSalonConfiguration(input: $data) {
      success errors
    }
  }
`;var k=()=>{const[e,{loading:t}]=Object(g.a)(x);return[async t=>{const a=r.b.loading(`${Object(s.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:t}}),{success:s,errors:n}=(null===c||void 0===c?void 0:c.saveSalonConfiguration)||{};return null===n||void 0===n||n.forEach((e=>r.b.error(e))),{success:s}}catch(c){return y.a.captureException(c),r.b.error(Object(s.b)("phrases.generic_save_error_message")),console.error(c),{success:!1}}finally{a()}},t]},w=a(82),C=a(854),S=a(1004),I=a(3052),$=a(597),z=a(22);const M=()=>{const e=[{label:Object(s.b)("words.subscription_other"),path:"/customer/subscriptions",icon:C.a},{label:Object(s.b)("words.customer_subscription_template_other"),path:"/customer/subscription-templates",icon:S.a},{label:Object(s.b)("words.setting_other"),path:"/customer/subscription-settings",icon:I.a}];return Object(z.jsx)($.b,{$showBottomBorder:!0,title:Object(s.b)("phrases.subscription_sale_other"),tabs:e})};M.displayName="Header";var N=M;const R=()=>{const e=Object(m.a)((e=>e.is_mobile)),t=Object(m.a)((e=>e.current_user.permissions)),a=Object(m.a)((e=>e.current_user.salon.salon_configuration)),j=Object(m.a)((e=>{var t;return null===(t=e.current_user.salon.site_config)||void 0===t?void 0:t.subdomain})),f=Object(m.a)((e=>e.current_user.salon.has_online_payment)),g=Object(c.useRef)(null),y=Object(c.useRef)(null),[x]=n.a.useForm(),C=Object(p.a)(),S=Object(c.useMemo)((()=>({id:a.id,subscription_template_visible:a.subscription_template_visible,subscription_template_description:a.subscription_template_description})),[a.id,a.subscription_template_description,a.subscription_template_visible]),[I,$]=k(),M=Object(c.useCallback)((async e=>{const{success:t}=await I(e);t&&r.b.success(Object(s.b)("phrases.saved_successfully",{prefix:Object(s.b)("words.setting"),context:"female"}))}),[I]),R=Object(c.useCallback)((()=>{var e,a;t.is_admin?w.a.IS_WEBOOK?null===(a=y.current)||void 0===a||a.open():null===(e=g.current)||void 0===e||e.open():r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))}),[t.is_admin]),E=Object(c.useCallback)(((e,t)=>t?f?Promise.resolve():(R(),x.setFieldValue("subscription_template_visible",!1),Promise.reject()):Promise.resolve()),[x,f,R]),P=Object(c.useMemo)((()=>u.w?w.a.ONLINEBOOKING_DOMAIN:"localhost:3050"),[]),V=Object(c.useMemo)((()=>{if(!j)return;return`${u.w?"https://":"http://"}${j}.${P}/subscription`}),[j,P]);return Object(z.jsxs)(b.b,{children:[Object(z.jsx)(N,{}),Object(z.jsx)(b.c,{$pageFull:!0,has_permission:t.is_admin,children:Object(z.jsx)(F,{children:Object(z.jsxs)(n.a,{form:x,initialValues:S,onFinish:M,layout:"vertical",style:{width:"100%"},children:[Object(z.jsx)(n.a.Item,{name:"id",noStyle:!0,children:Object(z.jsx)(i.a,{type:"hidden",autoComplete:"off"})}),Object(z.jsx)(O.a,{title:Object(s.b)("customer.subscription_settings.link_title"),description:Object(s.b)("customer.subscription_settings.link_description"),is_column:e,children:Object(z.jsxs)(l.a.Compact,{block:!0,children:[Object(z.jsx)(i.a,{style:{width:"calc(100% - 80px)"},value:V,disabled:!0}),Object(z.jsx)(o.a,{style:{width:80},type:"primary",disabled:!V,onClick:()=>C(V),children:Object(s.b)("verbs.copy")})]})}),Object(z.jsx)(O.a,{title:Object(s.b)("words.visible"),is_column:e,align_items:e?"start":void 0,description:Object(s.b)("customer.subscription_settings.visible_description"),children:Object(z.jsx)(n.a.Item,{name:"subscription_template_visible",valuePropName:"checked",noStyle:!0,rules:[{validator:E}],children:Object(z.jsx)(d.a,{})})}),Object(z.jsx)(O.a,{title:Object(s.b)("words.description"),is_column:!0,description:Object(z.jsxs)(z.Fragment,{children:[Object(s.b)("customer.subscription_settings.template_description"),Object(z.jsx)(n.a.Item,{noStyle:e,name:"subscription_template_description",children:Object(z.jsx)(i.a.TextArea,{maxLength:16777215,rows:3,placeholder:Object(s.b)("customer.subscription_settings.template_placeholder"),style:{width:"100%",marginTop:10},autoComplete:"off"})})]})}),Object(z.jsx)(v.a,{loading:$,submit:x.submit})]})})}),Object(z.jsx)(_.a,{ref:g}),Object(z.jsx)(h.a,{ref:y})]})};R.displayName="SubscriptionSettings";t.default=R;const F=j.d.div.withConfig({componentId:"wb__sc-z3olam-0"})(["width:100%;background:#FFFFFF;padding:10px;margin-bottom:","px;",";.ant-form-item-control{width:100%;}"],(e=>e.theme.sidebar_mobile_bottom_margin),(e=>e.theme.is_mobile&&Object(j.c)(["padding:0 10px;"])))}}]);
//# sourceMappingURL=60.06aecdb9.chunk.js.map