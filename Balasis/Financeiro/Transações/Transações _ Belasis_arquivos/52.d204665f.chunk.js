(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[52],{1030:function(e,t,a){"use strict";var c=a(116),r=a(50),n=a(37),s=a(1850),o=a(76);const l=n.e`
  mutation updateOnlineBookingSettings($data: SaveSalonInput!) {
    saveSalon(input: $data) {
      success errors
    }
  }
`;t.a=()=>{const[e,{loading:t}]=Object(s.a)(l);return[async t=>{const a=c.b.loading(`${Object(r.b)("verbs.wait")}...`,0);try{const{data:r}=await e({variables:{data:t}}),{success:n,errors:s}=(null===r||void 0===r?void 0:r.saveSalon)||{};return null===s||void 0===s||s.forEach((e=>c.b.error(e))),{success:n}}catch(n){return o.a.captureException(n),c.b.error(Object(r.b)("phrases.generic_save_error_message")),console.error(n),{success:!1}}finally{a()}},t]}},1128:function(e,t,a){"use strict";var c=a(636),r=a(0);t.a=()=>{const e=Object(c.b)((e=>e.dispatch));return Object(r.useCallback)((t=>{e({type:"set_view_interval",payload:t})}),[e])}},1201:function(e,t,a){"use strict";var c=a(0),r=a(2854),n=a(3061),s=a(1097),o=a(2856),l=a(116),i=a(2937),d=a(1438),b=a(159),u=a(1809),j=a(250),m=a(340),h=a(50),p=a(53),_=a.n(p),O=a(2824),v=a(543),g=a(2883),f=a(2934),x=a(1814),y=a(3023),w=a(628),k=a(614),C=a(27),$=a(788),S=a(606),D=a(19),I=a(22);const F=e=>{let{form:t}=e;const a=Object(c.useRef)(null),{getFieldValue:r,setFieldsValue:n}=t,[s,o]=Object(c.useState)(r("dates")||[_()(),_()()]),l=Object(C.a)((e=>e.is_mobile)),d=Object(C.a)((e=>e.current_user.employee)),b=Object(C.a)((e=>e.current_user.salon_id))===d.salon_id?[String(d.id)]:[],u=Object(c.useCallback)(((e,t)=>{const a=[_()(e),_()(t)];o(a),n({dates:a})}),[n]),p=Object(c.useCallback)(((e,t)=>{e&&u(e,t||e)}),[u]),D=!!r("id")||!!r("schedule_group_id");return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(i.a,{form:t,layout:"vertical",initialValues:{id:void 0,dates:[_()(),_()()],start_hour:"08:00",end_hour:"18:00",all_day:!1,w_days:[!0,!0,!0,!0,!0,!0,!0],employee_ids:[String(b)],obs:""},children:[Object(I.jsx)(i.a.Item,{name:"id",noStyle:!0,children:Object(I.jsx)(O.a,{type:"hidden"})}),Object(I.jsxs)(v.a,{gutter:[16,0],children:[Object(I.jsx)(i.a.Item,{noStyle:!0,dependencies:["id","schedule_group_id"],children:e=>{let{getFieldValue:t}=e;const a=!!t("id")||!!t("schedule_group_id");return Object(I.jsx)(g.a,{span:24,children:Object(I.jsx)(i.a.Item,{name:"employee_ids",label:Object(h.b)("words.employee",{count:2}),rules:[{required:!0,message:Object(h.b)("calendar.select_employee")}],children:Object(I.jsx)(k.a,{disabled:a,size:l?"large":"middle",mode:"multiple"})})})}}),Object(I.jsx)(g.a,{span:24,children:Object(I.jsx)(i.a.Item,{name:"dates",label:Object(h.b)("calendar.date_period"),children:l?Object(I.jsx)(j.i,{style:{width:"100%"},onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.open()},children:Object(I.jsx)(E,{size:"large",format:"L",allowClear:!1,value:s,disabled:!0,style:{pointerEvents:"none"}})}):Object(I.jsx)(I.Fragment,{children:D?Object(I.jsx)(f.a,{style:{width:"100%"},format:"L",onChange:e=>{e&&u(e,e)},value:s[0],allowClear:!1}):Object(I.jsx)(S.a,{style:{width:"100%"},format:"L",allowClear:!1,getPopupContainer:()=>document.body,onChange:e=>{var t,a;return p(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toDate(),null===e||void 0===e||null===(a=e[1])||void 0===a?void 0:a.toDate())},value:s})})})}),Object(I.jsx)(g.a,{span:24,children:Object(I.jsx)(i.a.Item,{noStyle:!0,dependencies:["dates"],children:e=>{let{getFieldValue:t}=e;const a=t("dates");return 0===a[0].diff(a[1])?null:Object(I.jsx)(i.a.Item,{tooltip:Object(I.jsx)("div",{children:Object(I.jsx)(m.a,{i18nKey:"calendar.week_days_tooltip",components:[Object(I.jsx)("br",{}),Object(I.jsx)("b",{})]})}),label:Object(h.b)("calendar.week_days"),shouldUpdate:!0,style:{padding:"0 4px"},children:()=>Object(I.jsx)(v.a,{gutter:[0,12],children:[1,2,3,4,5,6,0].map((e=>Object(I.jsx)(g.a,{xs:12,sm:8,children:Object(I.jsx)(i.a.Item,{name:["w_days",e],valuePropName:"checked",noStyle:!0,children:Object(I.jsx)(x.a,{children:Object(I.jsx)(z,{children:_()().day(e).format("dddd")})})})},e)))})})}})}),Object(I.jsx)(g.a,{span:24,children:Object(I.jsx)(i.a.Item,{label:Object(h.b)("calendar.occupy.all_day"),name:"all_day",valuePropName:"checked",children:Object(I.jsx)(y.a,{})})}),Object(I.jsx)(g.a,{span:12,children:Object(I.jsx)(i.a.Item,{dependencies:["all_day"],noStyle:!0,children:e=>{let{getFieldValue:t}=e;const a=!!t("all_day");return Object(I.jsx)(i.a.Item,{name:"start_hour",label:Object(h.b)("calendar.start_time"),children:Object(I.jsx)($.a,{size:l?"large":"middle",disabled:a})})}})}),Object(I.jsx)(g.a,{span:12,children:Object(I.jsx)(i.a.Item,{dependencies:["all_day"],noStyle:!0,children:e=>{let{getFieldValue:t}=e;const a=!!t("all_day");return Object(I.jsx)(i.a.Item,{name:"end_hour",label:Object(h.b)("calendar.end_time"),children:Object(I.jsx)($.a,{size:l?"large":"middle",disabled:a})})}})}),Object(I.jsx)(g.a,{span:24,children:Object(I.jsx)(i.a.Item,{name:"obs",label:Object(h.b)("words.reason"),children:Object(I.jsx)(O.a.TextArea,{rows:3,placeholder:Object(h.b)("calendar.provide_reason")})})})]})]}),Object(I.jsx)(w.a,{type:D?"one":"range",ref:a,defaultValue:[s[0].toDate(),s[1].toDate()],onConfirm:p})]})};var M=Object(c.memo)(F);const z=D.d.span.withConfig({componentId:"wb__sc-1e38u3e-0"})(["text-transform:capitalize;"]),E=Object(D.d)(S.a).withConfig({componentId:"wb__sc-1e38u3e-1"})(["width:100%;background-color:white !important;.ant-picker-input > input[disabled]{color:"," !important;}"],(e=>e.theme.colors.default_text));var Y=a(37),N=a(1850),H=a(76);const R=Y.e`
  mutation deleteBusyCalendar($data: CalendarsDestroyNextOccupationsInput!) {
    destroyNextOccupations(input: $data) {
      success errors count
    }
  }
`;var L=()=>{const[e,{loading:t}]=Object(N.a)(R),a=Object(c.useCallback)((async t=>{const a=l.b.loading(`${Object(h.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:t}}),{success:r=!1,errors:n=[]}=(null===c||void 0===c?void 0:c.destroyNextOccupations)||{};return r&&l.b.success(Object(h.b)("phrases.with_success",{prefix:Object(h.b)("words.deleted")})),null===n||void 0===n||n.map((e=>l.b.error(e))),{success:r}}catch(c){return H.a.captureException(c),l.b.error(Object(h.b)("phrases.generic_delete_error_message")),console.error(c),{success:!1}}finally{a()}}),[e]);return[a,t]};var T=()=>{const[e,{loading:t}]=Object(N.a)(q),a=Object(c.useCallback)((async t=>{const a=l.b.loading(`${Object(h.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:{id:t}}}),{success:r,errors:n}=(null===c||void 0===c?void 0:c.deleteCalendar)||{};return r?(l.b.success(Object(h.b)("phrases.with_success",{prefix:Object(h.b)("words.deleted")})),{success:!0}):(null===n||void 0===n||n.map((e=>l.b.error(e))),{success:!1})}catch(c){return H.a.captureException(c),l.b.error(Object(h.b)("phrases.generic_delete_error_message")),console.error(c),{success:!1}}finally{a()}}),[e]);return[a,t]};const q=Y.e`
  mutation deleteBusyCalendar($data: DeleteCalendarInput!) {
    deleteCalendar(input: $data) {
      success errors
    }
  }
`;var P=a(148);const B=Y.e`
  query EmployeeOccypyCalendar(
    $id: ID!,
    $start_date: String!,
    $start_hour: String!,
    $end_hour: String!
  ) {
    employee(id: $id) {
      id
      calendars_per_period(start_date: $start_date, start_hour: $start_hour, end_hour: $end_hour) {
        id start_date start_hour busy
      }
    }
  }
`;var A=()=>{const e=Object(C.a)((e=>e.employees)),t=Object(P.a)();return[Object(c.useCallback)((async a=>{const c=l.b.loading(Object(h.b)("calendar.occupy.verifying_conflict"),0);let{dates:r,start_hour:n,end_hour:s,w_days:o,all_day:i,employee_ids:d}=a;const b=e.filter((e=>d.includes(e.id))),u=await b.reduce((async(e,a)=>{const c=await e;for(let b=r[1].diff(r[0],"days");b>=0;b--){const e=r[0].clone().add(b,"days");if(o&&!o[e.day()])continue;if(i){const t=JSON.parse(a.schedule_hours).find((t=>t.wday===e.day()));n=t.start,s=t.end}let u;try{u=await t.query({fetchPolicy:"network-only",query:B,variables:{id:a.id,start_date:e.format("YYYY-MM-DD"),start_hour:n,end_hour:s}})}catch(d){return console.log(d),l.b.error(Object(h.b)("phrases.generic_save_error_message")),c}const{data:{employee:{calendars_per_period:j}}}=u,m=j.filter((e=>!e.busy));m.length&&(c[a.name]=[...c[a.name]||[],...m])}return c}),Promise.resolve({}));return c(),{employees_filtered:b,employees_conflicting:u}}),[e,t])]};const G=Y.e`
  mutation saveCalendar($data: CalendarSaveInput!) {
    saveCalendar(input: $data) {
      success errors
    }
  }
`;var U=()=>{const[e,{loading:t}]=Object(N.a)(G),a=Object(c.useCallback)((async(t,a)=>{const c=l.b.loading(`${Object(h.b)("verbs.saving")}...`,0);let r=!0;const n=[];let s=0;const o=a.reduce(((e,a)=>[...e,...V(t,a)]),[]).map((t=>new Promise((async a=>{try{const{data:c}=await e({variables:{data:t}}),{success:r=!1,errors:o=[]}=(null===c||void 0===c?void 0:c.saveCalendar)||{};if(!r)return n.push(...o);s++}catch(r){const e=Object(h.b)("calendar.occupy.unable_to_occupy_time_slot");n.push(e),c()}finally{a(!0)}}))));return await Promise.all(o).then((()=>{l.b.destroy(),n.length>0&&(l.b.error(Object(h.b)("calendar.occupy.cant_be_saved",{number:n.length,count:n.length})),n.forEach((e=>l.b.error(e))),r=!1),s>0&&l.b.success(Object(h.b)("calendar.occupy.saved_successfully",{number:s,count:s}))})).finally((()=>{c()})),{success:r}}),[e]);return[a,t]};const V=(e,t)=>{const{id:a,dates:c,w_days:r,all_day:n,obs:s}=e;let{start_hour:o,end_hour:l}=e;const i=c[1].diff(c[0],"days");return new Array(i+1).fill(0).map(((e,t)=>c[0].clone().add(t,"days"))).reduce(((e,c)=>{if(r&&!r[c.day()])return e;if(n){const e=JSON.parse(t.schedule_hours).find((e=>e.wday===c.day()));o=e.start,l=e.end}const i={id:a,busy:!0,employee_id:t.id,start_date:c.format("YYYY-MM-DD"),start_hour:o,end_hour:l,obs:s};return[...e,i]}),[])};var W=a(581),J=a(2879);const K=Y.e`
  query CalendarOccupyHistorical($id: ID!) {
    calendar(id: $id) {
      id
      historical {
        type
        created_at
        user_email
        model_name
        product_service: calendar_product_service
        attribute
        attribute_name
        previous_value
        value
      }
    }
  }
`;var Q=e=>Object(J.a)(K,{fetchPolicy:"network-only",onCompleted:t=>{let{calendar:{historical:a}}=t;e(a)},onError:e=>{H.a.captureException(e),console.log(e)}}),X=a(586),Z=a(834);const ee=(e,t)=>{const[a,r]=Object(c.useState)(!1),[n,s]=Object(c.useState)([]),[o,{loading:l,error:i}]=Q(s),d=e=>{r(!0),o({variables:{id:e}})},b=()=>r(!1);Object(c.useImperativeHandle)(t,(()=>({open:d,close:b})));return Object(I.jsx)(j.a,{open:a,title:Object(h.b)("words.history"),width:700,height:"100%",onClose:b,closable:!0,destroyOnClose:!0,styles:{body:{padding:0,position:"relative"}},footer:null,afterOpenChange:e=>{e||s([])},push:!1,children:Object(I.jsx)(X.a,{visible:!!i,small:!0,children:Object(I.jsx)(Z.a,{historical:n,loading:l})})})};ee.displayName="HistoricalDrawer";var te=Object(c.memo)(Object(c.forwardRef)(ee));const ae=(e,t)=>{const[a,p]=Object(c.useState)(!1),[O,v]=Object(c.useState)(),g=Object(C.a)((e=>e.is_mobile)),f=Object(C.a)((e=>{var t;return null===(t=e.current_user.permissions)||void 0===t?void 0:t.can_destroy_calendar})),[x]=i.a.useForm(),y=Object(c.useRef)(null),[w,k]=T(),[$,S]=L(),[D]=A(),[F,z]=U(),E=Object(c.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{calendar:t,dates:a}=e;if(a&&x.setFieldsValue({dates:a}),t){const e={...t,dates:[_()(t.start_date),_()(t.start_date)]};x.setFieldsValue(e),v(t)}p(!0)}),[x]),Y=Object(c.useCallback)((()=>{p(!1)}),[]);Object(c.useImperativeHandle)(t,Object(c.useCallback)((()=>({open:E,close:Y})),[Y,E]));const N=Object(c.useCallback)((async(e,t)=>{const{success:a}=await F(e,t);a&&Y()}),[Y,F]),H=Object(c.useCallback)((async()=>{const e=await x.validateFields(),{employees_filtered:t,employees_conflicting:a}=await D(e);Object.keys(a).length>0?l.c.confirm({centered:!0,maskClosable:!0,className:"webook-modal",title:Object(h.b)("calendar.time_conflict"),content:Object(I.jsxs)("div",{children:[Object(h.b)("calendar.conflict_message"),Object(I.jsx)(d.a,{}),Object.keys(a).map(((e,t)=>Object(I.jsxs)("div",{children:[Object(I.jsx)("b",{children:e}),Object(I.jsx)("br",{}),Object(I.jsx)("ul",{children:a[e].map((e=>Object(I.jsxs)("li",{children:[_()(e.start_date).format("L"),"\xa0",Object(h.b)("words.at"),"\xa0",e.start_hour]},e.id)))})]},t)))]}),okText:Object(h.b)("words.continue"),onOk:()=>{N(e,t)}}):N(e,t)}),[x,N,D]),R=Object(c.useCallback)((async e=>e?await $({employee_id:null===O||void 0===O?void 0:O.employee_ids[0],start_date:null===O||void 0===O?void 0:O.start_date}):await w(parseInt(null===O||void 0===O?void 0:O.id))),[$,w,null===O||void 0===O?void 0:O.employee_ids,null===O||void 0===O?void 0:O.id,null===O||void 0===O?void 0:O.start_date]),q=Object(c.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!f)return void l.b.warning(Object(h.b)("phrases.no_permission_to_do_this"));const t=e?Object(I.jsx)("div",{children:Object(I.jsx)(m.a,{i18nKey:"calendar.confirm_delete_next_occupations",components:[Object(I.jsx)("strong",{})]})}):Object(h.b)("calendar.confirm_delete_occupation");l.c.confirm({centered:!0,className:"webook-modal",title:Object(h.b)("words.attention"),maskClosable:!0,content:t,okText:Object(h.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(h.b)("verbs.cancel"),onOk:async()=>{const{success:t}=await R(e);t&&Y()}})}),[f,Y,R]),P=Object(c.useCallback)((e=>{e||(x.resetFields(),v(void 0))}),[x]),B=Object(c.useMemo)((()=>[{key:"delete-occupation",icon:Object(I.jsx)(r.a,{}),onClick:()=>q(),label:Object(h.b)("calendar.delete_occupation"),danger:!0},{key:"delete-next-occupations",icon:Object(I.jsx)(n.a,{}),onClick:()=>q(!0),label:Object(h.b)("calendar.delete_next_occupations"),danger:!0}]),[q]),G=null===O||void 0===O?void 0:O.id;return Object(I.jsxs)(j.a,{destroyOnClose:!0,open:a,title:Object(h.b)("calendar.occupy.time_slots"),onClose:Y,afterOpenChange:P,width:550,height:"100%",placement:g?"bottom":"right",push:!1,footer:Object(I.jsx)(W.a,{submit:H,disabled:k||z||S,cancel_text:Object(h.b)("verbs.close"),extra:G&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(b.a,{size:g?"large":"middle",block:g,onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.open(G)},children:Object(I.jsxs)(j.h,{$semibold:!0,children:[Object(I.jsx)(s.a,{})," ",Object(h.b)("words.history")]})}),Object(I.jsx)(u.a,{menu:{items:B},trigger:["click"],placement:"topLeft",disabled:k||z,children:Object(I.jsx)(b.a,{size:g?"large":"middle",block:g,type:"primary",danger:!0,children:Object(I.jsxs)(j.h,{$semibold:!0,children:[Object(h.b)("verbs.delete"),"\xa0",Object(I.jsx)(o.a,{})]})})})]})}),children:[Object(I.jsx)(M,{form:x}),G&&Object(I.jsx)(te,{ref:y})]})};ae.displayName="OccupyCalendarDrawer";t.a=Object(c.memo)(Object(c.forwardRef)(ae))},1209:function(e,t,a){"use strict";var c=a(0),r=a(50),n=a(250),s=a(2831),o=a(27),l=a(755),i=a(2937),d=a(3023),b=a(585),u=a(137),j=a(37),m=a(1850),h=a(116),p=a(76);const _=j.e`
  mutation updateUserSettings($data: UpdateUserInput!) {
    updateUser(input: $data) {
      success errors
    }
  }
`;var O=()=>{const[e,{loading:t}]=Object(m.a)(_);return[async t=>{const a=h.b.loading(`${Object(r.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:t}}),{success:r,errors:n}=(null===c||void 0===c?void 0:c.updateUser)||{};return null===n||void 0===n||n.forEach((e=>h.b.error(e))),{success:r}}catch(c){return p.a.captureException(c),h.b.error(Object(r.b)("phrases.generic_save_error_message")),console.error(c),{success:!1}}finally{a()}},t]},v=a(623),g=a(629),f=a(62),x=a(117),y=a(763),w=a(342),k=a(22);const C=()=>{const[e]=i.a.useForm(),t=Object(o.a)((e=>e.current_user)),a=Object(f.a)(),s=Object(o.a)((e=>e.employees.filter((e=>e.active&&e.calendar)))),l=Object(o.a)((e=>e.current_user.calendar_configuration)),j=Object(o.a)((e=>e.is_mobile)),m=Object(o.a)((e=>e.current_user.permissions)),[p]=O(),_=Object(c.useCallback)((async e=>{const{success:c}=await p({id:t.id,...e});if(!c)return;h.b.success(Object(r.b)("phrases.saved_successfully",{prefix:Object(r.b)("words.setting"),context:"female"}));const n=Object(u.cloneDeep)(t);n.calendar_configuration={...t.calendar_configuration,...e},a({type:"set_current_user",payload:n})}),[t,a,p]);return Object(k.jsx)(b.c,{has_permission:m.can_access_calendar,children:Object(k.jsxs)(i.a,{form:e,onValuesChange:Object(u.debounce)(((e,t)=>_(t)),200),initialValues:{calendar_configuration_attributes:{visible_columns:l.visible_columns,timeslot_size:l.timeslot_size,show_avatars:l.show_avatars,default_status:l.default_status}},layout:"vertical",children:[Object(k.jsx)(v.a,{title:Object(r.b)("settings.schedule.column_width_schedule"),description:Object(r.b)("settings.schedule.define_number_columns"),is_column:j,input_width:250,children:Object(k.jsx)(i.a.Item,{noStyle:!0,name:["calendar_configuration_attributes","visible_columns"],children:Object(k.jsx)(g.b,{style:{width:"100%"},size:j?"large":"middle",options:new Array(s.length+1).fill(0).map(((e,t)=>({label:0===t?Object(r.b)("words.all"):t,value:t})))})})}),Object(k.jsx)(v.a,{title:Object(r.b)("settings.schedule.schedule_view"),description:Object(r.b)("settings.schedule.adjust_interval"),is_column:j,input_width:250,children:Object(k.jsx)(i.a.Item,{noStyle:!0,name:["calendar_configuration_attributes","timeslot_size"],children:Object(k.jsx)(g.b,{style:{width:"100%"},size:j?"large":"middle",options:S})})}),Object(k.jsx)(v.a,{title:Object(k.jsxs)(k.Fragment,{children:[Object(r.b)("settings.schedule.default_status"),Object(k.jsx)(w.c,{date:"2025/03/01"})]}),description:Object(r.b)("settings.schedule.default_status_description"),is_column:j,input_width:250,children:Object(k.jsx)(i.a.Item,{noStyle:!0,name:["calendar_configuration_attributes","default_status"],children:Object(k.jsx)(g.b,{style:{width:"100%"},size:j?"large":"middle",children:D.map((e=>Object(k.jsx)(g.a,{value:e.value,children:Object(k.jsxs)(n.g,{align:"middle",children:[Object(k.jsx)(y.a,{$hex:e.color})," ",e.label]})},e.value)))})})}),Object(k.jsx)(v.a,{title:Object(r.b)("settings.schedule.display_avatars"),description:Object(r.b)("settings.schedule.set_profile_images"),input_width:250,children:Object(k.jsx)(i.a.Item,{noStyle:!0,name:["calendar_configuration_attributes","show_avatars"],valuePropName:"checked",children:Object(k.jsx)(d.a,{})})})]})})};C.displayName="VisualizationSettings";var $=C;const S=[5,10,15,20,25,30,40,45,60,90].map((e=>({label:`${e<9?`0${e}`:e} ${Object(r.b)("words.minute",{count:e}).toLocaleLowerCase()}`,value:e}))),D=[{value:"confirmed",label:Object(r.b)("words.confirmed"),color:x.a.calendar_confirmed},{value:"unconfirmed",label:Object(r.b)("words.unconfirmed"),color:x.a.calendar_unconfirmed}];var I=a(543),F=a(2976),M=a(1030);const z=()=>{const e=Object(o.a)((e=>e.current_user.salon.salon_configuration)),t=Object(o.a)((e=>e.current_user.permissions)),a=Object(o.a)((e=>e.current_user)),[n,s]=Object(c.useState)(e.filter_employees_by_service),[l,i]=Object(c.useState)(e.calendar_show_canceled),[j]=Object(M.a)(),m=Object(f.a)(),p=async(e,c)=>{if(!t.is_admin)return h.b.warning(Object(r.b)("phrases.no_permission_to_do_this")),!1;const n={[e]:c},{success:s}=await j({salon_configuration_attributes:n});if(!s)return!1;const o=Object(u.cloneDeep)(a);return o.salon.salon_configuration={...a.salon.salon_configuration,[e]:c},m({type:"set_current_user",payload:o}),h.b.success(Object(r.b)("phrases.saved_successfully",{prefix:Object(r.b)("words.setting"),context:"female"})),!0};return Object(k.jsx)(b.c,{has_permission:t.is_admin,children:Object(k.jsxs)(I.a,{children:[Object(k.jsx)(F.a,{message:Object(r.b)("settings.schedule.global_settings_alert"),style:{width:"100%",marginBottom:10}}),Object(k.jsx)(v.a,{title:Object(r.b)("settings.schedule.filter_employees_by_service"),description:Object(r.b)("settings.schedule.filter_employees_by_service_description"),input_width:200,children:Object(k.jsx)(d.a,{checked:n,onChange:async e=>{s(e);await p("filter_employees_by_service",e)||s(!e)}})}),Object(k.jsx)(v.a,{title:Object(r.b)("settings.schedule.block_canceled_schedules"),description:Object(r.b)("settings.schedule.define_behavior_canceled_schedules"),input_width:200,children:Object(k.jsx)(d.a,{checked:l,onChange:async e=>{i(e);await p("calendar_show_canceled",e)||i(!e)}})})]})})};z.displayName="GeneralSettings";var E=z;const Y=(e,t)=>{const[a,i]=Object(c.useState)(!1),[d,b]=Object(c.useState)("calendar"),u=Object(o.a)((e=>e.is_mobile)),j=()=>{i(!0),b("calendar")},m=()=>{i(!1)};Object(c.useImperativeHandle)(t,(()=>({open:j,close:m})));const h=[{key:"calendar",label:Object(r.b)("words.general"),children:Object(k.jsx)(E,{})},{key:"visualization",label:Object(r.b)("words.visualization"),children:Object(k.jsx)($,{})},{key:"colors",label:Object(r.b)("words.color_other"),children:Object(k.jsx)(l.c,{})}];return Object(k.jsx)(n.a,{closable:!0,title:Object(r.b)("settings.schedule.calendar_settings"),height:"100%",width:800,destroyOnClose:!0,onClose:m,open:a,placement:u?"bottom":"right",push:!1,styles:{body:{overflowY:"auto",paddingTop:0,paddingRight:15,paddingBottom:0}},children:Object(k.jsx)(s.a,{activeKey:d,onChange:b,items:h,style:{height:"100%"}})})};Y.displayName="CalendarSettingsDrawer";t.a=Object(c.forwardRef)(Y)},1218:function(e,t,a){"use strict";var c=a(0),r=a(50),n=a(250),s=a(2975),o=a(2921),l=a(579),i=a(137),d=a(596),b=a(613),u=a(37),j=a(2879);const m=u.e`
  query InvoiceCalendarsModal($start_date: String) {
    calendars(start_date: $start_date, all_employees: true, status: ["confirmed", "unconfirmed"]) {
      id schedule_group_id sale_id
      client {
        id name name_initials has_avatar avatar_url
      }
    }
  }
`;var h=()=>Object(j.a)(m,{fetchPolicy:"network-only"}),p=a(27),_=a(581),O=a(53),v=a.n(O),g=a(82),f=a(116),x=a(22);const y=(e,t)=>{const[a,u]=Object(c.useState)(!1),[j,m]=Object(c.useState)([]),[O,y]=Object(c.useState)(void 0),w=Object(c.useRef)(null),k=Object(c.useRef)(null),C=Object(p.a)((e=>e.theme)),$=Object(p.a)((e=>e.current_user.permissions)),S=Object(p.a)((e=>e.is_mobile)),[D,{data:{calendars:I=[]}={},loading:F}]=h(),M=Object(c.useCallback)((e=>{D({variables:{start_date:e}}),y(e),u(!0)}),[D]),z=Object(c.useCallback)((()=>{u(!1),m([]),y(void 0)}),[]);Object(c.useImperativeHandle)(t,Object(c.useCallback)((()=>({open:M,close:z})),[z,M]));const E=Object(l.l)(I.filter((e=>!e.sale_id)),(e=>e.client.id)),Y=Object.keys(E).map((e=>({client:E[e][0].client,calendars_length:E[e].length}))),N=Object(c.useCallback)((e=>{m(e||[])}),[]),H=Object(c.useMemo)((()=>[{title:Object(r.b)("words.client"),key:"client",dataIndex:"client",ellipsis:!0,render:e=>{let{id:t,name:a,has_avatar:c,avatar_url:o,name_initials:l}=e;const i=()=>c?Object(x.jsx)(s.a,{src:o||g.a.DEFAULT_PLACEHOLDER,size:"small"}):Object(x.jsx)(s.a,{style:{backgroundColor:C.color_primary},size:"small",children:l.toUpperCase()});return $.can_edit_client?Object(x.jsxs)(n.i,{title:a,className:"link text-overflow-ellipsis",onClick:()=>{var e;$.can_edit_client?null===(e=k.current)||void 0===e||e.open({id:t,initial_active_bar:"panel"}):f.b.warning(Object(r.b)("phrases.no_permission_to_do_this"))},children:[i(),"\xa0",a]}):Object(x.jsxs)(x.Fragment,{children:[i(),"\xa0",a]})}},{title:Object(r.b)("words.scheduling",{count:2}),dataIndex:"calendars_length",key:"calendars_length",align:"center",ellipsis:!0,width:S?120:140}]),[$.can_edit_client,C.color_primary,S]),R=Object(x.jsx)(o.a,{loading:F,columns:H,size:"middle",dataSource:Y,rowKey:e=>e.client.id,pagination:!1,rowSelection:{selectedRowKeys:j,onChange:N}});return Object(x.jsxs)(n.a,{destroyOnClose:!0,title:`${Object(r.b)("calendar.group_schedules")} - ${v()(O).format("DD/MM/YY")}`,open:a,onClose:z,width:550,height:"100%",placement:S?"bottom":"right",styles:{body:{padding:5}},footer:Object(x.jsx)(_.a,{close:z,submit:()=>{var e;const t=I.filter((e=>j.includes(e.client.id)&&!e.sale_id)),a=Object(i.uniq)(t.map((e=>e.schedule_group_id)));null===(e=w.current)||void 0===e||e.open({schedule_group_ids:a})},disabled:!j.length||F,save_text:`${Object(r.b)("verbs.create")} ${Object(r.b)("words.sale").toLocaleLowerCase()}`}),children:[R,Object(x.jsx)(b.a,{ref:w}),Object(x.jsx)(d.a,{ref:k})]})};y.displayName="InvoiceCalendarsDrawer";t.a=Object(c.memo)(Object(c.forwardRef)(y))},1796:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a(137),n=a(578),s=a(636),o=a(585),l=a(354),i=a(27),d=a(53),b=a.n(d);var u=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},j=a(19),m=a(50),h=a(3024),p=a(159),_=a(250),O=a(28),v=a(62),g=a(22);const f=(e,t)=>{const[a,r]=Object(c.useState)(!1),[n,s]=Object(c.useState)(!1),o=Object(v.a)(),l=()=>r(!0),i=()=>r(!1);Object(c.useImperativeHandle)(t,(()=>({open:l,close:i})));return Object(g.jsx)(h.a,{title:Object(g.jsx)(_.h,{$block:!0,$size:18,$bold:!0,children:Object(m.b)("words.attention")}),centered:!0,closable:!0,destroyOnHidden:!0,open:a,onCancel:i,zIndex:1210,footer:Object(g.jsxs)(y,{children:[Object(g.jsx)(p.a,{type:"default",onClick:i,disabled:n,children:Object(g.jsx)(_.h,{$semibold:!0,children:Object(m.b)("verbs.close")})}),Object(g.jsx)(p.a,{type:"primary",onClick:()=>{s(!0),O.b.invalidateNoEssentialCache(o),window.location.reload()},loading:n,children:Object(g.jsx)(_.h,{$semibold:!0,children:Object(m.b)("modals.data_sync.resync_button")})})]}),children:Object(g.jsx)(w,{children:Object(g.jsx)(_.h,{$size:16,children:Object(m.b)("modals.data_sync.message")})})})};f.displayName="DataSyncModal";var x=Object(c.memo)(Object(c.forwardRef)(f));const y=j.d.div.withConfig({componentId:"wb__sc-1qg6l1c-0"})(["display:flex;justify-content:flex-end;.ant-btn + .ant-btn{margin-left:8px;}"]),w=j.d.div.withConfig({componentId:"wb__sc-1qg6l1c-1"})(["padding:16px 0;"]);var k=a(628),C=a(679),$=a(833),S=a(18),D=a(674),I=a(1809),F=a(2975),M=a(2858),z=a(2859),E=a(2860),Y=a(2861),N=a(2862),H=a(2863),R=a(1829),L=a(1079),T=a(253),q=a(910);const P=()=>{const e=Object($.a)(),t=Object(s.b)((e=>e.date)),a=Object(s.b)((e=>e.dispatch)),[r,n]=Object(c.useState)(!1),[o,l]=Object(c.useState)("bottom-center"),i=Object(c.useCallback)((t=>{l(t),e({calendar_configuration_attributes:{calendar_button_position:t}},{origin:"[FloatingCalendar] setPosition"})}),[e]),d=Object(c.useCallback)((e=>{n(!1),setTimeout((()=>{i(e),n(!0)}),500)}),[i]),u=Object(c.useMemo)((()=>[{key:"title",label:Object(m.b)("calendar.button_position"),disabled:!0},{key:"top-left",icon:Object(g.jsx)(M.a,{}),value:"top-left",label:Object(m.b)("calendar.top_left"),onClick:e=>{let{key:t}=e;return d(t)}},{key:"top-center",icon:Object(g.jsx)(z.a,{}),value:"top-center",label:Object(m.b)("calendar.top"),onClick:e=>{let{key:t}=e;return d(t)}},{key:"top-right",icon:Object(g.jsx)(E.a,{}),value:"top-right",label:Object(m.b)("calendar.top_right"),onClick:e=>{let{key:t}=e;return d(t)}},{type:"divider"},{key:"bottom-left",icon:Object(g.jsx)(Y.a,{}),value:"bottom-left",label:Object(m.b)("calendar.bottom_left"),onClick:e=>{let{key:t}=e;return d(t)}},{key:"bottom-center",icon:Object(g.jsx)(N.a,{}),value:"bottom-center",label:Object(m.b)("calendar.bottom"),onClick:e=>{let{key:t}=e;return d(t)}},{key:"bottom-right",icon:Object(g.jsx)(H.a,{}),value:"bottom-right",label:Object(m.b)("calendar.bottom_right"),onClick:e=>{let{key:t}=e;return d(t)}}]),[d]),j=Object(c.useCallback)((e=>{a({type:"set_date",payload:b()(e)})}),[a]),h=Object(c.useCallback)(((e,t)=>{!1===e&&"menu"===t.source||n(e)}),[]),p=Object(c.useMemo)((()=>[{key:"calendar",label:Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(_.g,{children:[Object(g.jsxs)(A,{children:[Object(g.jsx)("div",{className:"title",children:Object(g.jsxs)("b",{children:[Object(m.b)("date.current_month")," - ",b()().format("MMMM, YYYY").toLowerCase()]})}),Object(g.jsx)(U,{showNavigation:!1,activeStartDate:t.isSame(b()(),"month")?t.toDate():b()().toDate(),value:t.isSame(b()(),"month")?t.toDate():null,onChange:j})]}),Object(g.jsx)(G,{}),Object(g.jsx)(U,{defaultActiveStartDate:t.isSame(b()(),"month")?t.clone().add(1,"month").toDate():t.toDate(),value:t.toDate(),onChange:j})]}),Object(g.jsx)(q.b,{menu_items:u,onDateChange:j,position:o})]})}]),[t,u,j,o]);return Object(g.jsx)(I.a,{menu:{items:p},placement:Object(D.h)(o),open:r,onOpenChange:h,trigger:["click"],dropdownRender:e=>Object(g.jsx)(V,{children:e}),getPopupContainer:()=>document.getElementById("floating-calendar-icon")||document.body,children:Object(g.jsx)(W,{$position:o,$visible:!!o,id:"floating-calendar-icon",children:Object(g.jsxs)("div",{children:[Object(g.jsx)(F.a,{icon:Object(g.jsx)(R.a,{}),size:30}),Object(m.b)("words.calendar")]})})})};P.displayName="FloatingCalendar";var B=Object(c.memo)(P);const A=j.d.div.withConfig({componentId:"wb__sc-erpm85-0"})([".title{min-height:44px;height:44px;margin-bottom:10px;display:flex;justify-content:center;align-items:center;}"]),G=j.d.div.withConfig({componentId:"wb__sc-erpm85-1"})(["flex:1;width:2px;background:#e2e2e2;margin:57px 2px 0 2px;"]),U=Object(j.d)(L.a).attrs({locale:T.a.language,showFixedNumberOfWeeks:!0}).withConfig({componentId:"wb__sc-erpm85-2"})(["font-family:inherit;border:none !important;background:transparent !important;"]),V=j.d.div.withConfig({componentId:"wb__sc-erpm85-3"})(["& > ul,li{cursor:default !important;}& > ul > li.ant-dropdown-menu-item.ant-dropdown-menu-item-active{background-color:#FFFFFF !important;}"]),W=j.d.div.withConfig({componentId:"wb__sc-erpm85-4"})(["position:fixed;z-index:900;color:#FFFFFF;background:rgb(255 255 255 / 0.1);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);border-radius:8px;display:",";justify-content:space-evenly;align-items:center;font-size:16rem;padding:7px 20px;border:1px solid #ddd;cursor:pointer;box-shadow:0 0 13px 0 rgba(56,56,56,0.1);transition:box-shadow .2s;&:hover{box-shadow:0 0 13px 0 rgba(56,56,56,0.2);}"," div{color:#585858;transition:color .2s;&:hover{color:rgba(255,255,255,.8);color:#3c3c3c;}.ant-avatar{background:transparent;margin-right:5px;transition:background .2s;color:",";}}"],(e=>e.$visible?"flex":"none"),(e=>{const t=S.x?0:e.theme.main_sidebar_retracted?68:139,a=S.x?60:e.theme.main_sidebar_retracted?148:298;switch(e.$position){case"top-left":return Object(j.c)(["top:145px;left:","px;"],a);case"top-center":return Object(j.c)(["top:145px;transform:translateX(-50%);left:calc(50% + ","px);"],t);case"top-right":return Object(j.c)(["top:145px;right:20px;"]);case"bottom-left":return Object(j.c)(["bottom:15px;left:","px;"],a);case"bottom-right":return Object(j.c)(["bottom:15px;right:20px;"]);default:return Object(j.c)(["bottom:15px;transform:translateX(-50%);left:calc(50% + ","px);"],t)}}),(e=>e.theme.color_primary));var J=a(37),K=a(405),Q=a(188),X=a(76);const Z=J.e`
  fragment CalendarsAttributes on Calendar {
    id

    client {
      id
      name
      nickname
      phone1
      phone2
      small_thumb_url
    }
    client_id

    employee {
      id
      view_name
    }

    inventory_product_id
    employee_id
    schedule_group_id
    schedule_color_id
    sale_invoiced
    sale_id
    deleted_at

    duration
    start_date
    start_hour
    end_hour
    obs
    status
    busy
    creation_origin
    color: calendar_color
    confirmation_link

    sale {
      id finished code
    }

    schedule_group_recurrence {
      id
      head_schedule_group_id
      frequency
      number_occurrences
    }
  }
`,ee=J.e`
  query CalendarsCalendar(
    $start_date: String,
    $end_date: String,
    $all_employees: Boolean,
    $hidden_employee_ids: [String],
  ) {
    calendars(
      start_date: $start_date,
      end_date: $end_date,
      all_employees: $all_employees,
      with_busy: true,
      hidden_employee_ids: $hidden_employee_ids,
    ) {
      ...CalendarsAttributes
    }
  }

  ${Z}
`,te=J.e`
  subscription OnCalendarUpdated {
    calendarUpdated {
      ...CalendarsAttributes
    }
  }

  ${Z}
`;var ae=e=>{let{date:t,calendar_view_interval:a,hidden_employee_ids:n}=e;const s=Object(i.a)((e=>e.cities)),o=Object(i.a)((e=>e.current_user)),l=Object(i.a)((e=>e.schedule_colors)),d=Object(i.a)((e=>e.current_user.permissions)),b=Object(i.a)((e=>e.inventory_products)),[u,j]=Object(c.useState)(!1),m=b.length>0,h=((e,t)=>({daily:e,weekly:e,monthly:e.startOf("month")}[t]||e))(t,a),p=((e,t)=>({daily:e,weekly:e.add(7,"day"),monthly:e.endOf("month")}[t]||e))(t,a),_=Object(Q.d)(),{subscribeToMore:O,data:v,loading:g}=Object(K.f)(ee,{skip:!o,fetchPolicy:"network-only",variables:{start_date:h.format("YYYY-MM-DD"),end_date:p.format("YYYY-MM-DD"),all_employees:d.can_access_all_calendars,hidden_employee_ids:n},onError:e=>{console.log(e),X.a.captureException(e)}});Object(c.useEffect)((()=>{if(o)try{O({document:te,onError:e=>{console.log(e),X.a.captureException(e)},updateQuery:(e,t)=>{let{subscriptionData:{data:{calendarUpdated:a}}}=t;if(!a)return e;console.debug("[Calendars subscription]",{calendarUpdated:a});const c=Object(r.uniqBy)([a,...e.calendars||[]],"id").filter((e=>!e.deleted_at));return{...e,calendars:c}}})}catch(e){}}),[O,s,o]);return[Object(c.useMemo)((()=>((null===v||void 0===v?void 0:v.calendars)||[]).map((e=>{if(e.busy)return e;const t={...e,inventory_product:_(e.inventory_product_id),schedule_color:l.find((t=>t.id===e.schedule_color_id))};t.inventory_product||u||!m||j(!0);return!t.client||!t.inventory_product?null:t})).filter(Boolean)),[null===v||void 0===v?void 0:v.calendars,_,l,u,m]),g,u]},ce=a(447),re=a(340),ne=a(20),se=a(579),oe=a(1279),le=a(1423),ie=a(1277),de=a(1451),be=a(1278),ue=a(1218),je=a(1209),me=a(1201),he=a(2855),pe=a(687),_e=a(3041),Oe=a(2843),ve=a(1094),ge=a(3038),fe=a(1440),xe=a(3052),ye=a(342);var we=e=>{const{date:t,updateViewInterval:a,openCalendarSettingsDrawer:r,openInvoiceCalendars:n,openOccupyCalendars:s}=e,o=Object(i.a)((e=>e.current_user.permissions));return Object(c.useMemo)((()=>{const e=[];return o.can_create_calendar&&e.push({key:"occupy-calendar",onClick:()=>s({dates:[t,t]}),icon:Object(g.jsx)(ve.a,{}),danger:!0,label:Object(m.b)("calendar.occupy.time_slots"),"data-js":"sidebar-mobile-item"}),o.can_create_sale&&e.push({key:"invoice-calendar",onClick:()=>n(t.format("YYYY-MM-DD")),icon:Object(g.jsx)(ge.a,{}),label:Object(m.b)("calendar.group_schedules"),"data-js":"sidebar-mobile-item"}),e.push({key:"visualization",type:"group",label:Object(m.b)("words.visualization"),children:[{key:"daily",icon:Object(g.jsx)(fe.a,{}),onClick:()=>a("daily"),label:Object(m.b)("words.daily")},{key:"weekly",icon:Object(g.jsx)(fe.a,{}),onClick:()=>a("weekly"),label:Object(m.b)("words.weekly")},{key:"monthly",icon:Object(g.jsx)(fe.a,{}),onClick:()=>a("monthly"),label:Object(m.b)("words.monthly")}]},{key:"divider",type:"divider"},{key:"configurations",icon:Object(g.jsx)(xe.a,{}),onClick:()=>r(),label:Object(g.jsxs)(_.g,{$alignCenter:!0,children:[Object(m.b)("words.setting_other"),Object(g.jsx)(ye.c,{date:"2025/03/01"})]}),"data-js":"sidebar-mobile-item"}),e}),[t,r,n,s,o.can_create_calendar,o.can_create_sale,a])},ke=a(638),Ce=a(916),$e=a(1128);var Se=e=>{let{openScheduleGroupDrawer:t,openCalendarModal:a,...r}=e;const n=Object(i.a)((e=>e.current_user.permissions)),{has_filter:o}=Object(Ce.a)(),l=Object($e.a)(),[d,b]=Object(c.useState)(!1),u=Object(s.b)((e=>e.date)),j=Object(s.b)((e=>e.setShowFilters)),h=we({date:u,updateViewInterval:l,...r}),p=Object(c.useMemo)((()=>[{label:Object(m.b)("words.calendar"),icon:R.a,onClick:()=>{b(!0),setTimeout((()=>{b(!1)}),1e3),a()},disabled:d},{label:Object(m.b)("words.filter",{count:2}),is_active:o,icon:o?he.a:pe.a,onClick:()=>j(!0)},{label:Object(m.b)("words.action",{count:2}),icon:_e.a,overlay_items:h},{label:Object(m.b)("verbs.create"),icon:Oe.a,disabled:!n.can_create_calendar,onClick:()=>t()}]),[u,d,o,a,t,n.can_create_calendar,j]);Object(ke.a)(p)},De=a(116),Ie=a(1850);const Fe=J.e`
  mutation WebookFullCalendarScheduleGroupSave($data: ScheduleGroupSaveInput!) {
    scheduleGroupSave(input: $data) {
      success errors
    }
  }
`;var Me=()=>{const e=Object(i.a)((e=>e.current_user.permissions.can_edit_calendar)),t=Object(i.a)((e=>e.employees)),[a]=Object(Ie.a)(Fe);return Object(c.useCallback)((c=>{let{event:r,newResource:n,revert:s,delta:o}=c;const{schedule_group_id:l,fake_event:i,employee_id:d,inventory_product_id:u,schedule_group_recurrence:j}=r.extendedProps,h=t.find((e=>e.id===d));if(!l||i||!r.start||!n&&!h||!e)return s();De.c.confirm({centered:!0,title:`${Object(m.b)("verbs.update")} ${Object(m.b)("words.scheduling")}?`,content:(()=>{var e,t;return r.start&&r.end?o?Object(g.jsx)(_.h,{$size:16,children:Object(g.jsx)(re.a,{i18nKey:"calendar.drag_calendar_date_update",values:{title:r.title,date:b()(r.start).format("L, HH:mm[h]"),employee_name:(null===n||void 0===n||null===(t=n.extendedProps)||void 0===t?void 0:t.name)||(null===h||void 0===h?void 0:h.name)},components:[Object(g.jsx)("b",{})],shouldUnescape:!0})}):Object(g.jsx)(_.h,{$size:16,children:Object(g.jsx)(re.a,{i18nKey:"calendar.drag_calendar_duration_update",values:{title:r.title,start_date:b()(r.start).format("L, HH:mm[h]"),end_date:b()(r.end).format("L, HH:mm[h]"),employee_name:(null===n||void 0===n||null===(e=n.extendedProps)||void 0===e?void 0:e.name)||(null===h||void 0===h?void 0:h.name)},components:[Object(g.jsx)("b",{})],shouldUnescape:!0})}):null})(),className:"webook-modal",cancelText:Object(m.b)("words.no"),onCancel:()=>s(),okText:Object(m.b)("words.yes"),onOk:()=>{if(!r.start||!r.end)return void s();const e=De.b.loading(`${Object(m.b)("verbs.updating")}...`,0);a({variables:{data:{id:l,force_schedule:!0,start_date:b()(r.start).format("YYYY-MM-DD"),calendars_attributes:[{id:r.id,start_date:b()(r.start).format("YYYY-MM-DD"),start_hour:b()(r.start).format("HH:mm"),end_hour:b()(r.end).format("HH:mm"),duration:b()(r.end).diff(b()(r.start),"second"),employee_id:(null===n||void 0===n?void 0:n.id)||d,inventory_product_id:u}],recurrence:{frequency:null===j||void 0===j?void 0:j.frequency,occurrences_number:null===j||void 0===j?void 0:j.number_occurrences,apply_forward:!1}}}}).then((e=>{var t,a,c,r,n;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&null!==(a=t.scheduleGroupSave)&&void 0!==a&&a.success?De.b.success(Object(m.b)("phrases.successfully_updated",{prefix:Object(m.b)("words.scheduling")})):(s(),console.log(e),De.b.error((null===e||void 0===e||null===(c=e.data)||void 0===c||null===(r=c.scheduleGroupSave)||void 0===r||null===(n=r.errors)||void 0===n?void 0:n.join(", "))||Object(m.b)("phrases.generic_save_error_message")))})).catch((e=>{s(),console.log(e),X.a.captureException(e),De.b.error(Object(m.b)("phrases.generic_save_error_message"))})).finally((()=>{e()}))}})}),[t,e,a])};var ze=e=>{const t=Object(i.a)((e=>e.current_user.permissions)),a=Object(i.a)((e=>e.employees));return Object(c.useCallback)((c=>{let{resource:r,start:n,end:s}=c;if(!r||!t.can_create_calendar)return null;const o=a.find((e=>e.id===r.id));if(!o)return null;e({initial_values:{date:b()(n),calendars:[{id:Object(ce.a)(),time:b()(n).format("HH:mm"),duration:b()(s).diff(b()(n),"minute"),employee:o}]}})}),[a,e,t.can_create_calendar])};var Ee=()=>{const e=Object(i.a)((e=>e.employees)),t=Object(i.a)((e=>e.current_user.permissions)),a=Object(i.a)((e=>e.current_user.employee_id)),r=Object(s.b)((e=>e.calendars)),n=Object(s.b)((e=>e.date)),o=Object(s.b)((e=>e.hidden_employee_ids)),l=Object(s.b)((e=>e.view_interval)),d=Object(c.useCallback)((e=>{if(!t.can_access_all_calendars&&a!=e.id)return!1;const c=e.active,r=e.calendar,n=!o.includes(e.id);return c&&r&&n}),[a,o,t.can_access_all_calendars]),b=Object(c.useCallback)((e=>e.reduce(((e,t)=>{if(!t.work)return e;const a=t.hours.map((e=>({daysOfWeek:[t.wday],startTime:e.start,endTime:e.end,work:!0})));return[...e,...a]}),[])),[]),u=Object(c.useCallback)((e=>{var t;const a=JSON.parse(e.business_hours),c=(null===(t=a.find((e=>e.wday===n.day())))||void 0===t?void 0:t.work)||"daily"!==l,s=!!r.find((t=>t.employee_id===e.id&&!t.busy));return{...e,title:e.nickname||e.name,businessHours:b(a),work_on_calendar_date:c||s}}),[b,l,r,n]);return Object(c.useMemo)((()=>e.filter(d).map(u).filter((e=>e.work_on_calendar_date)).map(((e,t)=>({...e,index:t})))),[e,d,u])};var Ye=e=>{const t=Object(s.b)((e=>e.calendars)),a=Object(s.b)((e=>e.visible_statuses)),r=Object(s.b)((e=>e.date)),n=Object(s.b)((e=>e.view_interval));return Object(c.useMemo)((()=>[...Ne({calendars:t,resources:e,date:r,calendar_view_interval:n}),...t.filter((e=>0===a.length||(e.busy?a.includes("busy"):e.sale_invoiced?a.includes("sale"):a.includes(e.status)))).map((e=>{var t;return{...e,title:e.busy?Object(m.b)("words.busy"):null===(t=e.client)||void 0===t?void 0:t.name,resourceId:e.employee_id,start:b()(`${e.start_date} ${e.start_hour}`,"YYYY-MM-DD HH:mm").toDate(),end:b()(`${e.start_date} ${e.end_hour}`,"YYYY-MM-DD HH:mm").toDate(),backgroundColor:Object(D.d)(e),borderColor:"rgba(0, 0, 0, .2)",classNames:["calendar-event",`calendar-id-${e.id}`,`client-id-${e.busy?"busy":e.client.id}`]}}))]),[n,t,r,e,a])};const Ne=e=>{const{calendars:t,resources:a,date:c,calendar_view_interval:n}=e,s=[],o=Object(r.groupBy)(t,(e=>e.employee_id));return"daily"!==n||a.filter((e=>e.schedule_interval)).forEach((e=>{var t;const a=e.schedule_interval,r=JSON.parse(e.schedule_hours).find((e=>e.wday===c.day())),n="YYYY-MM-DD HH:mm",l=c.format("YYYY-MM-DD ");let i=b()(l+r.start,n);const d=b()(l+r.end,n),u=b()(l+r.lunch_start,n),j=b()(l+r.lunch_end,n),m=b()(l+r.end,n),h=(null===(t=o[e.id])||void 0===t?void 0:t.map((e=>({start:b()(l+e.start_hour,n),end:b()(l+e.end_hour,n)}))))||[];for(;d.diff(i,"minute")>0&&i.clone().add(a,"minute")<=m;){let t=!1;const c=i.clone();r.lunch&&i<j&&i.clone().add(a,"minute")>u&&(t=!0),h.forEach((e=>{e.start<c.clone().add(a,"minute")&&e.end>c&&(t=!0)})),!t&&r.work&&s.push({title:`${i.clone().format("HH:mm")} - ${i.clone().add(a,"minute").format("HH:mm")}`,resourceId:e.id,employee_id:e.id,services:[],start:i.toDate(),end:i.clone().add(a,"minute").toDate(),fake_event:!0,backgroundColor:"white",classNames:["calendar-event","calendar-event-fake"],editable:!1,duration:a}),i=r.lunch&&i<=u&&i.clone().add(a,"minute")>u?j.clone():i.add(a,"minute")}})),s};var He=a(690),Re=a(599);const Le=e=>{let{resource:t}=e;const a=Object(i.a)((e=>e.current_user.permissions)),r=Object(i.a)((e=>e.current_user.calendar_configuration)),n=Object(c.useRef)(null),s=t.title.split(" ")[0];return Object(g.jsxs)(qe,{children:[Object(g.jsxs)(Pe,{onClick:()=>{var e;a.can_edit_employee?null===(e=n.current)||void 0===e||e.open({id:t.id}):De.b.warning(Object(m.b)("phrases.no_permission_to_do_this"))},children:[r.show_avatars&&Object(g.jsx)(Re.a,{src:t.extendedProps.avatar_url,blurhash:t.extendedProps.avatar_blurhash,size:30,style:{marginBottom:5}},t.extendedProps.avatar_url),Object(g.jsx)(_.h,{$fullWidth:!0,$block:!0,$textEllipsis:!0,$alignCenter:!0,$semibold:!0,children:s})]}),Object(g.jsx)(He.a,{ref:n})]})};Le.displayName="ResourceLabel";var Te=Le;const qe=j.d.div.withConfig({componentId:"wb__sc-zqgmcb-0"})(["padding:10px 5px 5px 5px;overflow:hidden;display:flex;justify-content:center;align-items:center;flex-direction:column;"]),Pe=j.d.div.withConfig({componentId:"wb__sc-zqgmcb-1"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;width:100%;overflow:hidden;"]),Be=e=>{let{event:t}=e;return Object(g.jsx)(Ue,{children:Object(g.jsx)(Ge,{children:Object(g.jsx)(_.h,{$paddings:2,$alignCenter:!0,$hex:"gray",$size:[12,{md:10,xs:8}],children:t.timeText})})})};Be.displayName="FakeEvent";var Ae=Be;const Ge=j.d.div.withConfig({componentId:"wb__sc-1w3qbft-0"})(["border:1px dashed rgba(0,0,0,0.2);height:100%;width:100%;border-radius:5px;display:flex;align-items:center;justify-content:center;color:gray;"]),Ue=j.d.div.withConfig({componentId:"wb__sc-1w3qbft-1"})(["height:100%;width:100%;"]);var Ve=a(691),We=a(223);var Je=e=>Object(c.memo)((t=>Object(g.jsx)(We.a,{fallback:Object(g.jsx)("div",{}),children:Object(g.jsx)(e,{...t})}))),Ke=a(1227),Qe=a(1438),Xe=a(1828),Ze=a(3055),et=a(2864),tt=a(2865),at=a(2854),ct=a(2866),rt=a(3037),nt=a(613),st=a(596),ot=a(713),lt=a(367);var it=e=>Object(c.memo)((t=>Object(g.jsx)(lt.a,{children:Object(g.jsx)(e,{...t})}))),dt=a(915),bt=a(356);const ut=e=>{const{icon:t,color:a,label:c,onClick:r,onClickIcon:n,showOnClickIcon:s=!0,...o}=e;return Object(g.jsxs)(mt,{$pointer:s||!!r,onClick:r,...o,children:[t&&Object(g.jsx)(_.d,{as:t,$top:3,$right:10,$hex:a||"rgba(0, 0, 0, 0.3)"}),Object(g.jsxs)(_.g,{$alignCenter:!0,justify:"space-between",children:[Object(g.jsx)(_.h,{$hex:a||"rgba(0, 0, 0, 0.7)",$semibold:!!a,children:c}),s&&Object(g.jsx)(_.i,{children:Object(g.jsx)(_.d,{as:n||bt.a})})]})]})};ut.displayName="ListItem";var jt=ut;const mt=Object(j.d)(_.g).withConfig({componentId:"wb__sc-1w8beft-0"})(["padding:5px 15px;",""],(e=>e.$pointer&&Object(j.c)(["cursor:pointer;&:hover{background:rgb(238,243,255);}"]))),ht=e=>{const{is_finished:t,destroy_visible:a,setDestroyVisible:c,has_recurrence:r,handleDestroyClick:n}=e,s=Object(i.a)((e=>e.current_user.permissions)),o=Object(i.a)((e=>e.theme));return s.can_destroy_calendar||t?Object(g.jsx)(Ke.a,{open:r&&a,onOpenChange:c,trigger:["hover"],overlayClassName:"calendar-popover",placement:"right",content:Object(g.jsxs)(_.g,{$column:!0,$paddings:[10,0],children:[Object(g.jsx)(jt,{color:o.colors.red,icon:()=>Object(g.jsx)(_.d,{as:at.a,$color:"red",$mTop:3,$mRight:10}),label:Object(m.b)("calendar.delete_calendar"),onClick:()=>n(),showOnClickIcon:!1},"remove-just-one"),Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsx)(jt,{color:o.colors.red,icon:()=>Object(g.jsx)(_.d,{as:at.a,$color:"red",$mTop:3,$mRight:10}),label:Object(m.b)("calendar.delete_next_calendars"),onClick:()=>n(!0),showOnClickIcon:!1},"remove-all")]}),children:Object(g.jsx)(jt,{icon:()=>Object(g.jsx)(_.d,{as:at.a,$color:"red",$mTop:3,$mRight:10}),color:o.colors.red,label:Object(m.b)("verbs.delete"),onClick:()=>!r&&n(),showOnClickIcon:r})}):null};ht.displayName="DestroyButton";var pt=ht,_t=a(641);const Ot=J.e`
  fragment ScheduleGroupAttributes on ScheduleGroup {
    id
    start_date
    status
    client_id
    client {
      ...ClientsAttributes
    }
    schedule_color_id
    obs

    schedule_group_recurrence {
      id
      frequency
      number_occurrences
      head_schedule_group_id
      schedule_groups {
        id
        start_date
        status
        client_id
      }
    }

    inventory_sale {
      id
      finished
    }

    calendars {
      id
      uuid
      start_hour
      duration
      creation_origin
      inventory_product_id
      services {
        id
        description
        duration
        price_cents
        image_url
      }
      address_id
      employee_id
      employee {
        id
        name
        avatar_url
      }
    }
  }

  ${_t.a}
`,vt=J.e`
  mutation WebookCalendarScheduleGroupSave($data: ScheduleGroupSaveInput!) {
    scheduleGroupSave(input: $data) {
      success
      errors
      schedule_group {
        ...ScheduleGroupAttributes
      }
    }
  }

  ${Ot}
`;var gt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(Ie.a)(vt,{notifyOnNetworkStatusChange:!0,...e,onError:t=>{var a;console.log(t),X.a.captureException(t),null===(a=e.onError)||void 0===a||a.call(e,t)}})};var ft=()=>{const[e,{loading:t}]=gt();return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:c,errors:r}=(null===a||void 0===a?void 0:a.scheduleGroupSave)||{};return c?{success:!0}:(De.b.error((null===r||void 0===r?void 0:r.join(", "))||Object(m.b)("phrases.generic_update_error_message")),{success:!1})}catch(a){console.log(a),X.a.captureException(a)}},t]},xt=a(547),yt=a(117),wt=a(3042),kt=a(872),Ct=a(624),$t=a(591),St=a(631);const Dt=e=>{let{calendar:t,openClient:a}=e;const c=Object(i.a)((e=>e.current_user.salon.name)),r=Object(i.a)((e=>e.current_user.permissions)),n=Object(i.a)((e=>e.current_user.salon.sms_message_configuration)),o=t.client,l=Object(Ct.b)((e=>e.schedule_group.status)),d=Object(s.b)((e=>e.calendars.filter((e=>e.schedule_group_id===t.schedule_group_id)).sort(((e,t)=>e.start_hour>t.start_hour?1:-1))));return Object(g.jsxs)(_.g,{$alignCenter:!0,$paddings:[5,15],children:[Object(g.jsx)(St.a,{style:{cursor:r.can_edit_client?"pointer":"default"},src:o.small_thumb_url,size:40,onClick:()=>{r.can_edit_client&&a()}}),Object(g.jsxs)(_.g,{$column:!0,$left:10,$isFlex:!1,style:{overflow:"hidden"},children:[Object(g.jsx)(_.h,{$semibold:!0,$textEllipsis:!0,title:o.name,children:o.name}),r.can_access_client_phone&&Object(g.jsx)(_.h,{$size:12,$color:"gray_1",children:null!==o&&void 0!==o&&o.phone2?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)($t.a,{inputStyle:{fontSize:12,color:yt.a.gray_2},hide_input_styles:!0,disabled:!0,value:o.phone2},o.phone2),Object(g.jsx)(xt.a,{color:yt.a.success,style:{cursor:"pointer",marginRight:0},icon:Object(g.jsx)(wt.a,{}),onClick:()=>{var e,a;const r=n[`sms_message_calendar_${l||"confirmed"}`]||"";Object(kt.b)({template:r,client:o,date:b()(null===(e=d[0])||void 0===e?void 0:e.start_date),calendar_hour:null===(a=d[0])||void 0===a?void 0:a.start_hour,calendars:d,salon_name:c,confirmation_link:t.confirmation_link})},children:Object(m.b)("words.chat")})]}):Object(m.b)("phrases.without_phone")})]})]})};Dt.displayName="ClientInfo";var It=Object(c.memo)(Dt);const Ft=e=>{var t,a,r;let{children:n,calendar:o}=e;const[l,d]=Object(c.useState)(!1),u=Object(c.useRef)(null),j=Object(c.useRef)(null),h=Object(c.useRef)(null),p=Object(i.a)((e=>e.is_mobile)),O=Object(i.a)((e=>e.current_user.permissions)),[v]=ft(),[f]=Object(dt.a)(),x=Object(i.a)((e=>e.schedule_colors)),y=Object(i.a)((e=>e.theme)),w=Object(s.b)((e=>e.calendars.filter((e=>!e.busy&&e.schedule_group_id===(null===o||void 0===o?void 0:o.schedule_group_id))))),k=o.sale,C=k?O.can_edit_sale:O.can_create_sale,$=!(null===k||void 0===k||!k.finished),I=!(null===(t=o.schedule_group_recurrence)||void 0===t||!t.head_schedule_group_id);if(o.busy||!o.client)return Object(g.jsx)(g.Fragment,{children:n});const F=async e=>{var t,a;let{status:c,schedule_color_id:r}=e;const n={id:o.schedule_group_id,schedule_color_id:r,status:c,calendars_attributes:w.map((e=>({id:e.id,schedule_color_id:r,status:c}))),recurrence:{frequency:null===(t=o.schedule_group_recurrence)||void 0===t?void 0:t.frequency,occurrences_number:null===(a=o.schedule_group_recurrence)||void 0===a?void 0:a.number_occurrences,apply_forward:!1}},{success:s}=await v(n)||{};s&&De.b.success(Object(m.b)("phrases.successfully_updated",{prefix:Object(m.b)("words.scheduling")}))},M=![String(S.h.undefined),String(S.h.new_schedules),String(S.h.old_calendars),String(S.h.multiple_schedules_button)].includes(o.creation_origin);return p?n:Object(g.jsxs)(Ke.a,{trigger:["hover"],zIndex:1e3,classNames:{root:"calendar-popover"},mouseEnterDelay:1,content:Object(g.jsxs)(_.g,{$column:!0,$paddings:[10,0],style:{width:230},children:[Object(g.jsx)(It,{calendar:o,openClient:()=>{var e;O.can_edit_client?null===(e=j.current)||void 0===e||e.open({id:o.client_id,initial_active_bar:"panel"}):De.b.warning(Object(m.b)("phrases.no_permission_to_do_this"))}}),Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsxs)(_.g,{$alignCenter:!0,$paddings:[5,15],children:[Object(g.jsx)(_.d,{as:Xe.a,$right:10}),Object(g.jsxs)("div",{children:[Object(g.jsxs)(_.h,{$block:!0,$semibold:!0,children:[o.start_hour," - ",o.end_hour]}),Object(g.jsxs)(_.h,{$block:!0,$size:12,children:[b()(o.start_date+o.start_hour).format("LLLL"),"h"]})]})]}),Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsxs)(_.g,{onClick:()=>{var e;O.can_edit_product?null===(e=u.current)||void 0===e||e.open({id:o.inventory_product.id}):De.b.warning(Object(m.b)("phrases.no_permission_to_do_this"))},title:`${Object(m.b)("verbs.access")} ${Object(m.b)("words.service").toLocaleLowerCase()}`,$alignCenter:!0,$paddings:[5,15],style:{whiteSpace:"nowrap",cursor:O.can_edit_product?"pointer":"default"},children:[Object(g.jsx)(_.d,{as:Ze.a,$right:10,$color:"primary"}),Object(g.jsx)(_.h,{$fullWidth:!0,$block:!0,$semibold:!0,$color:"primary",$textEllipsis:!0,children:o.inventory_product.description})]}),M&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsxs)(_.g,{$paddings:[5,15],children:[Object(g.jsx)(_.d,{as:Object(D.f)(o.creation_origin).icon,$right:10,$top:4}),Object(g.jsxs)("div",{style:{overflow:"hidden"},children:[Object(g.jsx)(_.h,{$block:!0,$semibold:!0,$textEllipsis:!0,children:Object(m.b)("words.origin")}),Object(g.jsx)(_.h,{$block:!0,$size:12,children:Object(D.f)(o.creation_origin).label})]})]})]}),!!o.obs&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsx)(Ke.a,{trigger:["hover"],classNames:{root:"calendar-popover"},placement:"right",content:Object(g.jsx)(_.g,{$paddings:15,style:{maxWidth:300},children:o.obs}),children:Object(g.jsxs)(_.g,{$paddings:[5,15],children:[Object(g.jsx)(_.d,{as:et.a,$right:10,$top:4}),Object(g.jsxs)("div",{style:{overflow:"hidden"},children:[Object(g.jsx)(_.h,{$block:!0,$semibold:!0,$textEllipsis:!0,children:Object(m.b)("words.observation")}),Object(g.jsx)(_.h,{$block:!0,$size:12,$textEllipsis:!0,children:o.obs})]})]})})]}),O.can_edit_calendar&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsx)(Ke.a,{trigger:["hover"],classNames:{root:"calendar-popover"},content:!$&&Object(g.jsx)(_.g,{$column:!0,$paddings:[10,0],children:Object.entries(zt).map((e=>{let[t,a]=e;return Object(g.jsx)(jt,{color:a.color,label:a.label,onClick:()=>F({status:t}),showOnClickIcon:!1},t)}))}),children:Object(g.jsx)(jt,{icon:tt.a,color:D.a[o.status],label:Object(D.e)(o),showOnClickIcon:!$})}),Object(g.jsx)(Ke.a,{trigger:["hover"],classNames:{root:"calendar-popover"},content:!$&&Object(g.jsxs)(_.g,{$column:!0,$paddings:[10,0],children:[x.map((e=>Object(g.jsx)(jt,{color:e.hexadecimal,label:e.name,onClick:()=>F({schedule_color_id:e.id}),showOnClickIcon:!1},e.id))),Object(g.jsx)(Qe.a,{style:{margin:"5px 0"}}),Object(g.jsx)(jt,{color:y.colors.red,icon:()=>Object(g.jsx)(_.d,{as:at.a,$color:"red",$mTop:3,$mRight:10}),label:Object(m.b)("verbs.remove"),onClick:()=>F({schedule_color_id:null}),showOnClickIcon:!1},"remove")]}),children:Object(g.jsx)(jt,{icon:ct.a,color:null===(a=o.schedule_color)||void 0===a?void 0:a.hexadecimal,label:(null===(r=o.schedule_color)||void 0===r?void 0:r.name)||Object(m.b)("calendar.no_color"),showOnClickIcon:!$})})]}),C&&Object(g.jsx)(jt,{icon:rt.a,onClickIcon:k?void 0:Oe.a,color:k?y.colors.success:y.colors.primary,label:k?`${Object(m.b)("verbs.see")} ${Object(m.b)("words.sale")} #${null===k||void 0===k?void 0:k.code}`:`${Object(m.b)("verbs.create")} ${Object(m.b)("words.sale")}`,onClick:()=>{var e;const t=k?{sale_id:null===k||void 0===k?void 0:k.id}:{schedule_group_ids:[o.schedule_group_id]};null===(e=h.current)||void 0===e||e.open(t)}}),Object(g.jsx)(pt,{is_finished:$,destroy_visible:l,setDestroyVisible:d,has_recurrence:I,handleDestroyClick:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];d(!1);const t=e?Object(g.jsx)(re.a,{i18nKey:"calendar.confirm_delete_next_calendars",components:[Object(g.jsx)("strong",{})]}):Object(m.b)("calendar.confirm_delete_calendar");De.c.confirm({centered:!0,className:"webook-modal",title:Object(m.b)("words.attention"),content:t,okText:Object(m.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(m.b)("verbs.cancel"),onOk:()=>f(o.schedule_group_id,e)})}})]}),children:[n,Object(g.jsx)(nt.a,{ref:h}),Object(g.jsx)(st.a,{ref:j}),Object(g.jsx)(ot.a,{ref:u})]})};Ft.displayName="EventPopover";var Mt=it(Ft);const zt={confirmed:{label:Object(m.b)("words.confirmed"),color:D.a.confirmed},unconfirmed:{label:Object(m.b)("words.unconfirmed"),color:D.a.unconfirmed},waiting:{label:Object(m.b)("verbs.waiting"),color:D.a.waiting},disconfirm:{label:Object(m.b)("words.disconfirmed"),color:D.a.disconfirm}},Et=e=>{let{event:t}=e;const a=t.event.extendedProps,c=b()(a.end_hour,"HH:mm").diff(b()(a.start_hour,"HH:mm"),"minute"),r=![String(S.h.undefined),String(S.h.new_schedules),String(S.h.old_calendars),String(S.h.multiple_schedules_button)].includes(a.creation_origin),n=a.busy;return Object(g.jsx)(Ht,{children:Object(g.jsx)(Mt,{calendar:{...a,duration:c},children:Object(g.jsxs)(Nt,{$color:t.backgroundColor,children:[c>=30&&Object(g.jsxs)(_.g,{$paddings:[0,4],justify:"space-between",$alignCenter:!0,children:[Object(g.jsx)(_.h,{$semibold:!0,$size:[12,{md:10,xs:8}],children:t.timeText}),Object(g.jsx)(Rt,{onClick:e=>{e.preventDefault(),e.stopPropagation()},style:{opacity:0},children:Object(g.jsx)(_.d,{as:Ve.a,$hex:"rgba(255, 255, 255, .5)"})})]}),(n||a.client)&&Object(g.jsxs)(_.g,{$column:!0,$paddings:[0,4],children:[Object(g.jsx)(_.h,{$semibold:!0,$size:[12,{md:10,xs:8}],children:n?Object(m.b)("words.busy"):Object(g.jsxs)(g.Fragment,{children:[r&&Object(g.jsx)(_.d,{as:Object(D.f)(a.creation_origin).icon,$color:"white",$right:3}),a.client.name]})}),n&&a.obs&&Object(g.jsx)(_.h,{$size:[12,{md:10,xs:8}],children:a.obs}),!n&&Object(g.jsx)(_.h,{$size:[12,{md:10,xs:8}],children:a.inventory_product.description})]})]})})})};Et.displayName="Event";var Yt=Je(Et);const Nt=j.d.div.withConfig({componentId:"wb__sc-8yldk6-0"})(["color:#FFFFFF;background-color:",";overflow:hidden;height:100%;border-radius:5px;"],(e=>e.$color)),Ht=j.d.div.withConfig({componentId:"wb__sc-8yldk6-1"})(["width:100%;height:100%;"]),Rt=Object(j.d)(_.i).withConfig({componentId:"wb__sc-8yldk6-2"})(["cursor:grab;"]),Lt=[le.a,ie.a,be.a,de.a],Tt=e=>{let{openScheduleGroupDrawer:t,openCalendarModal:a,loading_calendars:r}=e;const n=Object(i.a)((e=>e.current_user.permissions)),o=Object(i.a)((e=>e.is_mobile)),l=Object(i.a)((e=>{var t;return null===(t=e.current_user)||void 0===t?void 0:t.calendar_configuration})),d=Object(i.a)((e=>e.is_whatsapp_booster?16:e.main_sidebar_retracted?110:260)),u=Object(i.a)((e=>e.employees.filter((e=>e.active&&e.calendar)))),j=o?window.innerWidth:window.innerWidth-d,m=o?47:58,h=Object(s.b)((e=>e.date)),p=Object(s.b)((e=>e.calendars.filter((e=>!e.busy)).sort(((e,t)=>e.start_hour>t.start_hour?1:-1)))),_=Object(s.b)((e=>e.view_interval)),O=Ee(),v=Ye(O),f=Object(c.useRef)(null),x=Object(c.useRef)(null),y=Object(c.useRef)(null),w=Object(c.useRef)(null),k=Object(c.useCallback)((e=>{var t;null===(t=x.current)||void 0===t||t.open(e)}),[]),C=Object(c.useCallback)((()=>{var e;null===(e=y.current)||void 0===e||e.open()}),[]),$=Object(c.useCallback)((e=>{var t;null===(t=w.current)||void 0===t||t.open(e)}),[]),S=Object(c.useMemo)((()=>({openScheduleGroupDrawer:t,openCalendarModal:a,openOccupyCalendars:k,openCalendarSettingsDrawer:C,openInvoiceCalendars:$})),[a,C,$,k,t]);Se(S),Object(c.useEffect)((()=>{var e,t,a,c;null===(e=f.current)||void 0===e||null===(t=e.getApi)||void 0===t||null===(a=(c=t.call(e)).gotoDate)||void 0===a||a.call(c,h.toDate())}),[h]),Object(c.useEffect)((()=>{var e,t;null===(e=f.current)||void 0===e||null===(t=e.getApi)||void 0===t||t.call(e).changeView(Object(D.i)(_))}),[_]);const I=Object(c.useCallback)((e=>{var a;if(!n.can_create_calendar)return;const c=null===(a=e.resource)||void 0===a?void 0:a._resource.id,r=b()(e.date),s="00:00"===r.format("HH:mm")?Object(se.r)():r.format("HH:mm"),o=u.find((e=>e.id===c));t({initial_values:{date:r,calendars:[{id:Object(ce.a)(),time:s,employee:o}]}})}),[u,t,n.can_create_calendar]),F=Object(c.useCallback)((e=>{let{event:a}=e;const{extendedProps:c}=a;if(c.fake_event){if(!n.can_create_calendar)return;const e=b()(a.start),r=b()(a.start),s=b()(a.end).diff(r,"minute"),o=u.find((e=>e.id===c.employee_id));t({initial_values:{date:e,calendars:[{id:Object(ce.a)(),time:r.format("HH:mm"),duration:s,employee:o}]}})}else if(c.busy){if(!n.can_edit_calendar)return;const e={id:a._def.publicId,employee_ids:[c.employee_id],end_hour:c.end_hour,obs:c.obs,start_date:c.start_date,start_hour:c.start_hour};k({calendar:e})}else if(c.schedule_group_id){if(!n.can_access_calendar)return;t({schedule_group_id:c.schedule_group_id})}else;}),[u,k,t,n.can_access_calendar,n.can_create_calendar,n.can_edit_calendar]),M=Object(c.useCallback)((e=>{let{resource:t}=e;return Object(g.jsx)(Te,{resource:t})}),[]),z=Object(c.useCallback)((e=>e.event.extendedProps.fake_event?Object(g.jsx)(Ae,{event:e}):Object(g.jsx)(Yt,{event:e})),[]),E=Object(c.useCallback)((e=>{let{date:t}=e;return b()(t).format("HH:mm")}),[]),Y=Object(c.useMemo)((()=>{const e=u.length>l.visible_columns&&0!==l.visible_columns?l.visible_columns:u.length;return o?Math.min(e,4):e}),[u.length,o,l.visible_columns]),N=Object(c.useMemo)((()=>{if("daily"===_)return Math.abs((j-m)/(Y||u.length));if("weekly"===_){const e=(j-m)/(Y||u.length)/7,t=o?50:30;return Math.max(Math.abs(e),t)}return Math.abs((j-m)/7)}),[m,j,u.length,_,o,Y]),H=`00:${l.timeslot_size<10?"0":""}${l.timeslot_size}:00`,R=Me(),L=Me(),q=ze(t),P=Object(c.useMemo)((()=>{var e,t;return{latest:null===(e=p[0])||void 0===e?void 0:e.start_hour,later:null===(t=p[p.length?p.length-1:0])||void 0===t?void 0:t.end_hour}}),[p]),{slot_min_time:B,slot_max_time:A}=Object(D.c)(u,h,_),G=O.length>0;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(Pt,{onContextMenu:e=>(e.preventDefault(),!1),$has_resources:G,children:[Object(g.jsx)(oe.a,{nowIndicator:!0,dragScroll:!0,ref:f,allDaySlot:!1,headerToolbar:!1,locale:T.a.language,dateClick:I,editable:!0,eventInteractive:!1,eventStartEditable:n.can_edit_calendar,eventResizableFromStart:!0,eventDurationEditable:n.can_edit_calendar,eventResourceEditable:!0,eventDragMinDistance:50,eventDrop:R,scrollTime:b()().format("HH:mm"),eventResize:L,selectable:n.can_create_calendar,selectMirror:!0,selectOverlap:!0,unselectAuto:!0,selectMinDistance:50,select:q,dayMaxEventRows:2,dayMinWidth:N,height:"auto",stickyHeaderDates:!0,slotMinWidth:20,slotMinTime:P.latest<B?P.latest:B,slotMaxTime:P.later>A?P.later:A,schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",resourceOrder:"position",slotDuration:H,slotLabelInterval:l.timeslot_size,plugins:Lt,resources:O,events:v,eventClick:F,resourceLabelContent:M,eventContent:z,progressiveEventRendering:!0,slotLabelContent:E,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:"short"},slotLabelFormat:{hour:"2-digit",minute:"2-digit",meridiem:"short"},views:{agendaWeek:{type:"resourceTimeGridDay",duration:{days:7},dayHeaderContent:e=>Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{children:b()(e.date).format("ddd")}),Object(g.jsx)("div",{children:b()(e.date).format("DD")})]})}}}),!G&&!r&&Object(g.jsx)(Bt,{})]}),Object(g.jsx)(me.a,{ref:x}),Object(g.jsx)(je.a,{ref:y}),Object(g.jsx)(ue.a,{ref:w})]})};var qt=Object(c.memo)(Tt);const Pt=j.d.div.withConfig({componentId:"wb__sc-1xou0q5-0"})(["margin-bottom:100px;",";"],(e=>!e.$has_resources&&Object(j.c)([".fc-theme-standard td,.fc-theme-standard th{border-color:transparent !important;}"]))),Bt=Object(c.memo)((()=>{const e=Object(ne.o)();return Object(g.jsxs)(At,{children:[Object(g.jsx)(_.d,{$size:45,as:R.a}),Object(g.jsx)(_.h,{$size:22,$semibold:!0,children:Object(m.b)("calendar.no_working_hours")}),Object(g.jsx)(_.h,{$size:16,$alignCenter:!0,children:Object(g.jsx)(re.a,{i18nKey:"calendar.change_employee_working_hours",components:[Object(g.jsx)(_.i,{style:{fontSize:16},onClick:()=>e("/employees")})]})})]})})),At=j.d.div.withConfig({componentId:"wb__sc-1xou0q5-1"})(["position:absolute;top:0;right:15px;left:15px;bottom:0;height:calc(100vh - 70px - ","px);z-index:109;opacity:0.7;display:flex;align-items:center;padding:0 20px;justify-content:center;flex-direction:column;"],(e=>e.theme.menu_top_height));var Gt=a(582),Ut=a(232);const Vt=Object(c.lazy)((()=>Object(Ut.a)((()=>a.e(201).then(a.bind(null,2983)))))),Wt=Object(c.lazy)((()=>Object(Ut.a)((()=>a.e(123).then(a.bind(null,1832)))))),Jt=e=>Object(g.jsx)(Gt.a,{Desktop:Vt,Mobile:Wt,...e});Jt.displayName="Header";var Kt=Object(c.memo)(Jt);const Qt=e=>{let{fullHeight:t,onClose:a}=e;const[d,j]=Object(c.useState)(!1),[m,h]=Object(c.useState)(!1),[p,_]=Object(c.useReducer)(u,(()=>{const{visible_statuses:e,hidden_employee_ids:t,calendar_view_type:a="calendar",calendar_view_interval:r="daily"}=Object(i.a)((e=>{var t;return null===(t=e.current_user)||void 0===t?void 0:t.calendar_configuration}));return Object(c.useMemo)((()=>({date:b()(),view_type:a,view_interval:r,visible_statuses:e?JSON.parse(e):[],hidden_employee_ids:t?JSON.parse(t):[]})),[r,a,t,e])})()),O=Object(c.useRef)(null),v=Object(c.useRef)(null),f=Object(c.useRef)(null),y=Object(i.a)((e=>{var t;return null===(t=e.current_user)||void 0===t?void 0:t.calendar_configuration.timeslot_size})),w=Object(i.a)((e=>e.is_mobile)),S=Object(i.a)((e=>e.current_user.permissions)),D=Object(i.a)((e=>e.employees.map((e=>e.id)))),I=p.hidden_employee_ids.filter((e=>D.includes(e))),F=Object($.a)(),[M,z,E]=ae({date:p.date,calendar_view_interval:p.view_interval,hidden_employee_ids:I});Object(n.a)((()=>{F({calendar_configuration_attributes:{calendar_view_interval:p.view_interval,calendar_view_type:p.view_type,hidden_employee_ids:JSON.stringify(p.hidden_employee_ids),visible_statuses:JSON.stringify(Object(r.uniq)([...p.visible_statuses,"confirmed","busy"]))}},{origin:"[Calendar] useUpdateEffect"})}),[p.view_interval,p.view_type,p.visible_statuses,p.hidden_employee_ids]),Object(c.useEffect)((()=>{var e;E&&(null===(e=f.current)||void 0===e||e.open())}),[E]);const Y=Object(c.useCallback)((e=>{var t;null===(t=O.current)||void 0===t||t.open(e)}),[]),N=Object(c.useCallback)((()=>{var e;null===(e=v.current)||void 0===e||e.open()}),[]),H=Object(c.useMemo)((()=>({...p,dispatch:_,calendars:M,show_actions:d,setShowActions:j,show_filters:m,setShowFilters:h})),[M,p,d,j,m,h]);return Object(g.jsx)(s.a.Provider,{value:H,children:Object(g.jsx)(l.a,{children:Object(g.jsxs)(o.b,{style:{paddingTop:0,paddingLeft:t?0:void 0,height:t?"100%":void 0},children:[Object(g.jsx)(Xt,{}),Object(g.jsx)(Kt,{onClose:a,openCalendarModal:N}),Object(g.jsx)(Zt,{has_permission:S.can_access_calendar||S.can_access_all_calendars,$pageFull:!0,$timeslot_size:y,children:Object(g.jsx)(qt,{openScheduleGroupDrawer:Y,openCalendarModal:N,loading_calendars:z})}),!w&&S.can_access_calendar&&Object(g.jsx)(B,{}),Object(g.jsx)(C.a,{ref:O}),w&&Object(g.jsx)(k.a,{type:"one",ref:v,defaultValue:p.date.toDate(),onConfirm:e=>{_({type:"set_date",payload:b()(e)})},view_interval:p.view_interval}),Object(g.jsx)(x,{ref:f})]})})})};Qt.displayName="Calendar";t.default=Object(c.memo)(Qt);const Xt=Object(j.b)([".calendar-popover{.ant-popover-inner{border-radius:10px;overflow:hidden;padding:0;}}"]),Zt=Object(j.d)(o.c).withConfig({componentId:"wb__sc-qnml5t-0"})(["position:relative;.fc .fc-col-header-cell-cushion{padding:0;width:100%;color:rgba(0,0,0,0.65);}.fc-daygrid-day-number{color:rgba(0,0,0,0.65);}.fc .fc-timegrid-col.fc-day-today{background-color:",";}.fc .fc-daygrid-day.fc-day-today{background-color:",";}.fc-popover{z-index:999 !important;overflow-x:hidden;overflow-y:auto;max-height:300px;max-width:220px;border-radius:6px;}.fc-timegrid-axis{border-top-color:transparent !important;border-bottom-color:transparent !important;}.fc .fc-scrollgrid{border-top-width:0;border-left-width:0;}@media (max-width:768px){margin-top:0;.fc-timegrid-slot-label-cushion.fc-scrollgrid-shrink-cushion{font-size:10rem;font-weight:500;}}.fc-scrollgrid-section.fc-scrollgrid-section-header td{border-left-color:transparent !important;border-right-color:transparent !important;}.fc-col-header-cell.fc-resource{border-right-color:transparent !important;}.fc-theme-standard td,.fc-theme-standard th{border-color:rgba(221,221,221,0.5);}.fc .fc-scrollgrid-section-sticky > *{background:rgb(255 255 255 / 0.1);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);border-right:none;}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky > *{top:","px;","}.fc.fc-media-screen.fc-direction-ltr.fc-theme-standard{width:100%;margin-top:-1px;}.calendar-event-fake{background-color:rgba(255,255,255,.8) !important;border-top:3px solid rgba(0,0,0,0.05);border-left:none !important;border-right:none;&.fc-time-grid-event-inset{display:none;}&:hover{background-color:#e4e4e4 !important;}.fc-time{visibility:hidden;}.fc-title{color:#b1b1b1;}}.fc-list-table{background:#eee;& > tbody{background:",";}}.calendar-event-opaque{opacity:.5;}.calendar-shadow{box-shadow:0 0 15px 0 rgba(0,0,0,.2);}",";.fc-time-bar,.fc-row.fc-widget-header{transition:box-shadow .2s;z-index:100;border-right:1px solid #ddd;};.fc-time-list{margin:auto;text-align:center;overflow:hidden;height:100%;min-width:48px;padding:0;.fc-time{align-items:center;border-top:1px solid #ddd;box-sizing:content-box;display:flex;font-size:13rem;font-weight:normal;height:26px;justify-content:center;color:#6d6d6d;&:first-child{border-top:none;}&.fc-minor{border-top:1px dotted #ddd;font-weight:300;padding:0 8px;}}}.fc-axis{box-sizing:content-box;display:none;}.fc-unthemed th{border-color:#eee;}.fc-unthemed td.fc-today{background:",";}tr[data-time] td.fc-time{font-size:13rem;}.fc-body .fc-widget-content,.fc-axis.fc-time.fc-widget-content{border-left:none;}.fc-head .fc-head-container{border-top:none;border-left:none;border-right:none;}.page-calendar .fc-unthemed th{border-color:transparent !important;}.fc-view.fc-agendaWeek-view.fc-timeGrid-view > table{min-width:100%;width:100%;}.fc-view.fc-resourceTimeGridDay-view.fc-timeGrid-view > table{min-width:100%;width:100%;}.fc-unthemed td.fc-today{background-color:",";}.fc-time-grid-event{.fc-time{background:rgba(0,0,0,0.1);}&.fc-short{.fc-time{display:none;}.fc-title{font-size:0.90em;padding:5px;}}}.fc-time-grid tr:hover{background:#efefef;}.fc-event{border:none;font-size:12rem;transition:opacity .2s;border-radius:5px;overflow:hidden;.fc-title{padding:5px;font-weight:bold;}.fc-time{float:none;}.services-list{list-style:none;padding:5px;}&:focus{text-decoration:none;color:",";}}.fc-time-grid .fc-slats td{height:2em;border-bottom:0;}.fc-timegrid-slot{height:"," !important;}"],(e=>e.theme.colors.white),(e=>e.theme.colors.white),(e=>e.theme.menu_top_height),(e=>e.theme.is_mobile&&Object(j.c)(["top:calc(var(--safe-area-inset-top,0px) + 34px);"])),(e=>e.theme.colors.white),(e=>e.theme.is_mobile&&Object(j.c)([".fc-direction-ltr .fc-timegrid-col-events{margin:unset;}"])),(e=>e.theme.colors.white),(e=>e.theme.colors.white),(e=>e.theme.colors.white),(e=>{const t=e.$timeslot_size;return t<60?"2.5em":t<90?"3em":"4.5em"}))},638:function(e,t,a){"use strict";var c=a(0),r=a(62),n=a(27);t.a=function(e){let{disabled:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=Object(n.a)((e=>e.is_mobile)),s=Object(r.a)();Object(c.useEffect)((()=>{if(a&&!t)return s({type:"set_mobile_menu_actions",payload:e.filter(Boolean)}),()=>{s({type:"set_mobile_menu_actions",payload:[]})}}),[t,a,e,s])}},674:function(e,t,a){"use strict";a.d(t,"j",(function(){return h})),a.d(t,"g",(function(){return _})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return v})),a.d(t,"f",(function(){return g})),a.d(t,"d",(function(){return f})),a.d(t,"e",(function(){return x})),a.d(t,"c",(function(){return y})),a.d(t,"h",(function(){return w})),a.d(t,"i",(function(){return k}));var c=a(53),r=a.n(c),n=a(50),s=a(1829),o=a(1217),l=a(3065),i=a(716),d=a(717),b=a(1095),u=a(3042),j=a(2853),m=a(82);const h=(e,t,a)=>{const c=e.isSame(r()(),"week");return"daily"===t?c?e.calendar(r()(),{lastDay:`[${Object(n.b)("words.yesterday")}]`,sameDay:`[${Object(n.b)("words.today")}]`,nextDay:`[${Object(n.b)("words.tomorrow")}]`,lastWeek:"LL (ddd)",nextWeek:"dddd",sameElse:"dddd"}):e.format("LL (ddd)"):"weekly"===t?p(e,a):e.format("MMMM, YYYY")},p=(e,t)=>{const a=e.isSame(r()(),"week"),c=e.isSame(r()().add(-1,"week"),"week"),s=e.isSame(r()().add(1,"week"),"week");return a?e.format(`[${Object(n.b)("date.current_week")}]`):c?e.format(`[${Object(n.b)("date.last_week")}]`):s?e.format(`[${Object(n.b)("date.next_week")}]`):t?Object(n.b)("words.calendar"):`${e.format("LL")} - ${e.add(6,"days").format("LL")}`},_=e=>({daily:"day",weekly:"week",monthly:"month"}[e]||"day"),O={confirmed:"rgb(134, 231, 158)",unconfirmed:"rgb(97, 198, 235)",disconfirm:"rgb(249, 143, 140)",waiting:"rgb(255, 165, 0)",busy:"#CED4DA",invoiced:"rgb(157, 169, 175)"},v={confirmed:Object(n.b)("words.confirmed"),unconfirmed:Object(n.b)("words.unconfirmed"),disconfirm:Object(n.b)("words.disconfirmed"),waiting:Object(n.b)("verbs.waiting"),busy:Object(n.b)("words.busy"),invoiced:Object(n.b)("words.billed")},g=e=>({1:{label:Object(n.b)("calendar.system_schedule"),icon:s.a},2:{label:Object(n.b)("words.custom_app"),icon:o.a},3:{label:Object(n.b)("words.online_booking"),icon:l.a},4:{label:Object(n.b)("calendar.system_schedule"),icon:s.a},5:{label:`${m.a.TITLE} Pro`,icon:o.a},6:{label:"Facebook",icon:i.a},7:{label:"Instagram",icon:d.a},8:{label:Object(n.b)("calendar.multiple_schedules"),icon:s.a},9:{label:Object(n.b)("calendar.webook_offer"),icon:o.a},10:{label:Object(n.b)("calendar.webook_package"),icon:o.a},11:{label:Object(n.b)("calendar.book_with_google"),icon:b.a},12:{label:"WhatsApp",icon:u.a},13:{label:"Google",icon:b.a}}[e]||{label:Object(n.b)("calendar.unknown_origin"),icon:j.a}),f=e=>e.color,x=e=>e.busy?v.busy:e.sale_invoiced?v.invoiced:v[e.status],y=(e,t,a)=>{const c=t.day();return e.reduce(((e,t)=>{const r=JSON.parse(t.business_hours);if("weekly"===a&&!r[c].work)return{slot_min_time:"08:00",slot_max_time:"19:00"};if(!r[c].work||!r[c].hours)return e;const n=r[c].hours.length,s=r[c].hours[0].start,o=r[c].hours[n-1].end;return{slot_min_time:e.slot_min_time<s?e.slot_min_time:s,slot_max_time:e.slot_max_time>o?e.slot_max_time:o}}),{slot_min_time:"24:00",slot_max_time:"00:00"})},w=e=>({"top-left":"bottomRight","top-center":"bottom","top-right":"bottomLeft","bottom-left":"topRight","bottom-right":"topLeft","bottom-center":"top"}[e]||"top"),k=e=>({daily:"resourceTimeGridDay",weekly:"agendaWeek",monthly:"dayGridMonth"}[e]||"resourceTimeGridDay")},705:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s}));var c=a(50);const r=[{hexadecimal:"#CED4DA",name:Object(c.b)("settings.colors.gray")},{hexadecimal:"#FFEB3B",name:Object(c.b)("settings.colors.yellow")},{hexadecimal:"#FFC107",name:Object(c.b)("settings.colors.amber")},{hexadecimal:"#FFA500",name:Object(c.b)("settings.colors.orange")},{hexadecimal:"#FF5722",name:Object(c.b)("settings.colors.dark_orange")},{hexadecimal:"#CDDC39",name:Object(c.b)("settings.colors.lime")},{hexadecimal:"#8BC34A",name:Object(c.b)("settings.colors.light_green")},{hexadecimal:"#32C787",name:Object(c.b)("settings.colors.green")},{hexadecimal:"#00BCD4",name:Object(c.b)("settings.colors.cyan")},{hexadecimal:"#39BBB0",name:Object(c.b)("settings.colors.turquoise")},{hexadecimal:"#004D40",name:Object(c.b)("settings.colors.dark_teal")},{hexadecimal:"#03A9F4",name:Object(c.b)("settings.colors.light_blue")},{hexadecimal:"#2196F3",name:Object(c.b)("settings.colors.blue")},{hexadecimal:"#3F51B5",name:Object(c.b)("settings.colors.dark_blue")},{hexadecimal:"#673AB7",name:Object(c.b)("settings.colors.purple")},{hexadecimal:"#D066E2",name:Object(c.b)("settings.colors.dark_purple")},{hexadecimal:"#BA68C8",name:Object(c.b)("settings.colors.light_purple")},{hexadecimal:"#FF6B68",name:Object(c.b)("settings.colors.red")},{hexadecimal:"#E91E63",name:Object(c.b)("settings.colors.pink")},{hexadecimal:"#B71C1C",name:Object(c.b)("settings.colors.dark_red")},{hexadecimal:"#607D8B",name:Object(c.b)("settings.colors.bluish_gray")},{hexadecimal:"#795548",name:Object(c.b)("settings.colors.brown")},{hexadecimal:"#3E2723",name:Object(c.b)("settings.colors.dark_brown")}],n=[{value:"confirmed",label:Object(c.b)("words.confirmed")},{value:"unconfirmed",label:Object(c.b)("words.unconfirmed")},{value:"waiting",label:Object(c.b)("verbs.waiting")},{value:"disconfirm",label:Object(c.b)("words.canceled")},{value:"invoiced",label:Object(c.b)("words.billed")},{value:"busy",label:Object(c.b)("words.occupation")}],s=[{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#32C787",default_for:"confirmed"},{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#2196F3",default_for:"unconfirmed"},{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#FFA500",default_for:"waiting"},{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#FF6B68",default_for:"disconfirm"},{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#607D8B",default_for:"invoiced"},{name:`<${Object(c.b)("words.default")}>`,hexadecimal:"#CED4DA",default_for:"busy"}]},744:function(e,t,a){"use strict";var c=a(0),r=a(50),n=a(705),s=a(1256),o=a(2937),l=a(2824),i=a(2883),d=a(755),b=a(250),u=a(37),j=a(1850),m=a(116),h=a(76);const p=u.e`
  mutation saveCalendarColor($data: ScheduleColorSaveInput!) {
    scheduleColorSave(input: $data) {
      success
      errors
      schedule_color {
        id
        name
        hexadecimal
        default_for
        updated_at
      }
    }
  }
`;var _=()=>{const[e,{loading:t}]=Object(j.a)(p);return[async t=>{try{var a;const c=await e({variables:{data:t}}),{success:r=!1,errors:n=[],schedule_color:s}=(null===(a=c.data)||void 0===a?void 0:a.scheduleColorSave)||{};return null===n||void 0===n||n.forEach((e=>m.b.error(e))),{success:r,schedule_color:s}}catch(c){return h.a.captureException(c),m.b.error(Object(r.b)("phrases.generic_save_error_message")),console.error(c),{success:!1,schedule_color:void 0}}},{loading:t}]},O=a(2879);const v=u.e`
  query CalendarsColors($id: ID!) {
    schedule_color(id: $id) {
      id
      name
      hexadecimal
      default_for
    }
  }
`;var g=e=>Object(O.a)(v,{...e,fetchPolicy:"network-only",onError:e=>{h.a.captureException(e),console.log({error:e})}}),f=a(27),x=a(339),y=a(586),w=a(19),k=a(581),C=a(22);const $=s.a.Option,S=(e,t)=>{let{onSave:a}=e;const[u,j]=Object(c.useState)(!1),h=Object(c.useRef)(null),[p]=o.a.useForm(),{resetFields:O,submit:v,setFieldsValue:w}=p,S=Object(f.a)((e=>e.is_mobile)),[I,{loading:F,error:M}]=g({onCompleted:e=>w({id:e.schedule_color.id,name:e.schedule_color.name,default_for:e.schedule_color.default_for,color:e.schedule_color.hexadecimal})}),z=e=>{e&&I({variables:{id:e}}),j(!0),setTimeout((()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.focus()}),500)},E=Object(c.useCallback)((()=>{setTimeout((()=>O()),200),j(!1)}),[O]);Object(c.useImperativeHandle)(t,(()=>({open:z,close:E})));const[Y,{loading:N}]=_();return Object(C.jsx)(b.a,{closable:!0,open:u,title:Object(r.b)("settings.scheduling_colors"),destroyOnClose:!0,onClose:E,width:500,height:"100%",footer:Object(C.jsx)(k.a,{disabled:N,close:E,loading:F,submit:v}),children:Object(C.jsxs)(D,{children:[Object(C.jsx)(x.a,{loading:F}),Object(C.jsx)(o.a,{form:p,layout:"vertical",style:{width:"100%"},onFinish:async e=>{const t={...e,default_for:e.default_for||null},{success:c,schedule_color:n}=await Y(t);c&&n&&(m.b.success(Object(r.b)("phrases.saved_successfully",{prefix:Object(r.b)("words.color"),context:"female"})),E(),null===a||void 0===a||a(n))},children:Object(C.jsxs)(y.a,{visible:!!M,small:S,children:[Object(C.jsx)(o.a.Item,{name:"id",noStyle:!0,children:Object(C.jsx)(l.a,{type:"hidden"})}),Object(C.jsxs)(b.g,{$wrap:!0,gutter:8,children:[Object(C.jsx)(i.a,{xs:24,sm:24,children:Object(C.jsx)(o.a.Item,{name:"name",label:Object(r.b)("words.name"),rules:[{required:!0,message:Object(r.b)("phrases.required_field")}],children:Object(C.jsx)(l.a,{ref:h,autoFocus:!0,size:S?"large":"middle"})})}),Object(C.jsx)(i.a,{xs:24,sm:12,children:Object(C.jsx)(o.a.Item,{name:"color",label:Object(r.b)("words.color"),rules:[{required:!0,message:Object(r.b)("phrases.required_field")}],children:Object(C.jsx)(s.a,{size:S?"large":"middle",children:n.a.map((e=>Object(C.jsx)($,{value:e.hexadecimal,children:Object(d.b)(e.hexadecimal)},e.name)))})})}),Object(C.jsx)(i.a,{xs:24,sm:12,children:Object(C.jsx)(o.a.Item,{name:"default_for",label:Object(r.b)("settings.colors.default_for"),children:Object(C.jsx)(s.a,{allowClear:!0,size:S?"large":"middle",children:n.b.map((e=>Object(C.jsx)($,{value:e.value,children:e.label},e.value)))})})})]})]})})]})})};S.displayName="CalendarsColorDrawer";t.a=Object(c.memo)(Object(c.forwardRef)(S));const D=Object(w.d)(b.g).withConfig({componentId:"wb__sc-16z2wj7-0"})(["position:relative;height:100%;"])},755:function(e,t,a){"use strict";a.d(t,"b",(function(){return I})),a.d(t,"a",(function(){return F}));var c=a(0),r=a(50),n=a(340),s=a(705),o=a(250),l=a(2843),i=a(2976),d=a(159),b=a(585),u=a(37),j=a(405),m=a(76);const h=u.e`
  query CalendarsColors {
    schedule_colors {
      id
      name
      hexadecimal
      default_for
    }
  }
`;var p=()=>Object(j.f)(h,{fetchPolicy:"network-only",onError:e=>{m.a.captureException(e),console.log({error:e})}}),_=a(744),O=a(116),v=a(1850);const g=u.e`
  mutation DestroyCalendarColor($data: ScheduleColorDestroyInput!) {
    scheduleColorDestroy(input: $data) {
      success errors
    }
  }
`;var f=()=>{const[e]=Object(v.a)(g);return async t=>{const a=O.b.loading(`${Object(r.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:{id:t}}}),{success:r=!1,errors:n}=(null===c||void 0===c?void 0:c.scheduleColorDestroy)||{};return null===n||void 0===n||n.forEach((e=>O.b.error(e))),{success:r}}catch(c){return m.a.captureException(c),O.b.error(Object(r.b)("phrases.generic_delete_error_message")),console.error(c),{success:!1}}finally{a()}}},x=a(27),y=a(19),w=a(232),k=a(582),C=a(22);const $=Object(c.lazy)((()=>Object(w.a)((()=>a.e(182).then(a.bind(null,3095)))))),S=Object(c.lazy)((()=>Object(w.a)((()=>a.e(183).then(a.bind(null,2895)))))),D=()=>{const e=Object(x.a)((e=>e.is_mobile)),t=Object(x.a)((e=>e.current_user.permissions)),a=Object(c.useRef)(null),u=f(),{data:{schedule_colors:j=[]}={},refetch:m}=p(),h=Object(c.useCallback)((e=>{var t;return null===(t=a.current)||void 0===t?void 0:t.open(e)}),[]),v=Object(c.useCallback)((async e=>{const{success:t}=await u(e);t&&(O.b.success(Object(r.b)("phrases.deleted_successfully",{prefix:Object(r.b)("words.color"),context:"female"})),m())}),[u,m]),g=Object(c.useMemo)((()=>[...s.c,...j]),[j]);return Object(C.jsxs)(b.c,{has_permission:t.is_admin,style:{width:"100%"},children:[Object(C.jsxs)(o.g,{$column:!0,$mBottom:20,children:[Object(C.jsx)(i.a,{message:Object(C.jsx)(n.a,{i18nKey:"settings.colors.personalize_schedule",components:[Object(C.jsx)("br",{}),Object(C.jsx)("strong",{})]})}),Object(C.jsx)(o.g,{justify:"end",style:{margin:"10px 0"},children:Object(C.jsx)(d.a,{block:e,onClick:()=>h(),icon:Object(C.jsx)(l.a,{}),type:"primary",children:Object(r.b)("verbs.create")})}),Object(C.jsx)(k.a,{Desktop:$,Mobile:S,colors:g,handleDestroyCalendarColor:v,openCalendarColorModal:h})]}),Object(C.jsx)(_.a,{ref:a,onSave:m})]})};D.displayName="CalendarColors";t.c=D;const I=e=>{var t;return Object(C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(C.jsx)(F,{scale:1,$hex:e}),Object(C.jsx)(o.h,{$textEllipsis:!0,children:null===(t=s.a.find((t=>t.hexadecimal===e)))||void 0===t?void 0:t.name})]})};I.displayName="ColorWithName";const F=y.d.div.withConfig({componentId:"wb__sc-1ypvx7k-0"})(["width:","px;height:","px;min-width:20px;border-radius:3px;background-color:",";margin-right:10px;"],(e=>20*e.scale),(e=>20*e.scale),(e=>e.$hex))},763:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var c=a(0),r=a(50),n=a(250),s=a(2843),o=a(27),l=a(629),i=a(19),d=a(744),b=a(22);const u=(e,t)=>{const a=Object(c.useRef)(null),i=Object(o.a)((e=>e.schedule_colors)),u=Object(c.useCallback)((e=>Object(b.jsxs)("div",{children:[e,Object(b.jsx)(n.g,{$paddings:10,style:{borderTop:"1px solid #f0f0f0"},children:Object(b.jsx)(n.i,{onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.open()},children:Object(b.jsxs)(n.h,{$semibold:!0,children:[Object(b.jsx)(s.a,{})," ",Object(r.b)("verbs.create")," ",Object(r.b)("words.color").toLocaleLowerCase()]})})})]})),[]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.b,{allowClear:!0,ref:t,placeholder:Object(r.b)("words.default"),dropdownRender:u,getPopupContainer:Object(c.useCallback)((e=>e.parentElement),[]),...e,children:i.map((e=>Object(b.jsx)(l.a,{value:e.id,item:e,children:Object(b.jsxs)(n.g,{align:"middle",children:[Object(b.jsx)(j,{$hex:e.hexadecimal})," ",e.name]})},e.id)))}),Object(b.jsx)(d.a,{ref:a,onSave:t=>{var a;null===e||void 0===e||null===(a=e.onChange)||void 0===a||a.call(e,t.id,{label:t.id,value:t.id,key:t.id,item:t})}})]})};t.b=Object(c.forwardRef)(u);const j=i.d.div.withConfig({componentId:"wb__sc-hfh5cz-0"})(["width:20px;min-width:20px;height:20px;border-radius:5px;background-color:",";margin-right:10px;"],(e=>e.$hex))},788:function(e,t,a){"use strict";var c=a(0),r=a(629),n=a(652),s=a(27),o=a(592),l=a(250),i=a(50),d=a(19),b=a(22);const u=(e,t)=>{const[a,r]=Object(c.useState)(!1),{value:n,options:s,onConfirm:d}=e,u=Object(c.useRef)(null),j=()=>{r(!0),setTimeout((()=>{var e;null===u||void 0===u||null===(e=u.current)||void 0===e||e.scrollIntoView({behavior:"smooth",inline:"start"})}),500)},h=()=>{r(!1)};Object(c.useImperativeHandle)(t,(()=>({open:j,close:h})));const p=Object(c.useCallback)((e=>{}),[]);return Object(b.jsx)(l.b,{title:Object(i.b)("words.schedule_time"),closable:!0,height:"100%",width:700,destroyOnClose:!0,onClose:h,afterOpenChange:p,open:a,placement:"bottom",push:!1,footer:null,children:Object(b.jsx)(m,{children:s.map((e=>{const t=n===e.value;return Object(b.jsx)(o.b,{ref:t?u:void 0,$is_selected:t,onClick:()=>(d(e),void h()),children:Object(b.jsx)(l.g,{$alignCenter:!0,$paddings:10,children:e.label})},e.value)}))})})};u.displayName="TimeDrawerMobile";var j=Object(c.forwardRef)(u);const m=d.d.div.withConfig({componentId:"wb__sc-1t7ob08-0"})(["position:relative;"]),h=["00","05","10","15","20","25","30","35","40","45","50","55"],p=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"].reduce(((e,t)=>[...e,...h.map((e=>({value:`${t}:${e}`,label:`${t}:${e}h`})))]),[]),_=(e,t)=>{const a=Object(s.a)((e=>e.is_mobile)),o=e.options||p,l=Object(c.useRef)(null);var i,d;return a?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{style:{width:(null===(i=e.style)||void 0===i?void 0:i.width)||"100%"},onClick:()=>{var t;e.disabled||null===(t=l.current)||void 0===t||t.open()},children:Object(b.jsx)(n.a,{style:{...e.style,width:"100%"},className:"pointer-events-none-mobile",placeholder:o[0].label,...e,value:null===(d=o.find((t=>t.value===e.value)))||void 0===d?void 0:d.label})}),Object(b.jsx)(j,{ref:l,...e,options:o,onConfirm:t=>{var a;t&&(null===(a=e.onChange)||void 0===a||a.call(e,t.value,t))}})]}):Object(b.jsx)(r.b,{showSearch:!0,ref:t,placeholder:o[0].label,getPopupContainer:e=>e.parentElement||document.body,...e,onClick:e=>e.stopPropagation(),children:p.map((e=>Object(b.jsx)(r.a,{value:e.value,children:e.label},e.label)))})};_.displayName="TimeInput";t.a=Object(c.memo)(Object(c.forwardRef)(_))},833:function(e,t,a){"use strict";var c=a(0),r=a(148),n=a(37),s=a(27),o=a(76);t.a=()=>{const e=Object(s.a)((e=>{var t;return null===(t=e.current_user)||void 0===t?void 0:t.id})),t=Object(r.a)(),a=Object(c.useRef)(null);return Object(c.useCallback)(((c,r)=>{const{origin:n,instant:s=!1,onCompleted:i,onError:d,refetchQueries:b=[]}=r;console.debug("[useUpdateCurrentUser] scheduled:",n,r,c),a.current=setTimeout((()=>{console.debug("[useUpdateCurrentUser] executed:",n,r,c),t.mutate({mutation:l,variables:{data:{id:e,...c}},refetchQueries:b}).then((e=>{let{data:t}=e;const{updateUser:{success:a=!1,errors:c=null}={}}=t||{};a?null===i||void 0===i||i():console.log(c)})).catch((e=>{console.log(e),o.a.captureException(e),null===d||void 0===d||d()}))}),s?0:1e3)}),[t,e])};const l=n.e`
  mutation useUpdateCurrentUserMutation($data: UpdateUserInput!) {
    updateUser(input: $data) {
      success errors
    }
  }
`},834:function(e,t,a){"use strict";a(0);var c=a(250),r=a(50),n=a(1096),s=a(2989),o=a(631),l=a(53),i=a.n(l),d=a(18),b=a(19),u=a(22);const j=e=>{const{loading:t,historical:a}=e;return Object(u.jsx)(s.a,{loading:t,itemLayout:"horizontal",dataSource:a,renderItem:e=>Object(u.jsx)(s.a.Item,{style:{padding:"10px 15px",backgroundColor:"white",wordBreak:"break-word"},children:Object(u.jsx)(s.a.Item.Meta,{avatar:Object(u.jsx)(o.a,{src:void 0}),title:Object(u.jsxs)(c.h,{children:[Object(u.jsx)(c.h,{$semibold:!0,children:h(e.user_email)}),"\xa0",g(e.type),"\xa0",Object(u.jsx)(c.h,{$semibold:!0,children:p(e)}),Object(u.jsxs)(c.h,{$color:"gray_1",children:["\xa0\xa0",i()(e.created_at,d.H).format("LL, HH:mm[h]")]})]}),description:Object(u.jsxs)(c.g,{style:{display:"flex"},$fullWidth:!0,$alignCenter:!0,children:[Object(u.jsx)(m,{children:_(e)}),Object(u.jsx)("div",{children:O(e)}),Object(u.jsx)(m,{children:v(e)})]})})})})};j.displayName="HistoricalList",t.a=j;const m=b.d.div.withConfig({componentId:"wb__sc-1iqj1w1-0"})(["display:flex;max-width:50%;overflow:hidden;word-break:break-word;"]),h=e=>e||Object(r.b)("historical.online_customer"),p=e=>"destroy"===e.type?Object(r.b)("historical.schedule_destroyed",{name:e.product_service}):e.product_service?Object(u.jsxs)(u.Fragment,{children:[e.attribute_name,"\xa0",Object(u.jsxs)(c.h,{$size:12,$color:"gray_1",children:["(",e.product_service,")"]})]}):e.attribute_name,_=e=>["create","destroy"].includes(e.type)?"":e.previous_value||Object(r.b)("words.empty"),O=e=>["create","destroy"].includes(e.type)?"":Object(u.jsx)(c.d,{$paddings:[0,5],as:n.a}),v=e=>"destroy"===e.type?"":e.value,g=e=>({create:Object(r.b)("words.created"),update:Object(r.b)("words.updated"),destroy:Object(r.b)("words.destroyed")}[e])},872:function(e,t,a){"use strict";a.d(t,"b",(function(){return _}));a(0);var c=a(50),r=a(547),n=a(250),s=a(117),o=a(3042),l=a(579),i=a(18),d=a(27),b=a(591),u=a(604),j=a(53),m=a.n(j),h=a(22);const p=e=>{let{client:t,handleOpenWhatsapp:a}=e;return Object(d.a)((e=>e.current_user.permissions)).can_access_client_phone?t?Object(h.jsxs)(n.h,{$alignCenter:!0,children:[t.phone2||t.phone1?Object(h.jsx)(b.a,{value:(null===t||void 0===t?void 0:t.phone2)||(null===t||void 0===t?void 0:t.phone1),disabled:!0,hide_input_styles:!0},(null===t||void 0===t?void 0:t.phone2)||(null===t||void 0===t?void 0:t.phone1)):Object(c.b)("phrases.without_phone"),(t.phone2||t.phone1)&&Object(h.jsx)(r.a,{icon:Object(h.jsx)(o.a,{}),style:{cursor:"pointer",marginRight:0},color:s.a.success,onClick:a,children:Object(c.b)("words.chat")})]}):Object(h.jsx)(u.a,{width:"11ch"}):null};p.displayName="Contact",t.a=p;const _=e=>{const{template:t,client:a,calendars:c,calendar_hour:r="",date:n,salon_name:s,confirmation_link:o}=e,d=c.map((e=>{var t;return null===(t=e.inventory_product)||void 0===t?void 0:t.description})).join(", "),b=c.map((e=>{var t;return null===(t=e.employee)||void 0===t?void 0:t.view_name})),u=[...new Set(b)].join(", "),j=c.reduce(((e,t)=>{var a;return((null===(a=t.inventory_product)||void 0===a?void 0:a.price_cents)||0)+e}),0),h=t.replace(i.z,a.name).replace(i.B,a.nickname).replace(i.k,m()(n||"","YYYY-MM-DD").format("L")).replace(i.s,r).replace(i.f,s).replace(i.F,d).replace(i.o,u).replace(i.E,Object(l.d)(j)).replace(i.g,o||"");Object(l.z)({phone:a.phone2||a.phone1,message:h})}},916:function(e,t,a){"use strict";var c=a(0),r=a(636),n=a(27);const s=["confirmed","unconfirmed","waiting","disconfirm","sale","busy"];t.a=()=>{const e=Object(n.a)((e=>e.current_user.permissions)),t=Object(n.a)((e=>e.current_user.employee_id)),a=Object(r.b)((e=>e.hidden_employee_ids)),o=Object(r.b)((e=>e.visible_statuses)),l=Object(r.b)((e=>e.dispatch)),i=Object(n.a)((e=>e.employees)).filter((a=>!(!e.can_access_all_calendars&&t!=a.id)&&(a.active&&a.calendar))).sort(((e,t)=>(e.position||0)-(t.position||0))),d=i.map((e=>e.id)),b=d.every((e=>!a.includes(e))),u=Object(c.useCallback)((e=>{const t=o.includes(e)?o.filter((t=>t!==e)):[...o,e];return 0===o.length?l({type:"set_visible_statuses",payload:s.filter((t=>t!==e))}):0===t.length?l({type:"set_visible_statuses",payload:s}):void l({type:"set_visible_statuses",payload:t})}),[l,o]),j=Object(c.useCallback)((e=>{const t=a.includes(e)?a.filter((t=>t!==e)):[...a,e];l({type:"set_hidden_employee_ids",payload:t})}),[l,a]),m=Object(c.useCallback)((()=>{const e=b?d:a.filter((e=>!d.includes(e)));l({type:"set_hidden_employee_ids",payload:e})}),[l,d,a,b]),h=Object(c.useCallback)((()=>{l({type:"set_visible_statuses",payload:s})}),[l]),p=!b||!!o.length&&s.length!==o.length;return Object(c.useMemo)((()=>({onStatusChange:u,onResourceChange:j,toggleAllEmployees:m,resetStatus:h,employees:i,employees_ids:d,has_filter:p,all_employees_selected:b})),[u,j,m,h,i,d,p,b])}}}]);
//# sourceMappingURL=52.d204665f.chunk.js.map