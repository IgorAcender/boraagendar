(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[115],{1042:function(e,t,a){"use strict";var s=a(0),c=a(159),o=a(2855),r=a(687),l=a(50),i=a(22);const n=e=>{let{show_filters:t,setShowFilters:a}=e;return Object(i.jsx)(c.a,{className:t?"ant-btn-gold":void 0,type:t?"primary":"default",onClick:()=>a((e=>!e)),icon:t?Object(i.jsx)(o.a,{}):Object(i.jsx)(r.a,{}),children:Object(l.b)("verbs.filter")})};n.displayName="FilterButton",t.a=Object(s.memo)(n)},1435:function(e,t,a){"use strict";var s=a(0),c=a(50),o=a(250),r=a(2937),l=a(2934),i=a(2921),n=a(37),b=a(2879),d=a(76);const j=n.e`
  query CopyGoalsDrawer ($date: String) {
    all_goals (date: $date, force_reload: true) {
      employee { id name avatar_url active }
    }
  }
`;var O=e=>Object(b.a)(j,{fetchPolicy:"network-only",onCompleted:t=>{const{all_goals:a}=t,s=a.map((e=>e.employee));e(s)},onError:e=>{d.a.captureException(e),console.log(e)}}),u=a(53),p=a.n(u),h=a(27),g=a(581),m=a(116),f=a(1850);const w=n.e`
  mutation CopyGoals ($data: CopyGoalsInput!) {
    copyGoals(input: $data) {
      success
      errors
    }
  }
`;var _=()=>{const[e,{loading:t}]=Object(f.a)(w);return[Object(s.useCallback)((async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:s=!1,errors:o=[]}=(null===a||void 0===a?void 0:a.copyGoals)||{};return s&&m.b.success(Object(c.b)("goals.goals_copied_successfully")),null===o||void 0===o||o.forEach((e=>m.b.error(e))),{success:s}}catch(a){return d.a.captureException(a),m.b.error(Object(c.b)("phrases.generic_save_error_message")),console.error(a),{success:!1}}}),[e]),{loading:t}]},y=a(19),x=a(631),v=a(22);const k=(e,t)=>{let{afterSave:a}=e;const[n,b]=Object(s.useState)(!1),[d,j]=Object(s.useState)(),[u,f]=Object(s.useState)(p()().startOf("month")),[w,y]=Object(s.useState)([]),[x,k]=Object(s.useState)([]),M=Object(h.a)((e=>e.is_mobile)),S=Object(h.a)((e=>e.current_user.permissions)),$=Object(s.useCallback)((e=>{e&&f(e),b(!0)}),[]),z=Object(s.useCallback)((()=>{b(!1)}),[]);Object(s.useImperativeHandle)(t,(()=>({close:z,open:$})));const D=Object(s.useCallback)((e=>{const t=e.reduce(((e,t)=>t.active?[...e,t.id]:e),[]);y(e),k(t)}),[]),[R,{loading:E}]=O(D),[I,{loading:L}]=_(),H=Object(s.useCallback)((e=>{j(e),y([]),R({variables:{date:e.format("YYYY-MM-DD")}})}),[R]),G=Object(s.useCallback)((async()=>{if(!S.can_create_goal)return void m.b.warning(Object(c.b)("phrases.no_permission_to_do_this"));if(!d)return void m.b.warning(Object(c.b)("goals.select_period"));if(0===x.length)return void m.b.warning(Object(c.b)("goals.select_at_least_one_professional"));const e={employee_ids:x,period:d.format("YYYY-MM-DD"),new_period:u.format("YYYY-MM-DD")},{success:t}=await I(e);t&&(null===a||void 0===a||a(),z())}),[a,z,I,u,d,S.can_create_goal,x]),F=Object(s.useCallback)((e=>{e||(j(void 0),f(p()().startOf("month")),y([]),k([]))}),[]),N=Object(s.useMemo)((()=>[{title:Object(c.b)("words.employee"),dataIndex:"name",key:"employee",render:(e,t)=>Object(v.jsxs)(Y,{children:[Object(v.jsx)(C,{src:t.avatar_url}),Object(v.jsx)(o.h,{$left:7,$block:!0,$textEllipsis:!0,children:e})]})}]),[]),T=Object(s.useCallback)((e=>{k(e)}),[]),V=Object(s.useMemo)((()=>({selectedRowKeys:x,onChange:T})),[T,x]);return Object(v.jsxs)(o.a,{closable:!0,open:n,push:!1,title:Object(c.b)("goals.copy_goals"),height:"100%",destroyOnClose:!0,width:500,onClose:z,afterOpenChange:F,footer:Object(v.jsx)(g.a,{submit:G,save_text:Object(c.b)("verbs.copy"),close:z,loading:L}),children:[Object(v.jsx)(r.a,{layout:"vertical",children:Object(v.jsx)(r.a.Item,{label:Object(c.b)("words.period"),children:Object(v.jsx)(l.a,{size:M?"large":"middle",format:"MMMM/YYYY",picker:"month",inputReadOnly:!0,disabled:E,style:{width:"100%"},allowClear:!1,value:d,onChange:H})})}),Object(v.jsx)(r.a,{layout:"vertical",children:Object(v.jsx)(r.a.Item,{label:`${Object(c.b)("words.new")} ${Object(c.b)("words.period").toLocaleLowerCase()}`,children:Object(v.jsx)(l.a,{size:M?"large":"middle",format:"MMMM/YYYY",picker:"month",inputReadOnly:!0,disabled:E,style:{width:"100%"},allowClear:!1,value:u,onChange:e=>f(e)})})}),Object(v.jsx)(i.a,{rowKey:"id",showHeader:!1,dataSource:w,columns:N,rowSelection:V,pagination:!1,size:"small",loading:E})]})};k.displayName="CopyGoalsDrawer";t.a=Object(s.forwardRef)(k);const C=Object(y.d)(x.a).withConfig({componentId:"wb__sc-1wdezkx-0"})(["width:40px;height:40px;"]),Y=y.d.div.withConfig({componentId:"wb__sc-1wdezkx-1"})(["display:flex;justify-content:left;width:100%;align-items:center;padding:0;"])},2915:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(50),o=a(1809),r=a(159),l=a(250),i=a(2851),n=a(3063),b=a(1088),d=a(356),j=a(3041),O=a(2843),u=a(894),p=a(1435),h=a(767),g=a(747),m=a(27),f=a(1042),w=a(937),_=a(82),y=a(116),x=a(579),v=a(22);const k=e=>{const{setShowFilters:t,show_filters:a,setFilters:k,forceRefetch:C}=e,Y=Object(m.a)((e=>e.current_user.permissions)),M=Object(h.b)((e=>e.filters)),S=Object(h.b)((e=>e.goalDrawerRef)),$=Object(s.useRef)(null);Object(s.useEffect)((()=>{document.title=`${Object(c.b)("words.goal_other")} | ${_.a.TITLE}`}),[]);const z=Object(s.useCallback)((e=>{k((t=>({...t,period:t.period.add(e,"month")})))}),[k]),D=Object(s.useCallback)((()=>{var e;Y.can_create_goal?null===(e=S.current)||void 0===e||e.open(M.period):y.b.warning(Object(c.b)("phrases.no_permission_to_do_this"))}),[M.period,S,Y.can_create_goal]),R=[{key:"reload",icon:Object(v.jsx)(i.a,{}),label:Object(c.b)("verbs.update"),onClick:C},{key:"copy_goals",icon:Object(v.jsx)(n.a,{}),label:Object(c.b)("goals.copy_goals"),onClick:()=>{var e;Y.can_create_goal?null===(e=$.current)||void 0===e||e.open(M.period):y.b.warning(Object(c.b)("phrases.no_permission_to_do_this"))}}];return Object(v.jsxs)(u.StyledHeader,{children:[Object(v.jsxs)(u.TopContent,{children:[Object(v.jsxs)(u.StyledSkeleton,{loading:!1,active:!0,paragraph:{rows:1},title:!1,children:[Object(v.jsxs)(w.a,{style:{overflow:"hidden",display:"flex"},children:[Object(v.jsx)(l.i,{style:{paddingRight:10},onClick:()=>z(-1),children:Object(v.jsx)(l.d,{$size:25,as:b.a})}),Object(v.jsx)(u.Title,{children:Object(x.a)(M.period.format("MMMM[,] YYYY"))}),Object(v.jsx)(l.i,{style:{paddingLeft:10},onClick:()=>z(1),children:Object(v.jsx)(l.d,{$size:25,as:d.a})})]}),Object(v.jsx)(u.Title,{style:{height:40},children:Object(v.jsx)(g.a,{})})]}),Object(v.jsx)(u.StyledSkeleton,{loading:!1,className:"right",active:!0,paragraph:{rows:1,width:200},title:!1,children:Object(v.jsxs)(u.HeaderActions,{children:[Object(v.jsx)(f.a,{show_filters:a,setShowFilters:t}),Object(v.jsx)(o.a,{menu:{items:R},trigger:["click"],placement:"bottomRight",children:Object(v.jsx)(r.a,{icon:Object(v.jsx)(j.a,{}),children:Object(c.b)("words.action_other")})}),Object(v.jsx)(r.a,{icon:Object(v.jsx)(O.a,{}),type:"primary",onClick:D,children:Object(c.b)("words.new")})]})})]}),Object(v.jsx)(p.a,{afterSave:C,ref:$})]})};k.displayName="HeaderDesktop",t.default=k},687:function(e,t,a){"use strict";var s=a(13),c=a(0),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},r=a(71),l=function(e,t){return c.createElement(r.a,Object(s.a)({},e,{ref:t,icon:o}))},i=c.forwardRef(l);t.a=i}}]);
//# sourceMappingURL=115.f6882e82.chunk.js.map