(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[80],{1101:function(e,t,a){"use strict";var n=a(0),s=a(50),r=a(137),l=a(1256),o=a(37),c=a(405),i=a(116),d=a(76);const b=o.e`
  query TagsInput {
    client_tags {
      id name
    }
  }
`;var u=()=>Object(c.f)(b,{fetchPolicy:"network-only",onError:e=>{d.a.captureException(e),console.log(e),i.b.error(Object(s.b)("phrases.generic_load_error_message"))}}),_=a(22);const h=(e,t)=>{let{value_key:a="id",...o}=e;const{data:{client_tags:c=[]}={},loading:i}=u(),d=Object(n.useCallback)(((e,t)=>{const a=Object(r.deburr)(e.toLowerCase());return Object(r.deburr)(null===t||void 0===t?void 0:t.children.toLowerCase()).indexOf(a)>=0}),[]);return Object(_.jsx)(l.a,{showSearch:!0,ref:t,loading:i,placeholder:Object(s.b)("words.hashtag"),optionFilterProp:"name",filterOption:d,style:{width:"100%"},getPopupContainer:e=>e.parentNode,...o,children:c.map((e=>Object(_.jsx)(l.a.Option,{value:e[a],name:e.name,children:e.name},e.id)))})};h.displayName="TagsInput";t.a=Object(n.memo)(Object(n.forwardRef)(h))},2962:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(50),r=a(116),l=a(2854),o=a(250),c=a(1438),i=a(608),d=a(19),b=a(22);const u=e=>Object(s.b)("phrases.confirm_delete",{model:Object(s.b)("words.client",{count:e.length}).toLocaleLowerCase(),count:e.length}),_=d.d.div.withConfig({componentId:"wb__sc-m0oklf-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;background-color:#fbfbfb;border-radius:5px;box-shadow:0 2px 9px rgba(83,83,83,0.06);overflow:hidden;margin-bottom:15px;padding:10px;border:1px solid transparent;user-select:none;transition:transform .2s;"]);var h=a(37);const p=h.e`
  fragment ClientListCommonAttributes on Client {
    id
    name
    active
    avatar_url: small_thumb_url
    avatar_blurhash
    phone2
  }
`,j=h.e`
  fragment ClientListDesktopAttributes on Client {
    name_initials
    email
    phone
    obs
    birthday
    balance_cents
    has_avatar
    cpf
    rg
    cashback_balance_cents

    customer_tag_list @include(if: $customer_tag_list)

    late_payments_sum @include(if: $late_payments_sum)

    not_consumed_packages_count @include(if: $not_consumed_packages_count)

    reviews(only_last: true) @include(if: $reviews) {
      id rating description
    }

    city @include(if: $city)
  }
`,m=h.e`
  query ClientsList(
    $page: Int,
    $results: Int,
    $actives: Boolean,
    $search_query: String,
    $sort_field: String,
    $sort_order: String,
    $with_cellphone: Boolean,
    $with_debit: Boolean,
    $birthday_start_date: String,
    $birthday_end_date: String,
    $hashtags: [String],
    $last_rating: Int,

    $customer_tag_list: Boolean!,
    $late_payments_sum: Boolean!,
    $not_consumed_packages_count: Boolean!,
    $reviews: Boolean!,
    $city: Boolean!,
    $is_mobile: Boolean!,
  ) {
    all_clients(
      page: $page,
      results: $results,
      search_with_tag: $search_query,
      actives: $actives,
      sort_field: $sort_field,
      sort_order: $sort_order,
      with_cellphone: $with_cellphone,
      with_debit: $with_debit,
      last_rating: $last_rating,
      birthday_start_date: $birthday_start_date,
      birthday_end_date: $birthday_end_date,
      hashtags: $hashtags,
      use_replica: true
    ) {
      all {
        ...ClientListCommonAttributes

        ...ClientListDesktopAttributes @skip(if: $is_mobile)
      }
      total_count
    }
  }

  ${p}
  ${j}
`,O=h.e`
  query ClientsIdsList(
    $actives: Boolean,
    $search_query: String,
    $with_cellphone: Boolean,
    $with_debit: Boolean,
    $birthday_start_date: String,
    $birthday_end_date: String,
    $hashtags: [String],
    $last_rating: Int,
  ) {
    all_clients(
      search_query: $search_query,
      actives: $actives,
      with_cellphone: $with_cellphone,
      with_debit: $with_debit,
      last_rating: $last_rating,
      birthday_start_date: $birthday_start_date,
      birthday_end_date: $birthday_end_date,
      hashtags: $hashtags,
      use_replica: true
    ) {
      all {
        id active
      }
    },
  }
`;var g=a(596),v=a(627),y=a(667),f=a(938),w=a(27),x=a(1813);const k=e=>{let{handleImportContacts:t}=e;return Object(b.jsx)(x.a,{image:x.a.PRESENTED_IMAGE_SIMPLE,description:Object(b.jsxs)(o.g,{$column:!0,$alignCenter:!0,$justifyCenter:!0,$paddings:[0,15],children:[Object(b.jsx)(o.h,{$size:16,$bold:!0,children:Object(s.b)("clients.import.import_contacts_prompt")}),Object(b.jsx)(o.h,{$alignCenter:!0,children:Object(s.b)("clients.import.allow_access_to_phone_book")}),Object(b.jsx)("div",{style:{marginBottom:10}}),Object(b.jsx)(o.h,{$size:16,$link:!0,$block:!0,$alignCenter:!0,onClick:t,children:Object(s.b)("clients.import.import_now")})]})})};k.displayName="EmptyComponentMobile";var $=k,C=a(1850);const S=h.e`
  mutation DestroyAllClients($data: DestroyAllClientsInput!) {
    destroyAllClients(input: $data) {
      success
      failures {
        client { id name }
        errors
        deactivated
      }
      errors
    }
  }
`;var I=()=>{const[e]=Object(C.a)(S);return[async t=>{const a=r.b.loading(`${Object(s.b)("verbs.wait")}...`,0);try{const{data:n}=await e({variables:{data:t}}),{success:s=!1,failures:l=[],errors:o=[]}=(null===n||void 0===n?void 0:n.destroyAllClients)||{};return null===o||void 0===o||o.map((e=>r.b.error(e))),{success:s,failures:l||[]}}catch(n){return r.b.error(Object(s.b)("phrases.generic_save_error_message")),console.error(n),{success:!1,failures:[]}}finally{a()}}]};const M=h.e`
  mutation DestroyClient($data: DestroyClientInput!) {
    destroyClient(input: $data) {
      success
      deactivated
      errors
    }
  }
`;var q=()=>{const[e,{loading:t}]=Object(C.a)(M);return[async t=>{const a=r.b.loading(`${Object(s.b)("verbs.wait")}...`,0);try{const{data:n}=await e({variables:{data:t}});let{success:s=!1,errors:r=[],deactivated:l=!1}=(null===n||void 0===n?void 0:n.destroyClient)||{};return{success:s,deactivated:l,errors:r}}catch(n){return r.b.error(Object(s.b)("phrases.generic_save_error_message")),console.error(n),{success:!1}}finally{a()}},t]},D=a(775),N=a(579),L=a(616),E=a(2975),R=a(547),T=a(852),z=a(3034),A=a(2845),B=a(599),P=a(591),Y=a(53),F=a.n(Y);var H=e=>{let{openClientDrawer:t,handleDestroyClient:a}=e;const i=Object(d.f)(),u=Object(w.a)((e=>e.current_user.permissions)),_=Object(n.useCallback)((e=>{u.can_destroy_client?r.c.confirm({centered:!0,className:"webook-modal",title:Object(s.b)("words.attention"),maskClosable:!0,content:Object(s.b)("phrases.confirm_delete",{model:Object(s.b)("words.client").toLocaleLowerCase()}),okText:Object(s.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(s.b)("verbs.cancel"),onOk:()=>a(e)}):r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))}),[a,u.can_destroy_client]);return Object(n.useMemo)((()=>{const e=[{title:Object(s.b)("words.name"),default_visible:!0,always_visible:!0,key:"name",dataIndex:"name",defaultSortOrder:"ascend",className:"table-sort",sorter:!0,render:(e,a)=>Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"100%",textAlign:"start",alignItems:"center"},onClick:()=>{u.can_edit_client?t(a):r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))},title:e,children:[Object(b.jsx)(o.h,{$link:!0,children:(()=>{var e;return a.has_avatar?Object(b.jsx)(B.a,{size:"small",src:a.avatar_url,blurhash:a.avatar_blurhash}):Object(b.jsx)(E.a,{style:{backgroundColor:i.color_primary},size:"small",children:null===(e=a.name_initials)||void 0===e?void 0:e.toUpperCase()})})()}),Object(b.jsx)(o.h,{style:{lineHeight:1.1},$mLeft:5,$link:!0,children:e})]})},{title:Object(s.b)("words.email"),default_visible:!0,key:"email",dataIndex:"email",ellipsis:!0},{title:Object(s.b)("words.birth"),default_visible:!0,key:"birthday",dataIndex:"birthday",width:100,render:e=>e?F()(e).format("L"):""},{title:Object(s.b)("words.credit_other"),default_visible:!0,key:"balance_cents",dataIndex:"balance_cents",align:"right",width:90,render:e=>Object(b.jsx)("div",{style:{color:e>0?"green":void 0,wordBreak:"keep-all",whiteSpace:"nowrap"},children:Object(N.d)(e)})},{title:Object(s.b)("words.cashback"),default_visible:!1,key:"cashback_balance_cents",align:"right",dataIndex:"cashback_balance_cents",width:100,ellipsis:!0,sorter:!0,render:e=>Object(N.d)(e)},{title:Object(s.b)("acronyms.cpf"),key:"cpf",dataIndex:"cpf",width:130},{title:Object(s.b)("acronyms.rg"),key:"rg",dataIndex:"rg",width:120,ellipsis:!0},{title:Object(s.b)("words.hashtag_other"),key:"customer_tag_list",dataIndex:"customer_tag_list",include_key_on_query:!0,ellipsis:!0,render:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(b.jsx)("div",{className:"flex",title:e.join(", "),children:e.map((e=>Object(b.jsx)(K,{children:e},e)))})}},{title:Object(s.b)("words.city"),key:"city",include_key_on_query:!0,ellipsis:!0,width:200,render:e=>e.city},{title:Object(s.b)("words.debit_other"),key:"late_payments_sum",dataIndex:"late_payments_sum",width:100,align:"right",include_key_on_query:!0,render:e=>Object(b.jsx)("div",{style:{color:e>0?"red":void 0,wordBreak:"keep-all",whiteSpace:"nowrap"},children:Object(N.d)(e,{cents:!1})})},{title:Object(s.b)("clients.not_consumed_package_other"),key:"not_consumed_packages_count",dataIndex:"not_consumed_packages_count",include_key_on_query:!0,width:150,render:e=>e?Object(b.jsx)(R.a,{color:"blue",children:`${e} ${Object(s.b)("words.package",{count:e})}`}):null},{title:Object(s.b)("clients.last_review"),key:"reviews",dataIndex:"reviews",include_key_on_query:!0,width:130,render:function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const n=(null===(e=a[0])||void 0===e?void 0:e.rating)||0;return Object(b.jsx)(T.a,{title:null===(t=a[0])||void 0===t?void 0:t.description,placement:"left",children:Object(b.jsx)("div",{children:[1,2,3,4,5].map((e=>Object(b.jsx)(V,{style:{color:e<=n?i.colors.gold:"lightgray"}},e)))})})}},{title:Object(s.b)("words.observation",{count:2}),default_visible:!0,key:"obs",dataIndex:"obs",ellipsis:!0},{default_visible:!0,key:"actions",align:"center",width:80,render:e=>Object(b.jsxs)(L.a,{width:64,children:[Object(b.jsx)(T.a,{title:Object(s.b)("verbs.edit"),placement:"bottom",children:Object(b.jsx)(o.i,{className:"link",onClick:()=>{u.can_edit_client?t(e):r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))},children:Object(b.jsx)(z.a,{})})}),e.active&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(c.a,{type:"vertical"}),Object(b.jsx)(o.i,{className:"link color-red",onClick:()=>_(e.id),children:Object(b.jsx)(l.a,{})})]})]})}];if(u.can_access_client_phone){const t={title:Object(s.b)("words.cellphone"),default_visible:!0,key:"phone2",dataIndex:"phone2",width:170,render:e=>e?Object(b.jsx)(P.a,{disabled:!0,hide_input_styles:!0,value:e},e):void 0};e.splice(2,0,t)}return e}),[_,t,u.can_access_client_phone,u.can_edit_client,i.color_primary,i.colors.gold])};const K=Object(d.d)(R.a).withConfig({componentId:"wb__sc-18r06iu-0"})(["padding:0 3px;margin-right:2px;"]),V=Object(d.d)(A.a).withConfig({componentId:"wb__sc-18r06iu-1"})(["font-size:16rem;margin-right:2px;"]);var W=a(2937),G=a(1101);var J=()=>Object(n.useMemo)((()=>[{label:Object(s.b)("words.status"),name:"actives",default_value:"true",double_checkbox:{true:Object(s.b)("words.active",{count:2}),false:Object(s.b)("words.inactive",{count:2})}},{label:Object(s.b)("clients.search_tags"),name:"hashtags",render:e=>Object(b.jsx)(W.a.Item,{name:"hashtags",noStyle:!0,children:Object(b.jsx)(G.a,{allowClear:!0,value_key:"name",placeholder:`${Object(s.b)("verbs.select")} ${Object(s.b)("words.hashtag",{count:2})}`,variant:"borderless",getPopupContainer:()=>document.body,onChange:t=>e.setFieldsValue({hashtags:t})})})},{label:Object(s.b)("words.cellphone"),name:"with_cellphone",double_checkbox:{true:Object(s.b)("clients.with_cellphone"),false:Object(s.b)("clients.without_cellphone")}},{label:Object(s.b)("words.debit"),name:"with_debit",double_checkbox:{true:Object(s.b)("clients.with_debit"),false:Object(s.b)("clients.without_debit")}},{label:Object(s.b)("words.birthday"),name:"birthday",rangepicker:{start_date_name:"birthday_start_date",end_date_name:"birthday_end_date"}},{label:Object(s.b)("clients.last_review"),name:"last_rating",default_value:null,rating:{count:5,tooltips:[Object(s.b)("words.awful"),Object(s.b)("words.bad"),Object(s.b)("words.neutral"),Object(s.b)("words.good"),Object(s.b)("words.excellent")]}}]),[]),X=a(74);t.default=()=>{const e=Object(w.a)((e=>e.current_user.permissions)),t=Object(w.a)((e=>e.is_mobile)),a=Object(n.useRef)(null),d=Object(n.useRef)(null),h=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.refetch()}),[]),[p]=q(),[j]=I(),x=Object(n.useCallback)((async e=>{const{success:t,failures:n=[]}=await j({ids:e});(t||0!==n.length)&&(e=>{let{ids:t,failures:a=[],magicTableRef:n}=e;const l=0===a.length,d=a.filter((e=>e.deactivated)),u=t.length-d.length,h=a.length===t.length;var p;if(l)return r.b.success(`${t.length} ${Object(s.b)("phrases.deleted_successfully",{prefix:Object(s.b)("words.client",{count:t.length}).toLocaleLowerCase(),count:t.length})}`),void(null===(p=n.current)||void 0===p||p.afterDestroyRecord(t.length));i.a.information({closable:!0,className:"webook-modal hide-buttons",maskClosable:!0,onCancel:()=>{var e;h||null===(e=n.current)||void 0===e||e.afterDestroyRecord(a.length)},title:Object(s.b)("phrases.mass_delete_completed"),content:Object(b.jsxs)("div",{style:{maxHeight:400,width:"100%",maxWidth:480,overflowX:"hidden",overflowY:"auto"},children:[!h&&Object(b.jsxs)(o.h,{$size:16,$alignCenter:!0,$color:"green_2",children:[u,"\xa0",Object(s.b)("phrases.deleted_successfully",{prefix:Object(s.b)("words.client",{count:u}).toLocaleLowerCase(),count:u})]}),a.length>0&&Object(b.jsxs)(o.g,{$column:!0,$paddings:[0,10],children:[Object(b.jsx)(c.a,{dashed:!0}),Object(b.jsx)(o.h,{$size:16,$alignCenter:!0,$paddings:{bottom:10},children:Object(s.b)("phrases.cant_be_deleted",{prefix:`${a.length} ${Object(s.b)("words.client",{count:a.length}).toLocaleLowerCase()}`,count:a.length})}),a.map((e=>{let{client:t,errors:a=[],deactivated:n=!1}=e;return Object(b.jsxs)(_,{children:[Object(b.jsx)(o.g,{$column:!0,style:{overflow:"hidden"},children:Object(b.jsx)(o.h,{$size:16,$textEllipsis:!0,$block:!0,children:t.name})}),Object(b.jsx)(o.g,{$column:!0,style:{overflow:"hidden"},$mTop:10,children:a.map((e=>Object(b.jsx)(o.h,{$color:n?"gray_1":"red",children:e},`${e}_${t.id}`)))})]},`item_${t.id}`)}))]})]})})})({ids:e,failures:n,magicTableRef:a})}),[j]),k=Object(n.useCallback)((async t=>{if(!e.can_destroy_client)return void r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"));const{success:a,errors:n,deactivated:l}=await p({id:t});return a?(r.b.success(Object(s.b)("phrases.deleted_successfully",{prefix:Object(s.b)("words.client")})),void h()):l?(null===n||void 0===n||n.map((e=>r.b.info(e))),void h()):void(null===n||void 0===n||n.map((e=>r.b.error(e))))}),[p,e.can_destroy_client,h]),C=Object(y.a)(e.can_destroy_client,u,x),S=Object(n.useCallback)((e=>{var t;null===(t=d.current)||void 0===t||t.open({id:null===e||void 0===e?void 0:e.id,initial_active_bar:e?"panel":"register"})}),[]),M=H({openClientDrawer:S,handleDestroyClient:k}),N=J(),L=Object(n.useMemo)((()=>[{label:Object(s.b)("verbs.delete"),icon:Object(b.jsx)(l.a,{}),danger:!0,onClick:C}]),[C]),E=Object(n.useCallback)((()=>{e.can_create_client?X.a.sendMessage({type:"import_contacts"}):r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))}),[e.can_create_client]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(v.a,{ref:a,title:Object(s.b)("words.client",{count:2}),permissions_key:"client",search_placeholder:Object(s.b)("clients.search_placeholder"),EmptyComponentMobile:()=>Object(b.jsx)($,{handleImportContacts:E}),filters:N,columns:M,query:m,mass_actions:L,select_all_query:O,getData:e=>{var t;return null===e||void 0===e||null===(t=e.all_clients)||void 0===t?void 0:t.all},getTotalCount:e=>{var t;return(null===e||void 0===e||null===(t=e.all_clients)||void 0===t?void 0:t.total_count)||0},MobileItem:D.a,openDrawer:S}),Object(b.jsx)(g.a,{ref:d,onSave:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.refetch()}}),t&&Object(b.jsx)(f.a,{onSave:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.refetch()}})]})}},609:function(e,t,a){"use strict";var n=a(0),s=a(50),r=a(159),l=a(53),o=a.n(l),c=a(19),i=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(i.jsx)(b,{children:u.map((e=>{let{label:a,value:n}=e;return Object(i.jsx)(r.a,{type:"primary",onClick:()=>t(n),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(n.memo)(d);const b=c.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(s.b)("words.today"),value:[o()(),o()()]},{label:Object(s.b)("date.last_week"),value:[o()().startOf("week").subtract(1,"week"),o()().endOf("week").subtract(1,"week")]},{label:Object(s.b)("date.last_month"),value:[o()().subtract(1,"month").startOf("month"),o()().subtract(1,"month").endOf("month")]},{label:Object(s.b)("date.current_month"),value:[o()().startOf("month"),o()().endOf("month")]},{label:Object(s.b)("date.six_months_ago"),value:[o()().subtract(6,"month"),o()()]},{label:Object(s.b)("date.one_year_ago"),value:[o()().subtract(12,"month"),o()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return _})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return j}));var n=a(19),s=a(0),r=a(2934),l=a(609),o=a(22);const c=(e,t)=>{let{onRangeChange:a,...n}=e;const[c,i]=Object(s.useState)(!1),b=Object(s.useCallback)((e=>{a(e)}),[a]);return Object(o.jsx)(r.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(o.jsx)(d,{children:Object(o.jsx)(l.a,{handleChangeRange:b})}),...n,open:c,onOpenChange:i})};c.displayName="SimpleRangePicker";var i=Object(s.memo)(Object(s.forwardRef)(c));const d=n.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,n]=e;n in b&&(t[a]=b[n])})),Object.entries(e).forEach((e=>{let[t,n]=e;u.includes(t)&&(a[t]=null===n||void 0===n?void 0:n.format("YYYY-MM-DD"))})),{...e,...t,...a}},h=n.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(n.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),p=Object(n.d)(i).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),j=n.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(n.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var n=a(0),s=a(50),r=a(2937),l=a(137),o=a(578),c=a(116),i=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var _=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},h=a(53),p=a.n(h),j=a(635),m=a(22);const O={ascend:"ASC",descend:"DESC"},g=e=>e?p()(e):null;var v=a(405),y=a(610),f=a(27),w=a(582),x=a(1814),k=a(148);var $=e=>{const{total_count:t,records:a,results:r,select_all_query:l,validateRow:o=(e=>!0),rowSelector:i=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(n.useState)([]),[u,_]=Object(n.useState)(!1),[h,p]=Object(n.useState)(!1),[j,O]=Object(n.useState)(!1),g=Object(k.a)(),v=Object(n.useCallback)((()=>{_(!1),b([]),O(!1)}),[]),y=Object(n.useCallback)((()=>{const e=c.b.loading(`${Object(s.b)("verbs.selecting")}...`,0);p(!0);const{query:t,variables:a,resolve:n}=l;g.query({query:t,variables:a,fetchPolicy:"network-only"}).then(n((e=>{_(!0),b(i(e))}))).catch((e=>console.error(e))).then((()=>{e(),p(!1)}))}),[g,i,l]),f=Object(n.useCallback)(((e,t)=>{b(i(t))}),[]),w=Object(n.useMemo)((()=>a.filter(o)),[a,o]);return Object(n.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:w,total_count:t,resetSelected:v,records:a,results:r,selectAll:y,onChange:f,is_select_mode:j,setIsSelectMode:O,is_selecting_all:h,setSelectedAll:_,setIsSelectingAll:p,getCheckboxProps:e=>({disabled:!o(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(m.jsx)(x.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<w.length)return b(i(w));v()}})})),[u,d,t,v,a,r,y,f,o,w,j,O,h])},C=a(597),S=a(232);const I=Object(n.lazy)((()=>Object(S.a)((()=>a.e(12).then(a.bind(null,968)))))),M=Object(n.lazy)((()=>Object(S.a)((()=>a.e(7).then(a.bind(null,969)))))),q=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(m.jsx)(C.b,{title:t,onSearch:e,children:Object(m.jsx)(w.a,{Desktop:I,Mobile:M})})};q.displayName="DefaultHeader";var D=q,N=a(76);const L=Object(n.lazy)((()=>Object(S.a)((()=>a.e(94).then(a.bind(null,2909)))))),E=Object(n.lazy)((()=>Object(S.a)((()=>a.e(67).then(a.bind(null,3082)))))),R=e=>!(null===e||void 0===e||!e.active),T=e=>null===e||void 0===e?void 0:e.id,z=(e,t)=>{var a,h;const{columns:p,filters:x,extra_actions:k,query:C,getTotalCount:S,getData:I,select_all_query:M,validateRow:q=R,rowSelectorKey:z=T,Header:A,expandedRowKeys:B,title:P,storage_key:Y=P,has_feature:F=!0,use_storage:H=!0,addon_id:K,has_joyride:V=!0,show_create_button:W=!0,item_selectable:G=!0,parseFilters:J=y.d,rowClassName:X,mobileSwipeLeft:U}=e,Q=Object(f.a)((e=>e.current_user.permissions)),Z=Object(f.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${Y}`,[te]=r.a.useForm(),ae=(null===(a=p.find((e=>e.sorter)))||void 0===a?void 0:a.key)||p[0].key,ne=(null===(h=p.find((e=>e.defaultSortOrder)))||void 0===h?void 0:h.defaultSortOrder)||p[0].defaultSortOrder||"ascend",se=Object(n.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:n,local_storage_key:s,visible_columns:r,use_storage:l}=e,o=Object(d.c)(s);if(o&&l){const e=null===o||void 0===o?void 0:o.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...o,filters_value:{...o.filters_value,start_date:g(o.filters_value.start_date),end_date:g(o.filters_value.end_date),birthday_start_date:g(o.filters_value.birthday_start_date),birthday_end_date:g(o.filters_value.birthday_end_date),start_date_open:g(o.filters_value.start_date_open),start_date_close:g(o.filters_value.start_date_close),end_date_open:g(o.filters_value.end_date_open),end_date_close:g(o.filters_value.end_date_close)}}:o}const c=null===n||void 0===n?void 0:n.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:O[t],filters_value:c,visible_columns:r}})({local_storage_key:ee,filters:x,default_sort_field:ae,default_sort_order:ne,visible_columns:p.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:H})),[p,ae,ne,x,ee,H]),[re,le]=Object(n.useReducer)(_,se);Object(o.a)((()=>{Object(d.d)(ee,{...re,page:1})}),[re]);const[oe,ce]=Object(n.useState)(""),[ie,de]=Object(n.useState)([]),[be,ue]=Object(n.useState)(0),_e=Object(n.useRef)(!1),he=(e=>{const{columns:t,visible_columns:a=[],dispatch:n}=e,s=t.filter((e=>a.includes(e.key)||e.always_visible)),r=s.findIndex((e=>"actions"===e.key));return r&&(s[r]={...s[r],title:Object(m.jsx)(j.a,{columns:t,visible_columns:a,dispatch:n})}),s})({dispatch:le,columns:p,visible_columns:re.visible_columns}),pe={...Object(n.useMemo)((()=>p.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=re.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[p,re.visible_columns]),...J(re.filters_value),is_mobile:Z,search_query:oe,sort_field:re.sort_field,sort_order:re.sort_order,page:re.page,results:re.results},{loading:je,refetch:me}=Object(v.f)(C,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:pe,skip:!F,onError:e=>{console.log(e),N.a.captureException(e),c.b.error(Object(s.b)("phrases.loading_error"))},onCompleted:e=>{ue(S(e)),1!==re.page&&_e.current?de((t=>[...t,...I(e)||[]])):de(I(e)||[])}}),Oe=Object(n.useCallback)((()=>{if(1===re.page)return me();le({type:"set_page",payload:1})}),[re.page,me]),ge=Object(n.useCallback)((()=>{_e.current=!0,le({type:"set_page",payload:re.page+1})}),[re.page]),ve=Object(n.useCallback)(((e,t,a)=>{a.order&&(le({type:"set_sort_field",payload:a.field}),le({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&le({type:"set_page",payload:e.current}),e.pageSize&&le({type:"set_results",payload:e.pageSize})}),[]),ye=$({total_count:be,results:re.results,records:ie,select_all_query:{query:M,variables:pe,resolve:e=>t=>{let{data:a}=t;return e(I(a)||[])}},validateRow:q,rowSelector:Object(n.useCallback)((e=>e.filter(q).map(z)),[z,q])}),fe=Object(n.useMemo)((()=>B?B(ie):void 0),[ie,B]),we=Object(n.useCallback)((e=>{me(),ye.resetSelected();const t=Math.ceil((be-e)/re.results);re.page>t&&le({type:"set_page",payload:t})}),[re.page,me,re.results,ye,be]),xe=Object(n.useCallback)((e=>{le({type:"set_page",payload:1}),ce(e)}),[ce]),ke=Object(n.useCallback)((e=>{le({type:"set_filters_value",payload:e}),le({type:"set_page",payload:1})}),[]),$e=Object(n.useMemo)((()=>F?e.permissions?e.permissions:e.permissions_key?{can_create:Q[`can_create_${e.permissions_key}`],can_edit:Q[`can_edit_${e.permissions_key}`],can_access:Q[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[F,e.permissions,e.permissions_key,Q]),Ce=Object(n.useCallback)((()=>{if(ye.resetSelected(),Z)return 1===re.page?void me():void le({type:"set_page",payload:1});me()}),[Z,me,ye,re.page]);Object(n.useImperativeHandle)(t,(()=>({afterDestroyRecord:we,refetch:Ce})));const Se=Object(n.useMemo)((()=>({onSearch:xe,row_selection:ye,onFiltersChange:ke,data_source:ie,form:te,total_count:be,loading:je,new_columns:he,onChange:ve,expanded_row_keys:fe,refetch:Oe,handleFetchMore:ge,...e,has_feature:F,addon_id:K,has_joyride:V,show_create_button:W,item_selectable:G,validateRow:q,rowSelectorKey:z,permissions:$e,...re,dispatch:le,rowClassName:X,extra_actions:k})),[xe,ye,ke,ie,te,be,je,he,ve,fe,Oe,ge,e,F,V,W,q,z,$e,re,X,k,G,K]),Ie=Object(n.useMemo)((()=>null===x||void 0===x?void 0:x.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[x]);return Object(m.jsx)(b.a.Provider,{value:Se,children:Object(m.jsxs)(i.b,{children:[A?Object(m.jsx)(A,{}):Object(m.jsx)(D,{}),Object(m.jsx)(r.a,{form:te,component:!1,layout:"vertical",onChange:Object(l.debounce)(ke,1e3),initialValues:{...Ie,...re.filters_value},children:Object(m.jsx)(w.a,{Desktop:L,Mobile:E,mobileSwipeLeft:U})})]})})};z.displayName="MagicTable";t.a=Object(n.memo)(Object(n.forwardRef)(z))},635:function(e,t,a){"use strict";var n=a(0),s=a(50),r=a(1809),l=a(852),o=a(1814),c=a(3052),i=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:o,setVisibleColumns:i}=e;const[b,_]=Object(n.useState)(!1),h=Object(n.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===o||void 0===o||o({type:"set_visible_columns",payload:e}),null===i||void 0===i||i(e)}),[t,o,i]),p=Object(n.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===o||void 0===o||o({type:"set_visible_columns",payload:t}),void(null===i||void 0===i||i(t))}const t=[...a,e];null===o||void 0===o||o({type:"set_visible_columns",payload:t}),null===i||void 0===i||i(t)}),[o,i,a]),j=Object(n.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const n={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>p(t.key),checked:a.includes(t.key),children:t.title})};return[...e,n]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(s.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:h,children:Object(s.b)("words.default")})]}),children:e}]}),[t,h,p,a]);return Object(d.jsx)(r.a,{menu:{items:j},trigger:["click"],open:b,onOpenChange:_,className:"no-print table-configuration",children:Object(d.jsx)(l.a,{title:Object(s.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(c.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(i.d)(o.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])},667:function(e,t,a){"use strict";var n=a(0),s=a(50),r=a(116);t.a=(e,t,a)=>Object(n.useCallback)((n=>{e?r.c.confirm({centered:!0,className:"webook-modal",title:Object(s.b)("words.attention"),maskClosable:!0,content:t(n),okText:Object(s.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(s.b)("verbs.cancel"),onOk:()=>{a(n)}}):r.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))}),[a,e,t])},938:function(e,t,a){"use strict";var n=a(0),s=a(18),r=a(250),l=a(579);const o=(e,t,a)=>"31"===t?e.length>=11?e:e.length<8?null:a?`55${a}${e}`:null:e,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(!e)return null;const n=Object(l.q)(e),s=o(n,t,a);if(!s)return null;const r="55"===s.substring(0,2);if(r)return s;const c=11===s.length;return c?`55${s}`:s};var i=a(116),d=a(1438),b=a(50),u=a(723),_=a(350),h=a(757),p=a(27),j=a(37),m=a(1850),O=a(76);const g=j.e`
  mutation ContactDrawerSave($data: ImportContactsInput!) {
    importContacts(input: $data) {
      success
      failures {
        contact {
          name
          phone1
          phone2
          email
          birthday
        }
        errors
      }
    }
  }
`;var v=()=>{const[e,{loading:t}]=Object(m.a)(g);return[async t=>{try{const{data:a}=await e({variables:{data:{contact_attributes:t}}}),{success:n=!0,failures:s=[]}=(null===a||void 0===a?void 0:a.importContacts)||{};return{success:n,failures:s}}catch(a){return O.a.captureException(a),i.b.error(Object(b.b)("clients.import.cant_import")),console.error(a),{success:!1,failures:[]}}},t]},y=a(608),f=a(1813),w=a(19),x=a(592),k=a(53),$=a.n(k),C=a(591),S=a(22);const I=e=>{let{contact:t,...a}=e;return Object(S.jsx)(x.b,{...a,style:{alignItems:"center",padding:"10px 15px"},children:Object(S.jsxs)(r.g,{$column:!0,style:{overflow:"hidden"},children:[Object(S.jsx)(r.h,{$semibold:!0,$textEllipsis:!0,$block:!0,children:t.name}),!!t.phone2&&Object(S.jsxs)(r.h,{$block:!0,$color:"gray_1",$size:12,children:[Object(b.b)("words.cellphone"),":\xa0",Object(S.jsx)(q,{value:t.phone2})]}),!!t.phone1&&Object(S.jsxs)(r.h,{$block:!0,$color:"gray_1",$size:12,children:[Object(b.b)("words.phone"),":\xa0",Object(S.jsx)(q,{value:t.phone1})]}),!!t.email&&Object(S.jsxs)(r.h,{$textEllipsis:!0,$block:!0,$color:"gray_1",$size:12,children:[Object(b.b)("words.email"),":\xa0",t.email]}),!!t.birthday&&Object(S.jsxs)(r.h,{$block:!0,$color:"gray_1",$size:12,children:[Object(b.b)("words.birthday"),":\xa0",$()(t.birthday,"YYYY-MM-DD").format("LL")]})]})})};I.displayName="ContactItemMobile";var M=I;const q=Object(w.d)(C.a).attrs({disabled:!0,hide_input_styles:!0,containerStyle:{width:"unset",height:"unset"}}).withConfig({componentId:"wb__sc-1kdnven-0"})(["input{font-size:12rem !important;color:"," !important;line-height:18px !important;}"],(e=>e.theme.colors.gray_1));var D=a(604);const N=()=>Object(S.jsx)(x.b,{children:Object(S.jsxs)(r.g,{$column:!0,$paddings:[10,15],children:[Object(S.jsx)(D.a,{width:"22ch"}),Object(S.jsx)(D.a,{width:"18ch"}),Object(S.jsx)(D.a,{width:"25ch"})]})});N.displayName="ContactItemLoading";var L=N;const E=e=>{let{contacts:t,loading:a}=e;return a?Object(S.jsx)(T,{children:[-1,-2,-3,-4,-5,-6,-7,-8].map((e=>Object(S.jsx)(L,{},`contact-${e}`)))}):Object(S.jsxs)(T,{children:[0===t.length&&Object(S.jsx)(f.a,{description:Object(b.b)("phrases.empty"),image:f.a.PRESENTED_IMAGE_SIMPLE}),t.map(((e,t)=>Object(S.jsx)(M,{contact:e},`${e.record_id}_${t}`)))]})};E.displayName="TableMobile";var R=E;const T=w.d.div.withConfig({componentId:"wb__sc-1nc337t-0"})(["width:100%;"]);var z=a(581);const A=e=>{var t;let{onSave:a}=e;const[l,o]=Object(n.useState)(!1),[j,m]=Object(n.useState)([]),[O,g]=Object(n.useState)(!1),f=Object(p.a)((e=>e.current_user)),w=Object(p.a)((e=>e.current_platform)),x=null===(t=Object(p.a)((e=>e.current_user.salon.phone)))||void 0===t?void 0:t.substring(2,4),k=Object(p.a)((e=>e.current_user.salon.country_id)),[C,I]=v(),[M]=Object(u.a)();Object(_.a)(Object(n.useMemo)((()=>({import_contacts_response:e=>{let{success:t,contacts:a}=e;t?(g(!0),o(!0),setTimeout((()=>{const e=((e,t,a)=>e.map((e=>{let{phone1:n,phone2:s,given_name:r,family_name:l,...o}=e;return{...o,name:`${r} ${l}`,phone2:c(s,t,a)}})))(a,k,x);m(e),g(!1)}),100)):i.b.warning(Object(b.b)("clients.import.access_contacts_required"))}})),[k,x]));const q=()=>{o(!1)},D=Object(n.useCallback)((e=>{e||m([])}),[]);return Object(S.jsx)(r.b,{open:l,title:Object(b.b)("clients.import.import_contacts",{count:j.length}),onClose:q,placement:"bottom",height:"100%",width:"100%",closable:!0,destroyOnClose:!0,afterOpenChange:D,footer:Object(S.jsx)(z.a,{loading:I,disabled:0===j.length||O,save_text:Object(b.b)("verbs.import"),submit:async()=>{const e=j.map((e=>{let{record_id:t,...a}=e;return a})),{success:t,failures:n}=await C(e);t&&(((e,t)=>{const n=t.length===e.length;n||(q(),null===a||void 0===a||a()),y.a.success({closable:!0,className:"webook-modal hide-buttons",maskClosable:!0,title:Object(b.b)("clients.import.import_completed"),onCancel:()=>Object(h.a)(),content:Object(S.jsxs)("div",{style:{maxHeight:400,width:"100%",maxWidth:480,overflowX:"hidden",overflowY:"auto"},children:[!n&&Object(b.b)("clients.import.contacts_imported",{count:e.length-t.length}),t.length>0&&Object(S.jsxs)(r.g,{$column:!0,$paddings:[0,10],children:[Object(S.jsx)(d.a,{dashed:!0}),Object(b.b)("clients.import.failed_contact_import",{count:t.length}),t.map(((e,t)=>{let{contact:a,errors:n}=e;return Object(S.jsxs)(P,{children:[Object(S.jsxs)(r.g,{$column:!0,style:{overflow:"hidden"},children:[Object(S.jsx)(r.h,{$size:16,$textEllipsis:!0,$block:!0,children:a.name}),a.phone2&&Object(S.jsxs)(Y,{children:[Object(b.b)("words.cellphone"),": ",a.phone2]}),a.phone1&&Object(S.jsxs)(Y,{children:[Object(b.b)("words.phone"),": ",a.phone1]}),a.email&&Object(S.jsxs)(Y,{$textEllipsis:!0,children:[Object(b.b)("words.email"),": ",a.email]}),a.birthday&&Object(S.jsxs)(Y,{children:[Object(b.b)("words.birthday"),": ",$()(a.birthday,"YYYY-MM-DD").format("LL")]})]}),Object(S.jsx)(r.g,{$column:!0,style:{overflow:"hidden"},$mTop:10,children:n.map((e=>Object(S.jsx)(r.h,{style:{color:"#FF7875"},children:e},`${e}_${a.name}`)))})]},`item_${t}_${a.name}`)}))]})]})})})(e,n),((e,t)=>{M({message:`### IMPORTA\xc7\xc3O DOS CONTATOS\nO cliente [${f.name}](${s.j}${f.id}) do estabelecimento ${f.salon.name} importou seus contatos\nTotal: ${e.length}\nImportados: ${e.length-t.length}\nN\xe3o Importados: ${t.length}\n*Sistema Operacional*: ${w}`,channel:"#dev-importacao"})})(e,n))}}),children:Object(S.jsx)(B,{children:Object(S.jsx)(R,{contacts:j,loading:O})})})};A.displayName="ContactListDrawer";t.a=Object(n.memo)(A);const B=w.d.div.withConfig({componentId:"wb__sc-1y2mg6v-0"})(["position:relative;height:100%;margin-bottom:60px;"]),P=w.d.div.withConfig({componentId:"wb__sc-1y2mg6v-1"})(["display:flex;width:100%;flex-direction:column;align-items:center;background-color:#fbfbfb;border-radius:5px;box-shadow:0 2px 9px rgba(83,83,83,0.06);overflow:hidden;margin-bottom:15px;padding:10px;border:1px solid transparent;user-select:none;transition:transform .2s;"]),Y=Object(w.d)(r.h).withConfig({componentId:"wb__sc-1y2mg6v-2"})(["display:block;color:#828282;"])}}]);
//# sourceMappingURL=80.5e2225c7.chunk.js.map