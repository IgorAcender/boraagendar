(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[100],{2959:function(e,t,a){"use strict";a.r(t);var s=a(0),l=a(50),r=a(116),o=a(18),c=a(2854),n=a(1438),i=a(608),d=a(250),b=a(19),u=a(22);const _=e=>Object(l.b)("phrases.confirm_delete",{model:Object(l.b)("words.package_template",{count:e.length}).toLocaleLowerCase(),count:e.length}),p=b.d.div.withConfig({componentId:"wb__sc-1a4yqx6-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;background-color:#fbfbfb;border-radius:5px;box-shadow:0 2px 9px rgba(83,83,83,0.06);overflow:hidden;margin-bottom:15px;padding:10px;border:1px solid transparent;user-select:none;transition:transform .2s;"]);var m=a(37);const j=m.e`
  query PacakageTemplatesList(
    $page: Int,
    $results: Int,
    $search_query: String,
    $sort_field: String,
    $sort_order: String,
    $actives: Boolean
  ) {
    all_package_templates(
      page: $page,
      results: $results,
      search_term: $search_query,
      sort_field: $sort_field,
      sort_order: $sort_order,
      actives: $actives
    ) {
      all {
        id name active total_cents

        package_template_items {
          id quantity price_cents

          product {
            id description
          }
        }
      }
      total_count
    }
  }
`,h=m.e`
  query PacakageTemplatesIdsList($actives: Boolean) {
    all_package_templates(actives: $actives) {
      all {
        id active
      }
    },
  }
`;var v=a(627),g=a(890),O=a(1850);const f=m.e`
  mutation DestroyAllInventoryPackageTemplate($data: DestroyAllPackageTemplatesInput!) {
    destroyAllInventoryPackageTemplates(input: $data) {
      success
      failures { id code errors }
      errors
    }
  }
`;var y=()=>{const[e]=Object(O.a)(f);return[Object(s.useCallback)((async t=>{const a=r.b.loading(`${Object(l.b)("verbs.wait")}...`,0);try{const{data:s}=await e({variables:{data:t}}),{success:l=!1,failures:o=[],errors:c=[]}=(null===s||void 0===s?void 0:s.destroyAllInventoryPackageTemplates)||{};return null===c||void 0===c||c.map((e=>r.b.error(e))),{success:l,failures:o||[]}}catch(s){return r.b.error(Object(l.b)("phrases.generic_save_error_message")),console.error(s),{success:!1,failures:[]}}finally{a()}}),[e])]},k=a(667);const w=m.e`
  mutation DestroyPackageTemplate($data: DestroyPackageTemplateInput!) {
    destroyInventoryPackageTemplate(input: $data) {
      success errors
    }
  }
`;var x=()=>{const[e,{loading:t}]=Object(O.a)(w),a=Object(s.useCallback)((async t=>{const a=r.b.loading(`${Object(l.b)("verbs.wait")}...`,0);try{const{data:s}=await e({variables:{data:{id:t}}}),{success:l=!1,errors:o=[]}=(null===s||void 0===s?void 0:s.destroyInventoryPackageTemplate)||{};return null===o||void 0===o||o.map((e=>r.b.error(e))),{success:l}}catch(s){return r.b.error(Object(l.b)("phrases.generic_save_error_message")),console.error(s),{success:!1}}finally{a()}}),[e]);return[a,t]},C=a(852),$=a(579),S=a(616),T=a(3034),I=a(27);var q=e=>{let{openPackageTemplateDrawer:t,handleDestroyPackageTemplate:a}=e;const o=Object(I.a)((e=>e.current_user.permissions)),i=Object(s.useCallback)((e=>{null!==o&&void 0!==o&&o.can_destroy_sale?r.c.confirm({centered:!0,className:"webook-modal",title:Object(l.b)("words.attention"),maskClosable:!0,content:Object(l.b)("phrases.confirm_delete",{model:Object(l.b)("words.package_template").toLocaleLowerCase()}),okText:Object(l.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(l.b)("verbs.cancel"),onOk:()=>a(e)}):r.b.warning(Object(l.b)("phrases.no_permission_to_do_this"))}),[a,null===o||void 0===o?void 0:o.can_destroy_sale]);return Object(s.useMemo)((()=>[{title:Object(l.b)("words.name"),default_visible:!0,always_visible:!0,key:"name",dataIndex:"name",defaultSortOrder:"ascend",className:"table-sort",sorter:!0,ellipsis:!0,render:(e,a)=>Object(u.jsx)("button",{style:{maxWidth:"100%"},title:e,className:"link text-overflow-ellipsis",onClick:()=>t(a),children:e})},{title:Object(l.b)("words.total"),key:"total_cents",dataIndex:"total_cents",default_visible:!0,align:"right",width:180,render:e=>Object($.d)(e)},{default_visible:!0,key:"actions",align:"center",width:100,render:(e,a)=>Object(u.jsxs)(S.a,{width:84,children:[Object(u.jsx)(C.a,{title:Object(l.b)("verbs.edit"),placement:"bottom",children:Object(u.jsx)("button",{className:"link",onClick:()=>t(a),children:Object(u.jsx)(T.a,{})})}),Object(u.jsx)(n.a,{type:"vertical"}),Object(u.jsx)("button",{className:"link color-red",onClick:()=>i(a.id),children:Object(u.jsx)(c.a,{})})]})}]),[i,t])};var R=()=>Object(s.useMemo)((()=>[{label:Object(l.b)("words.status"),name:"actives",default_value:"true",double_checkbox:{true:Object(l.b)("words.active_other"),false:Object(l.b)("words.disabled_other")}}]),[]),M=a(583);const P=e=>{var t;const{item:a}=e,s=(null===a||void 0===a||null===(t=a.package_template_items)||void 0===t?void 0:t.length)||1;return Object(u.jsxs)("div",{style:{width:"100%"},children:[Object(u.jsx)(M.b,{width:16,$block:!0,$bold:!0,children:null===a||void 0===a?void 0:a.name}),Object(u.jsxs)(d.g,{justify:"space-between",$top:2,children:[Object(u.jsx)(M.b,{width:6,$block:!0,$color:"gray_1",$size:12,children:Object(l.b)("clients.package.item",{count:s})}),Object(u.jsx)(M.b,{width:8,$block:!0,$color:"gray_1",$size:12,children:Object($.d)(null===a||void 0===a?void 0:a.total_cents)})]})]})};P.displayName="PackageTemplateItemMobile";var D=Object(s.memo)(P),N=a(2921);const L=e=>{let{package_template:t}=e;const a=[{title:`${Object(l.b)("words.service")}/${Object(l.b)("words.product")}`,key:"name",ellipsis:!0,render:(e,t)=>t.product.description},{title:Object(l.b)("words.quantity"),key:"quantity",dataIndex:"quantity",width:100},{title:Object(l.b)("words.unitary_price"),key:"price_cents",dataIndex:"price_cents",align:"right",width:180,render:e=>Object($.d)(e)},{key:"actions",width:100}];return Object(u.jsx)(A,{columns:a,dataSource:t.package_template_items,rowKey:"id",pagination:!1})};L.displayName="PackageItems";var z=L;const A=Object(b.d)(N.a).withConfig({componentId:"wb__sc-7jcnq4-0"})([".ant-table-content{min-height:0 !important;height:auto !important;}.ant-table-expanded-row td{padding:12px 8px !important;}"]);var E=a(593);t.default=()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),a=Object(I.a)((e=>e.current_user.permissions)),[b]=x(),[m]=y(),O=Object(s.useCallback)((async t=>{const{success:a,failures:s=[]}=await m({ids:t});(a||0!==s.length)&&(e=>{let{ids:t,failures:a,magicTableRef:s}=e;const o=a.length===t.length,c=0===a.length,b=t.length-a.length;var _;if(c)return r.b.success(`${b} ${Object(l.b)("phrases.deleted_successfully",{prefix:Object(l.b)("words.package_template",{count:b}).toLocaleLowerCase(),count:b})}`),void(null===(_=s.current)||void 0===_||_.afterDestroyRecord(b));i.a.information({closable:!0,className:"webook-modal hide-buttons",maskClosable:!0,onCancel:()=>{var e;o||null===(e=s.current)||void 0===e||e.afterDestroyRecord(b)},title:Object(l.b)("phrases.mass_delete_completed"),content:Object(u.jsxs)("div",{style:{maxHeight:400,width:"100%",maxWidth:480,overflowX:"hidden",overflowY:"auto"},children:[!o&&Object(u.jsxs)(d.h,{$size:16,$alignCenter:!0,$color:"green_2",children:[b,"\xa0",Object(l.b)("phrases.deleted_successfully",{prefix:Object(l.b)("words.package_template",{count:b}).toLocaleLowerCase(),count:b})]}),a.length>0&&Object(u.jsxs)(d.g,{$column:!0,$paddings:[0,10],children:[Object(u.jsx)(n.a,{dashed:!0}),Object(u.jsx)(d.h,{$size:16,$alignCenter:!0,$paddings:{bottom:10},children:Object(l.b)("phrases.failure_destroy_message",{model:Object(l.b)("words.package_template",{count:a.length}).toLocaleLowerCase(),count:a.length})}),a.map((e=>{let{id:t,code:a,errors:s=[]}=e;return Object(u.jsxs)(p,{children:[Object(u.jsx)(d.g,{$column:!0,style:{overflow:"hidden"},children:Object(u.jsxs)(d.h,{$size:16,$textEllipsis:!0,$block:!0,children:[Object(l.b)("words.name"),"\xa0",a]})}),Object(u.jsx)(d.g,{$column:!0,style:{overflow:"hidden"},$mTop:10,children:s.map((e=>Object(u.jsx)(d.h,{style:{color:"#FF7875"},children:e},`${e}_${t}`)))})]},`package_template_item_${t}`)}))]})]})})})({ids:t,failures:s,magicTableRef:e})}),[m]),f=Object(s.useCallback)((async t=>{var a;const{success:s}=await b(t);s&&(r.b.success(Object(l.b)("phrases.deleted_successfully",{prefix:Object(l.b)("words.package_template")})),null===(a=e.current)||void 0===a||a.refetch())}),[b]),w=Object(k.a)(a.can_destroy_package,_,O),C=Object(s.useCallback)((e=>{var a;null===(a=t.current)||void 0===a||a.open(null===e||void 0===e?void 0:e.id)}),[]),$=Object(s.useCallback)((e=>{a.can_edit_package?C(e):r.b.warning(Object(l.b)("phrases.no_permission_to_do_this"))}),[C,a.can_edit_package]),S=q({openPackageTemplateDrawer:$,handleDestroyPackageTemplate:f}),T=R(),M=Object(s.useCallback)((e=>Object(u.jsx)(z,{package_template:e})),[]),P=Object(s.useMemo)((()=>({expandedRowRender:M})),[M]),N=Object(s.useMemo)((()=>[{label:Object(l.b)("verbs.delete"),icon:Object(u.jsx)(c.a,{}),danger:!0,onClick:w,disabled:!a.can_destroy_package}]),[w,a.can_destroy_package]);Object(E.a)({feature_keys:["has_packages_template"],addon_keys:["has_packages_template"],search:o.a.ID_PACKAGE_TEMPLATE});const L=Object(s.useCallback)((e=>{var t;return(null===e||void 0===e||null===(t=e.all_package_templates)||void 0===t?void 0:t.total_count)||0}),[]),A=Object(s.useCallback)((e=>{var t;return null===e||void 0===e||null===(t=e.all_package_templates)||void 0===t?void 0:t.all}),[]),F=Object(s.useCallback)((e=>e.active),[]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(v.a,{ref:e,title:Object(l.b)("words.package_template_other"),permissions_key:"package",search_placeholder:Object(l.b)("input.search_by_name"),filters:T,columns:S,mass_actions:N,query:j,select_all_query:h,getData:A,getTotalCount:L,expandable:P,validateRow:F,MobileItem:D,openDrawer:C}),Object(u.jsx)(g.a,{ref:t,afterSave:()=>{var t;return null===(t=e.current)||void 0===t?void 0:t.refetch()}})]})}},609:function(e,t,a){"use strict";var s=a(0),l=a(50),r=a(159),o=a(53),c=a.n(o),n=a(19),i=a(22);const d=e=>{let{handleChangeRange:t}=e;return Object(i.jsx)(b,{children:u.map((e=>{let{label:a,value:s}=e;return Object(i.jsx)(r.a,{type:"primary",onClick:()=>t(s),children:a},a)}))})};d.displayName="ExtraRangeComponent",t.a=Object(s.memo)(d);const b=n.d.div.withConfig({componentId:"wb__sc-hoi2yi-0"})(["display:flex;flex-wrap:wrap;justify-content:space-between;padding-top:8px;.ant-btn{cursor:pointer;width:49%;text-align:center;margin-bottom:8px;margin-right:0;}"]),u=[{label:Object(l.b)("words.today"),value:[c()(),c()()]},{label:Object(l.b)("date.last_week"),value:[c()().startOf("week").subtract(1,"week"),c()().endOf("week").subtract(1,"week")]},{label:Object(l.b)("date.last_month"),value:[c()().subtract(1,"month").startOf("month"),c()().subtract(1,"month").endOf("month")]},{label:Object(l.b)("date.current_month"),value:[c()().startOf("month"),c()().endOf("month")]},{label:Object(l.b)("date.six_months_ago"),value:[c()().subtract(6,"month"),c()()]},{label:Object(l.b)("date.one_year_ago"),value:[c()().subtract(12,"month"),c()()]}]},610:function(e,t,a){"use strict";a.d(t,"d",(function(){return _})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return j}));var s=a(19),l=a(0),r=a(2934),o=a(609),c=a(22);const n=(e,t)=>{let{onRangeChange:a,...s}=e;const[n,i]=Object(l.useState)(!1),b=Object(l.useCallback)((e=>{a(e)}),[a]);return Object(c.jsx)(r.a,{ref:t,showNow:!1,renderExtraFooter:()=>Object(c.jsx)(d,{children:Object(c.jsx)(o.a,{handleChangeRange:b})}),...s,open:n,onOpenChange:i})};n.displayName="SimpleRangePicker";var i=Object(l.memo)(Object(l.forwardRef)(n));const d=s.d.div.withConfig({componentId:"wb__sc-13lwjt0-0"})(["width:265px;"]),b={true:!0,false:!1,all:null,none:null},u=["start_date","end_date","birthday_start_date","birthday_end_date","start_date_open","start_date_close","end_date_open","end_date_close"],_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},a={};return Object.entries(e).forEach((e=>{let[a,s]=e;s in b&&(t[a]=b[s])})),Object.entries(e).forEach((e=>{let[t,s]=e;u.includes(t)&&(a[t]=null===s||void 0===s?void 0:s.format("YYYY-MM-DD"))})),{...e,...t,...a}},p=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-0"})(["display:flex;flex-direction:column;background-color:",";border-radius:16px;box-shadow:0 0 10px 5px #f3f3f3;padding:15px;border:1px solid rgba(0 0 0 / 3%);transition:box-shadow .1s;margin-bottom:5px;.ant-checkbox-wrapper + .ant-checkbox-wrapper{overflow:hidden;margin-left:0;width:100%;:not(:first-child){overflow:hidden;white-space:nowrap;text-overflow:ellipsis;word-break:keep-all;}}.ant-radio-wrapper{margin-right:0;}.ant-checkbox-group-item{margin-right:0;}.ant-calendar-picker-clear{background:transparent;color:",";}.ant-calendar-picker-input{border-top:none;border-left:none;border-right:none;border-radius:0;margin-top:5px;background:transparent;"," &:focus{box-shadow:none;}}.anticon-calendar{color:rgba(0,0,0,.2);}",""],(e=>e.theme.colors.white),(e=>e.theme.dark&&e.theme.dark_white),(e=>e.theme.dark&&`\n      border-color: ${e.theme.dark_secondary};\n      color: ${e.theme.dark_white};\n    `),(e=>e.tags&&Object(s.c)(["display:flex;flex-wrap:wrap;.ant-tag{margin:0 4px 4px 0;cursor:pointer;}"]))),m=Object(s.d)(i).withConfig({componentId:"wb__sc-gq8qm5-1"})(["width:100%;border-top:none;border-left:none;border-right:none;border-radius:0 !important;margin-top:5px;background:transparent;&.ant-picker-focused{box-shadow:none;}"]),j=s.d.div.withConfig({componentId:"wb__sc-gq8qm5-2"})(["min-width:0;width:0;z-index:210;text-overflow:ellipsis;white-space:nowrap;position:sticky;top:calc(","px + 10px);overflow:hidden;max-height:calc(100vh - 60px);align-self:flex-start;transition:width .2s;",""],(e=>e.theme.menu_top_height),(e=>!!e.$visible&&Object(s.c)(["min-width:230px;width:230px;padding-right:7px;overflow-y:auto;overflow-x:hidden;"])))},627:function(e,t,a){"use strict";var s=a(0),l=a(50),r=a(2937),o=a(137),c=a(578),n=a(116),i=a(585),d=a(28),b=a(598);const u={show_filters:!1,page:1,results:20,sort_field:"name",sort_order:"ascend",filters_value:{},visible_columns:[]};var _=(e,t)=>{if(t.type.includes("set_")&&"payload"in t){const a=t.type.split("set_")[1];return{...e,[a]:t.payload}}return e},p=a(53),m=a.n(p),j=a(635),h=a(22);const v={ascend:"ASC",descend:"DESC"},g=e=>e?m()(e):null;var O=a(405),f=a(610),y=a(27),k=a(582),w=a(1814),x=a(148);var C=e=>{const{total_count:t,records:a,results:r,select_all_query:o,validateRow:c=(e=>!0),rowSelector:i=(e=>e.map((e=>e.id)))}=e,[d,b]=Object(s.useState)([]),[u,_]=Object(s.useState)(!1),[p,m]=Object(s.useState)(!1),[j,v]=Object(s.useState)(!1),g=Object(x.a)(),O=Object(s.useCallback)((()=>{_(!1),b([]),v(!1)}),[]),f=Object(s.useCallback)((()=>{const e=n.b.loading(`${Object(l.b)("verbs.selecting")}...`,0);m(!0);const{query:t,variables:a,resolve:s}=o;g.query({query:t,variables:a,fetchPolicy:"network-only"}).then(s((e=>{_(!0),b(i(e))}))).catch((e=>console.error(e))).then((()=>{e(),m(!1)}))}),[g,i,o]),y=Object(s.useCallback)(((e,t)=>{b(i(t))}),[]),k=Object(s.useMemo)((()=>a.filter(c)),[a,c]);return Object(s.useMemo)((()=>({setSelectedRows:b,selected_all:u,selected_rows:d,validated_records:k,total_count:t,resetSelected:O,records:a,results:r,selectAll:f,onChange:y,is_select_mode:j,setIsSelectMode:v,is_selecting_all:p,setSelectedAll:_,setIsSelectingAll:m,getCheckboxProps:e=>({disabled:!c(e)}),selectedRowKeys:d.map((e=>(null===e||void 0===e?void 0:e.id)||e)),columnTitle:Object(h.jsx)(w.a,{className:"table-select-all",indeterminate:!u&&!!d.length&&d.length!==t,checked:u||d.length===t&&t>0,onChange:()=>{if(d.length<k.length)return b(i(k));O()}})})),[u,d,t,O,a,r,f,y,c,k,j,v,p])},$=a(597),S=a(232);const T=Object(s.lazy)((()=>Object(S.a)((()=>a.e(12).then(a.bind(null,968)))))),I=Object(s.lazy)((()=>Object(S.a)((()=>a.e(7).then(a.bind(null,969)))))),q=()=>{const e=Object(b.b)((e=>e.onSearch)),t=Object(b.b)((e=>e.title));return Object(h.jsx)($.b,{title:t,onSearch:e,children:Object(h.jsx)(k.a,{Desktop:T,Mobile:I})})};q.displayName="DefaultHeader";var R=q,M=a(76);const P=Object(s.lazy)((()=>Object(S.a)((()=>a.e(94).then(a.bind(null,2909)))))),D=Object(s.lazy)((()=>Object(S.a)((()=>a.e(67).then(a.bind(null,3082)))))),N=e=>!(null===e||void 0===e||!e.active),L=e=>null===e||void 0===e?void 0:e.id,z=(e,t)=>{var a,p;const{columns:m,filters:w,extra_actions:x,query:$,getTotalCount:S,getData:T,select_all_query:I,validateRow:q=N,rowSelectorKey:z=L,Header:A,expandedRowKeys:E,title:F,storage_key:K=F,has_feature:Y=!0,use_storage:H=!0,addon_id:B,has_joyride:J=!0,show_create_button:V=!0,item_selectable:W=!0,parseFilters:G=f.d,rowClassName:X,mobileSwipeLeft:Q}=e,U=Object(y.a)((e=>e.current_user.permissions)),Z=Object(y.a)((e=>e.is_mobile)),ee=`MagicTableStorage: ${K}`,[te]=r.a.useForm(),ae=(null===(a=m.find((e=>e.sorter)))||void 0===a?void 0:a.key)||m[0].key,se=(null===(p=m.find((e=>e.defaultSortOrder)))||void 0===p?void 0:p.defaultSortOrder)||m[0].defaultSortOrder||"ascend",le=Object(s.useMemo)((()=>(e=>{const{default_sort_order:t,default_sort_field:a,filters:s,local_storage_key:l,visible_columns:r,use_storage:o}=e,c=Object(d.c)(l);if(c&&o){const e=null===c||void 0===c?void 0:c.filters_value;return null!==e&&void 0!==e&&e.start_date||null!==e&&void 0!==e&&e.end_date||null!==e&&void 0!==e&&e.birthday_start_date||null!==e&&void 0!==e&&e.birthday_end_date||null!==e&&void 0!==e&&e.start_date_open||null!==e&&void 0!==e&&e.start_date_close||null!==e&&void 0!==e&&e.end_date_open||null!==e&&void 0!==e&&e.end_date_close?{...c,filters_value:{...c.filters_value,start_date:g(c.filters_value.start_date),end_date:g(c.filters_value.end_date),birthday_start_date:g(c.filters_value.birthday_start_date),birthday_end_date:g(c.filters_value.birthday_end_date),start_date_open:g(c.filters_value.start_date_open),start_date_close:g(c.filters_value.start_date_close),end_date_open:g(c.filters_value.end_date_open),end_date_close:g(c.filters_value.end_date_close)}}:c}const n=null===s||void 0===s?void 0:s.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{});return{...u,sort_field:a,sort_order:v[t],filters_value:n,visible_columns:r}})({local_storage_key:ee,filters:w,default_sort_field:ae,default_sort_order:se,visible_columns:m.filter((e=>e.default_visible)).map((e=>e.key)),use_storage:H})),[m,ae,se,w,ee,H]),[re,oe]=Object(s.useReducer)(_,le);Object(c.a)((()=>{Object(d.d)(ee,{...re,page:1})}),[re]);const[ce,ne]=Object(s.useState)(""),[ie,de]=Object(s.useState)([]),[be,ue]=Object(s.useState)(0),_e=Object(s.useRef)(!1),pe=(e=>{const{columns:t,visible_columns:a=[],dispatch:s}=e,l=t.filter((e=>a.includes(e.key)||e.always_visible)),r=l.findIndex((e=>"actions"===e.key));return r&&(l[r]={...l[r],title:Object(h.jsx)(j.a,{columns:t,visible_columns:a,dispatch:s})}),l})({dispatch:oe,columns:m,visible_columns:re.visible_columns}),me={...Object(s.useMemo)((()=>m.filter((e=>e.include_key_on_query)).reduce(((e,t)=>{var a;return e[t.key]=null===(a=re.visible_columns)||void 0===a?void 0:a.includes(t.key),e}),{})),[m,re.visible_columns]),...G(re.filters_value),is_mobile:Z,search_query:ce,sort_field:re.sort_field,sort_order:re.sort_order,page:re.page,results:re.results},{loading:je,refetch:he}=Object(O.f)($,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,variables:me,skip:!Y,onError:e=>{console.log(e),M.a.captureException(e),n.b.error(Object(l.b)("phrases.loading_error"))},onCompleted:e=>{ue(S(e)),1!==re.page&&_e.current?de((t=>[...t,...T(e)||[]])):de(T(e)||[])}}),ve=Object(s.useCallback)((()=>{if(1===re.page)return he();oe({type:"set_page",payload:1})}),[re.page,he]),ge=Object(s.useCallback)((()=>{_e.current=!0,oe({type:"set_page",payload:re.page+1})}),[re.page]),Oe=Object(s.useCallback)(((e,t,a)=>{a.order&&(oe({type:"set_sort_field",payload:a.field}),oe({type:"set_sort_order",payload:"ascend"===a.order?"ASC":"DESC"})),e.current&&oe({type:"set_page",payload:e.current}),e.pageSize&&oe({type:"set_results",payload:e.pageSize})}),[]),fe=C({total_count:be,results:re.results,records:ie,select_all_query:{query:I,variables:me,resolve:e=>t=>{let{data:a}=t;return e(T(a)||[])}},validateRow:q,rowSelector:Object(s.useCallback)((e=>e.filter(q).map(z)),[z,q])}),ye=Object(s.useMemo)((()=>E?E(ie):void 0),[ie,E]),ke=Object(s.useCallback)((e=>{he(),fe.resetSelected();const t=Math.ceil((be-e)/re.results);re.page>t&&oe({type:"set_page",payload:t})}),[re.page,he,re.results,fe,be]),we=Object(s.useCallback)((e=>{oe({type:"set_page",payload:1}),ne(e)}),[ne]),xe=Object(s.useCallback)((e=>{oe({type:"set_filters_value",payload:e}),oe({type:"set_page",payload:1})}),[]),Ce=Object(s.useMemo)((()=>Y?e.permissions?e.permissions:e.permissions_key?{can_create:U[`can_create_${e.permissions_key}`],can_edit:U[`can_edit_${e.permissions_key}`],can_access:U[`can_access_${e.permissions_key}`]}:void 0:{can_create:!1,can_edit:!1,can_access:!1}),[Y,e.permissions,e.permissions_key,U]),$e=Object(s.useCallback)((()=>{if(fe.resetSelected(),Z)return 1===re.page?void he():void oe({type:"set_page",payload:1});he()}),[Z,he,fe,re.page]);Object(s.useImperativeHandle)(t,(()=>({afterDestroyRecord:ke,refetch:$e})));const Se=Object(s.useMemo)((()=>({onSearch:we,row_selection:fe,onFiltersChange:xe,data_source:ie,form:te,total_count:be,loading:je,new_columns:pe,onChange:Oe,expanded_row_keys:ye,refetch:ve,handleFetchMore:ge,...e,has_feature:Y,addon_id:B,has_joyride:J,show_create_button:V,item_selectable:W,validateRow:q,rowSelectorKey:z,permissions:Ce,...re,dispatch:oe,rowClassName:X,extra_actions:x})),[we,fe,xe,ie,te,be,je,pe,Oe,ye,ve,ge,e,Y,J,V,q,z,Ce,re,X,x,W,B]),Te=Object(s.useMemo)((()=>null===w||void 0===w?void 0:w.reduce(((e,t)=>t.default_value?t.rangepicker?{...e,[t.rangepicker.start_date_name]:t.default_value[0],[t.rangepicker.end_date_name]:t.default_value[1]}:{...e,[t.name]:t.default_value}:e),{})),[w]);return Object(h.jsx)(b.a.Provider,{value:Se,children:Object(h.jsxs)(i.b,{children:[A?Object(h.jsx)(A,{}):Object(h.jsx)(R,{}),Object(h.jsx)(r.a,{form:te,component:!1,layout:"vertical",onChange:Object(o.debounce)(xe,1e3),initialValues:{...Te,...re.filters_value},children:Object(h.jsx)(k.a,{Desktop:P,Mobile:D,mobileSwipeLeft:Q})})]})})};z.displayName="MagicTable";t.a=Object(s.memo)(Object(s.forwardRef)(z))},635:function(e,t,a){"use strict";var s=a(0),l=a(50),r=a(1809),o=a(852),c=a(1814),n=a(3052),i=a(19),d=a(22);const b=e=>{let{columns:t,visible_columns:a,dispatch:c,setVisibleColumns:i}=e;const[b,_]=Object(s.useState)(!1),p=Object(s.useCallback)((()=>{const e=t.filter((e=>e.default_visible)).map((e=>e.key));null===c||void 0===c||c({type:"set_visible_columns",payload:e}),null===i||void 0===i||i(e)}),[t,c,i]),m=Object(s.useCallback)((e=>{if(a.includes(e)){const t=a.filter((t=>t!==e));return null===c||void 0===c||c({type:"set_visible_columns",payload:t}),void(null===i||void 0===i||i(t))}const t=[...a,e];null===c||void 0===c||c({type:"set_visible_columns",payload:t}),null===i||void 0===i||i(t)}),[c,i,a]),j=Object(s.useMemo)((()=>{const e=t.reduce(((e,t)=>{if(!t.title||t.always_visible)return e;const s={key:t.key,disabled:t.always_visible,label:Object(d.jsx)(u,{onClick:()=>m(t.key),checked:a.includes(t.key),children:t.title})};return[...e,s]}),[]);return[{key:"default_title",type:"group",label:Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("span",{children:Object(l.b)("words.column",{count:2})}),Object(d.jsx)("button",{className:"link",onClick:p,children:Object(l.b)("words.default")})]}),children:e}]}),[t,p,m,a]);return Object(d.jsx)(r.a,{menu:{items:j},trigger:["click"],open:b,onOpenChange:_,className:"no-print table-configuration",children:Object(d.jsx)(o.a,{title:Object(l.b)("phrases.column_settings"),placement:"left",children:Object(d.jsx)("div",{className:"link no-print",style:{fontSize:"15px"},children:Object(d.jsx)(n.a,{})})})})};b.displayName="ColumnsSettings",t.a=b;const u=Object(i.d)(c.a).withConfig({componentId:"wb__sc-1oenz8-0"})(["width:100%;"])},667:function(e,t,a){"use strict";var s=a(0),l=a(50),r=a(116);t.a=(e,t,a)=>Object(s.useCallback)((s=>{e?r.c.confirm({centered:!0,className:"webook-modal",title:Object(l.b)("words.attention"),maskClosable:!0,content:t(s),okText:Object(l.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(l.b)("verbs.cancel"),onOk:()=>{a(s)}}):r.b.warning(Object(l.b)("phrases.no_permission_to_do_this"))}),[a,e,t])}}]);
//# sourceMappingURL=100.a553554e.chunk.js.map