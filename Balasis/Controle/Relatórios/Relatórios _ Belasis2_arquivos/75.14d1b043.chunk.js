(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[75],{1004:function(e,t,a){"use strict";var c=a(13),n=a(0),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 256c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm192 200v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8zm-48 396H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm104.1-115.6c1.8-34.5 16.2-66.8 40.8-91.4 26.2-26.2 62-41 99.1-41 37.4 0 72.6 14.6 99.1 41 3.2 3.2 6.3 6.6 9.2 10.1L769.2 673a8 8 0 003 14.1l93.3 22.5c5 1.2 9.8-2.6 9.9-7.7l.6-95.4a8 8 0 00-12.9-6.4l-20.3 15.8C805.4 569.6 748.1 540 684 540c-109.9 0-199.6 86.9-204 195.7-.2 4.5 3.5 8.3 8 8.3h48.1c4.3 0 7.8-3.3 8-7.6zM880 744h-48.1c-4.3 0-7.8 3.3-8 7.6-1.8 34.5-16.2 66.8-40.8 91.4-26.2 26.2-62 41-99.1 41-37.4 0-72.6-14.6-99.1-41-3.2-3.2-6.3-6.6-9.2-10.1l23.1-17.9a8 8 0 00-3-14.1l-93.3-22.5c-5-1.2-9.8 2.6-9.9 7.7l-.6 95.4a8 8 0 0012.9 6.4l20.3-15.8C562.6 918.4 619.9 948 684 948c109.9 0 199.6-86.9 204-195.7.2-4.5-3.5-8.3-8-8.3z"}}]},name:"file-sync",theme:"outlined"},i=a(71),l=function(e,t){return n.createElement(i.a,Object(c.a)({},e,{ref:t,icon:s}))},r=n.forwardRef(l);t.a=r},1040:function(e,t,a){"use strict";var c=a(0),n=a(37),s=a(405);const i=n.e`
  query FetchDocumentTemplates ($class_type: String) {
    document_templates (class_type: $class_type, page: 1, per_page: 10) {
      all {
        id name
      }
    }
  }
`;t.a=e=>{const{data:t}=Object(s.f)(i,{variables:{class_type:e}});return Object(c.useMemo)((()=>(null===t||void 0===t?void 0:t.document_templates.all)||[]),[null===t||void 0===t?void 0:t.document_templates.all])}},1102:function(e,t,a){"use strict";var c=a(13),n=a(0),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"},i=a(71),l=function(e,t){return n.createElement(i.a,Object(c.a)({},e,{ref:t,icon:s}))},r=n.forwardRef(l);t.a=r},1301:function(e,t,a){"use strict";a(0);var c=a(547),n=a(19),s=a(22);const i=e=>{let{label:t,id:a,status:c,disabled:n}=e;const i=n?"#808080":"",r=a?(e=>({issued:"#4eb660",canceled:"#faa84f",pending:"#1194f6",denied:"#e44e4d",cancel_denied:"#e44e4d"}[e]||"#1194f6"))(c):i;return Object(s.jsx)(l,{color:r,children:t})};i.displayName="InvoiceTag",t.a=i;const l=Object(n.d)(c.a).withConfig({componentId:"wb__sc-1jitx2m-0"})(["width:60px;text-align:center;"])},2950:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a(50),s=a(116),i=a(2854),l=a(1438),r=a(608),o=a(250),d=a(19),b=a(22);const u=e=>Object(n.b)("phrases.confirm_delete",{model:Object(n.b)("words.package",{count:e.length}).toLocaleLowerCase(),count:e.length}),_=d.d.div.withConfig({componentId:"wb__sc-1k9herd-0"})(["display:flex;width:100%;flex-direction:column;align-items:center;background-color:#fbfbfb;border-radius:5px;box-shadow:0 2px 9px rgba(83,83,83,0.06);overflow:hidden;margin-bottom:15px;padding:10px;border:1px solid transparent;user-select:none;transition:transform .2s;"]);var j=a(37);const p=j.e`
  query PackagesList (
    $page: Int,
    $results: Int,
    $search_query: String,
    $sort_field: String,
    $sort_order: String,
    $deleted: Boolean,
    $start_date: String,
    $end_date: String,
    $status: String,
    $payment_status: [ID],
    $bill_recs: Boolean!,
    $client: Boolean!
  ) {
    inventory_packages (
      page: $page,
      results: $results,
      search_term: $search_query,
      sort_field: $sort_field,
      sort_order: $sort_order,
      deleted: $deleted,
      start_date: $start_date,
      end_date: $end_date,
      status: $status,
      payment_status: $payment_status,
    ) {
      all {
        id
        code
        date
        expiration_date
        deleted_at
        client @include(if: $client) {
          id name
        }
        sum_cents
        finished
        available
        bill_recs @include(if: $bill_recs) {
          id status
        }
        comment

        package_items {
          id
          product {
            id
            service
          }
        }

        electronic_invoice {
          id status_reason status document_id xml_file_link pdf_file_link
        }

        electronic_consumer_invoice {
          id status_reason status document_id xml_file_link pdf_file_link
        }

        invoice {
          id status pdf_link xml_link status_reason
        }
      }
      total_count
    }
  }
`,v=j.e`
  query PackageIdsList ($deleted: Boolean) {
    inventory_packages (deleted: $deleted) {
      all {
        id active
      }
    },
  }
`;var h=a(647),m=a(627),O=a(596),g=a(853),f=a(667),y=a(27),k=a(1850);const x=j.e`
  mutation DestroyAllInventoryPackages($data: DestroyAllInventoryPackagesInput!) {
    destroyAllInventoryPackages(input: $data) {
      success
      failures { id code errors }
      errors
    }
  }
`;var w=()=>{const[e]=Object(k.a)(x);return[Object(c.useCallback)((async t=>{const a=s.b.loading(`${Object(n.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:t}}),{success:n=!1,failures:i=[],errors:l=[]}=(null===c||void 0===c?void 0:c.destroyAllInventoryPackages)||{};return null===l||void 0===l||l.map((e=>s.b.error(e))),{success:n,failures:i||[]}}catch(c){return s.b.error(Object(n.b)("phrases.generic_save_error_message")),console.error(c),{success:!1,failures:[]}}finally{a()}}),[e])]},$=a(547),C=a(579),I=a(616),D=a(1421),P=a(1422),M=a(1040),z=a(1453),S=a(1809),L=a(1825),T=a(1440),N=a(3034),E=a(1088),R=a(691);const F=e=>{const{inventory_package:t,document_templates:a,destroyPackage:l,openPackageDrawer:r,openGenerateDocumentModal:d}=e,u=Object(y.a)((e=>e.current_user.permissions)),_=Object(y.a)((e=>e.current_user.addons.has_document_template)),j=Object(c.useCallback)((e=>{null!==u&&void 0!==u&&u.can_destroy_package?s.c.confirm({centered:!0,className:"webook-modal",title:Object(n.b)("words.attention"),maskClosable:!0,content:Object(n.b)("phrases.confirm_delete",{model:Object(n.b)("words.package").toLocaleLowerCase()}),okText:Object(n.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(n.b)("verbs.cancel"),onOk:()=>l(e)}):s.b.warning(Object(n.b)("phrases.no_permission_to_do_this"))}),[l,null===u||void 0===u?void 0:u.can_destroy_package]),p=Object(c.useMemo)((()=>0===a.length?[{key:"empty-document",label:"Nenhum gerador encontrado",disabled:!0}]:a.map((e=>({key:e.id,label:`${Object(n.b)("verbs.generate")} ${e.name}`,icon:Object(b.jsx)(L.a,{}),onClick:()=>d({document_template_id:e.id,inventory_package_id:t.id})})))),[a,d,t.id]),v=Object(c.useMemo)((()=>{const e=[{key:"see-package",label:t.finished?Object(n.b)("verbs.view"):Object(n.b)("verbs.edit"),icon:t.finished?Object(b.jsx)(T.a,{}):Object(b.jsx)(N.a,{}),onClick:()=>{null!==u&&void 0!==u&&u.can_edit_package?r(t.id):s.b.warning(Object(n.b)("phrases.no_permission_to_do_this"))}},{key:"print",label:Object(n.b)("verbs.print"),icon:Object(b.jsx)(L.a,{}),onClick:()=>{window.open(`/reports/package/${t.id}`,"_blank","noopener, noreferrer")}}];return _&&e.push({key:"document_templates",icon:Object(b.jsx)(E.a,{}),label:Object(n.b)("document_templates.generate_document"),className:"hidden-right-arrow",children:p}),e.push({key:"destroy",onClick:()=>j(t.id),label:Object(n.b)("verbs.delete"),danger:!0,icon:Object(b.jsx)(i.a,{})}),e}),[p,j,_,t.finished,t.id,r,null===u||void 0===u?void 0:u.can_edit_package]);return Object(b.jsx)(o.g,{justify:"center",children:Object(b.jsx)(S.a,{menu:{items:v},trigger:["click"],children:Object(b.jsx)(o.i,{className:"link",children:Object(b.jsx)(R.a,{})})})})};F.displayName="ActionsColumn";var H=F,q=a(1828),A=a(664),B=a(1442);const V=e=>{let{bill_recs:t,inventory_package:a,style:s}=e;const i=Object(c.useMemo)((()=>null!==t&&void 0!==t&&t.some((e=>"0"===e.status))||!a.finished?{color:"orange",name:Object(n.b)("words.open")}:null!==t&&void 0!==t&&t.some((e=>"2"===e.status))?{color:"red",name:Object(n.b)("words.overdue"),icon:Object(b.jsx)(q.a,{})}:null!==t&&void 0!==t&&t.some((e=>"4"===e.status))?{color:"blue",name:Object(n.b)("words.available")}:null!==t&&void 0!==t&&t.some((e=>"5"===e.status))?{color:"#777777",name:Object(n.b)("words.blocked"),icon:Object(b.jsx)(A.a,{})}:{color:"green",name:Object(n.b)("words.paid"),icon:Object(b.jsx)(B.a,{})}),[t,a.finished]);return Object(b.jsxs)($.a,{style:s,color:i.color,children:[i.icon," ",i.name]})};V.displayName="PaymentTag";var G=Object(c.memo)(V),W=a(53),J=a.n(W);var U=e=>{let{openPackageDrawer:t,handleDestroyPackage:a,refetch:i,openClientDrawer:l,openGenerateDocumentModal:r}=e;const d=Object(y.a)((e=>e.current_user.permissions)),u=Object(y.a)((e=>e.is_webook)),_=Object(y.a)((e=>{var t;return null===(t=e.current_user.salon.enotas_token)||void 0===t?void 0:t.token})),j=Object(y.a)((e=>e.current_user.addons.has_nfs))&&!!_,p=Object(y.a)((e=>e.current_user.addons.has_nfe))&&!!_,v=Object(y.a)((e=>e.current_user.addons.has_nfce))&&!!_,h=Object(M.a)("Inventory::Package");return Object(c.useMemo)((()=>{let e=[{title:Object(n.b)("words.ticket"),key:"code",dataIndex:"code",align:"center",className:"table-sort",sorter:!0,default_visible:!0,always_visible:!0,width:80,render:(e,a)=>Object(b.jsxs)(o.i,{style:{maxWidth:"100%"},title:e,className:"link",onClick:()=>{a.deleted_at||(d.can_edit_package?t(a.id):s.b.warning(Object(n.b)("phrases.no_permission_to_do_this")))},children:["#",e]})},{title:Object(n.b)("words.date"),key:"date",dataIndex:"date",sorter:!0,defaultSortOrder:"descend",default_visible:!0,width:110,render:e=>J()(e).format("L")},{title:Object(n.b)("words.validity"),key:"expiration_date",dataIndex:"expiration_date",sorter:!0,defaultSortOrder:"descend",default_visible:!0,width:110,render:e=>e?J()(e).format("L"):""},{title:Object(n.b)("words.client"),key:"client",dataIndex:"client",include_key_on_query:!0,default_visible:!0,render:e=>Object(b.jsx)(o.i,{style:{maxWidth:"100%"},title:null===e||void 0===e?void 0:e.name,onClick:()=>l(null===e||void 0===e?void 0:e.id),children:null===e||void 0===e?void 0:e.name})},{title:Object(n.b)("words.status"),key:"finished",dataIndex:"finished",default_visible:!0,width:90,render:e=>e?Object(b.jsx)($.a,{color:"#777777",children:Object(n.b)("words.finished")}):Object(b.jsx)($.a,{color:"orange",children:Object(n.b)("words.pending")})},{title:Object(n.b)("words.availability"),key:"available",dataIndex:"available",default_visible:!0,width:130,render:(e,t)=>t.finished?e?Object(b.jsx)($.a,{color:"green",children:Object(n.b)("words.active")}):Object(b.jsx)($.a,{color:"red",children:Object(n.b)("words.expired")}):Object(b.jsx)($.a,{color:"orange",children:Object(n.b)("words.pending")})},{title:Object(n.b)("words.value"),key:"sum_cents",dataIndex:"sum_cents",default_visible:!0,width:120,align:"right",render:e=>Object(C.d)(e)},{title:Object(n.b)("words.payment"),key:"bill_recs",dataIndex:"bill_recs",include_key_on_query:!0,default_visible:!1,width:110,render:(e,t)=>Object(b.jsx)(G,{style:{margin:0},bill_recs:e,inventory_package:t})},{title:Object(n.b)("words.observation"),key:"comment",dataIndex:"comment",default_visible:!1,ellipsis:!0}];return u||e.push({title:Object(n.b)("words.invoice"),key:"invoices",dataIndex:"invoices",default_visible:!0,ellipsis:!0,align:"center",width:100,render:(e,t)=>{if(!t)return null;const a=t.package_items.some((e=>e.product.service)),c=t.package_items.some((e=>!e.product.service));return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(z.a,{has_service:a,can_issue:j,sale_finished:t.finished,invoice:t.invoice,sale_id:t.id,type:"Inventory::Package",refetch:i}),Object(b.jsx)("span",{style:{paddingLeft:10},children:Object(b.jsx)(P.a,{has_product:c,can_issue:p,sale_finished:t.finished,electronic_invoice:t.electronic_invoice,type:"Inventory::Package",sale_id:t.id,refetch:i})}),Object(b.jsx)("span",{style:{paddingLeft:10},children:Object(b.jsx)(D.a,{has_product:c,can_issue:v,sale_finished:t.finished,electronic_consumer_invoice:t.electronic_consumer_invoice,sale_id:t.id,type:"Inventory::Package",refetch:i})})]})}}),e.push({default_visible:!0,key:"actions",width:70,align:"center",render:(e,c)=>!!c.deleted_at?null:Object(b.jsx)(I.a,{width:54,children:Object(b.jsx)(H,{destroyPackage:a,inventory_package:c,openPackageDrawer:t,document_templates:h,openGenerateDocumentModal:r})})}),e}),[a,h,v,p,j,u,l,t,d.can_edit_package,i,r])};const X=[{value:"finished",label:Object(b.jsx)($.a,{color:"#777777",children:Object(n.b)("words.finished")})},{value:"pending",label:Object(b.jsx)($.a,{color:"orange",children:Object(n.b)("words.pending")})}],Y=[{value:"5",label:Object(b.jsx)($.a,{style:{margin:"2px 0"},color:"#777777",children:Object(n.b)("words.blocked")})},{value:"4",label:Object(b.jsx)($.a,{style:{margin:"2px 0"},color:"blue",children:Object(n.b)("words.available")})},{value:"0",label:Object(b.jsx)($.a,{style:{margin:"2px 0"},color:"orange",children:Object(n.b)("words.open")})},{value:"2",label:Object(b.jsx)($.a,{style:{margin:"2px 0"},color:"red",children:Object(n.b)("words.late")})},{value:"3",label:Object(b.jsx)($.a,{style:{margin:"2px 0"},color:"green",children:Object(n.b)("words.paid")})}];var K=()=>Object(c.useMemo)((()=>[{label:Object(n.b)("words.status"),name:"deleted",default_value:"false",double_checkbox:{true:Object(n.b)("words.deleted",{count:2}),false:Object(n.b)("words.not_deleted",{count:2})}},{label:Object(n.b)("words.period"),name:"dates",rangepicker:{start_date_name:"start_date",end_date_name:"end_date"}},{label:Object(n.b)("words.payment_status"),name:"status",radio_options:X,checkbox_disabled:!0},{label:Object(n.b)("words.payment"),help:Object(n.b)("package.filters.payment_help"),name:"payment_status",checkbox_options:Y,checkbox_disabled:!0}]),[]),Q=a(583),Z=a(604),ee=a(543),te=a(1301);const ae=e=>{var t,a,c,s,i,l;let{inventory_package:r}=e;const o=Object(y.a)((e=>{var t;return null===(t=e.current_user.salon.enotas_token)||void 0===t?void 0:t.token})),d=Object(y.a)((e=>e.current_user.addons.has_nfs))&&!!o,u=Object(y.a)((e=>e.current_user.addons.has_nfe))&&!!o,_=Object(y.a)((e=>e.current_user.addons.has_nfce))&&!!o,j=r.finished,p=r.package_items.some((e=>e.product.service)),v=r.package_items.some((e=>!e.product.service));return o?Object(b.jsxs)(ee.a,{style:{paddingTop:5},children:[d&&Object(b.jsx)(te.a,{label:Object(n.b)("acronyms.ESI"),id:null===(t=r.invoice)||void 0===t?void 0:t.id,status:null===(a=r.invoice)||void 0===a?void 0:a.status,disabled:!p||!j}),u&&Object(b.jsx)(te.a,{label:Object(n.b)("acronyms.EI"),id:null===(c=r.electronic_invoice)||void 0===c?void 0:c.id,status:null===(s=r.electronic_invoice)||void 0===s?void 0:s.status,disabled:!v||!j}),_&&Object(b.jsx)(te.a,{label:Object(n.b)("acronyms.ECI"),id:null===(i=r.electronic_consumer_invoice)||void 0===i?void 0:i.id,status:null===(l=r.electronic_consumer_invoice)||void 0===l?void 0:l.status,disabled:!v||!j})]}):null};ae.displayName="InvoicesMobile";var ce=ae;const ne=e=>{var t;const{item:a}=e;return Object(b.jsxs)(o.g,{$column:!0,children:[Object(b.jsxs)(o.g,{justify:"space-between",children:[Object(b.jsxs)(Q.b,{width:22,$block:!0,$textEllipsis:!0,$isFlex:!0,children:[Object(b.jsxs)(o.h,{$color:"primary",$bold:!0,children:["#",null===a||void 0===a?void 0:a.code]}),"\xa0",null===a||void 0===a||null===(t=a.client)||void 0===t?void 0:t.name]}),Object(b.jsx)(Q.b,{width:6,$align:"right",$block:!0,$semibold:!0,style:{whiteSpace:"nowrap"},children:Object(C.d)(null===a||void 0===a?void 0:a.sum_cents)})]}),Object(b.jsxs)(o.g,{$top:5,justify:"space-between",children:[Object(b.jsxs)(Q.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[Object(n.b)("words.date"),": ",J()(null===a||void 0===a?void 0:a.date).format("L")]}),le(a)]}),Object(b.jsxs)(o.g,{$top:5,justify:"space-between",children:[null!==a&&void 0!==a&&a.expiration_date?Object(b.jsxs)(Q.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[Object(n.b)("words.expires_in"),": ",J()(null===a||void 0===a?void 0:a.expiration_date).format("L")]}):Object(b.jsx)(Q.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:Object(n.b)("words.not_expire")}),re(a)]}),a&&Object(b.jsx)(o.g,{children:Object(b.jsx)(ce,{inventory_package:a})})]})};ne.displayName="PackageItemMobile";var se=Object(c.memo)(ne);const ie=Object(d.d)($.a).withConfig({componentId:"wb__sc-1pb78m-0"})(["margin-right:0 !important;width:75px;text-align:center;"]),le=e=>e?e.finished?Object(b.jsx)(ie,{color:"#777777",children:Object(n.b)("words.finished")}):Object(b.jsx)(ie,{color:"orange",children:Object(n.b)("words.pending")}):Object(b.jsx)(Z.a,{width:"8ch"});le.displayName="getStatus";const re=e=>e?e.finished?e.available?Object(b.jsx)(ie,{color:"green",children:Object(n.b)("words.active")}):Object(b.jsx)(ie,{color:"red",children:Object(n.b)("words.expired")}):Object(b.jsx)(ie,{color:"orange",children:Object(n.b)("words.pending")}):Object(b.jsx)(Z.a,{width:"8ch"});re.displayName="getAvailability";var oe=a(593);const de=j.e`
  mutation DestroyPackage($data: DestroyPackageInput!) {
    destroyPackage(input: $data) {
      success errors
    }
  }
`;var be=()=>{const[e,{loading:t}]=Object(k.a)(de),a=Object(c.useCallback)((async t=>{const a=s.b.loading(`${Object(n.b)("verbs.wait")}...`,0);try{const{data:c}=await e({variables:{data:{id:t}}}),{success:n=!1,errors:i=[]}=(null===c||void 0===c?void 0:c.destroyPackage)||{};return null===i||void 0===i||i.map((e=>s.b.error(e))),{success:n}}catch(c){return s.b.error(Object(n.b)("phrases.generic_save_error_message")),console.error(c),{success:!1}}finally{a()}}),[e]);return[a,t]};const ue={true:!0,false:!1,all:null,none:null};t.default=()=>{const e=Object(c.useRef)(null),t=Object(c.useRef)(null),a=Object(c.useRef)(null),d=Object(c.useRef)(null),j=Object(y.a)((e=>e.current_user.permissions)),k=Object(y.a)((e=>e.current_user.features.has_packages)),[x]=be(),[$]=w(),C=Object(c.useCallback)((async t=>{const{success:a,failures:c=[]}=await $({ids:t});(a||0!==c.length)&&(e=>{let{ids:t,failures:a,magicTableRef:c}=e;const i=a.length===t.length,d=0===a.length,u=t.length-a.length;var j;if(d)return s.b.success(`${u} ${Object(n.b)("phrases.deleted_successfully",{prefix:Object(n.b)("words.package",{count:u}).toLocaleLowerCase(),count:u})}`),void(null===(j=c.current)||void 0===j||j.afterDestroyRecord(u));r.a.information({closable:!0,className:"webook-modal hide-buttons",maskClosable:!0,onCancel:()=>{var e;i||null===(e=c.current)||void 0===e||e.afterDestroyRecord(u)},title:Object(n.b)("phrases.mass_delete_completed"),content:Object(b.jsxs)("div",{style:{maxHeight:400,width:"100%",maxWidth:480,overflowX:"hidden",overflowY:"auto"},children:[!i&&Object(b.jsxs)(o.h,{$size:16,$alignCenter:!0,$color:"green_2",children:[u,"\xa0",Object(n.b)("phrases.deleted_successfully",{prefix:Object(n.b)("words.package",{count:u}).toLocaleLowerCase(),count:u})]}),a.length>0&&Object(b.jsxs)(o.g,{$column:!0,$paddings:[0,10],children:[Object(b.jsx)(l.a,{dashed:!0}),Object(b.jsx)(o.h,{$size:16,$alignCenter:!0,$paddings:{bottom:10},children:Object(n.b)("phrases.failure_destroy_message",{model:Object(n.b)("words.package",{count:a.length}).toLocaleLowerCase(),count:a.length})}),a.map((e=>{let{id:t,code:a,errors:c=[]}=e;return Object(b.jsxs)(_,{children:[Object(b.jsx)(o.g,{$column:!0,style:{overflow:"hidden"},children:Object(b.jsxs)(o.h,{$size:16,$textEllipsis:!0,$block:!0,children:[Object(n.b)("words.code"),"\xa0#",a]})}),Object(b.jsx)(o.g,{$column:!0,style:{overflow:"hidden"},$mTop:10,children:c.map((e=>Object(b.jsx)(o.h,{style:{color:"#FF7875"},children:e},`${e}_${t}`)))})]},`package_item_${t}`)}))]})]})})})({ids:t,failures:c,magicTableRef:e})}),[$]),I=Object(c.useCallback)((async t=>{var a;const{success:c}=await x(t);c&&(s.b.success(Object(n.b)("phrases.deleted_successfully",{prefix:Object(n.b)("words.package")})),null===(a=e.current)||void 0===a||a.refetch())}),[x]),D=Object(c.useCallback)((e=>!e.deleted_at),[]),P=Object(c.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.refetch()}),[]),M=Object(f.a)(j.can_destroy_package,u,C),z=Object(c.useCallback)((e=>{var t;j.can_edit_client?null===(t=a.current)||void 0===t||t.open({id:e}):s.b.warning(Object(n.b)("phrases.no_permission_to_do_this"))}),[j.can_edit_client]),S=Object(c.useCallback)((e=>{var a;null===(a=t.current)||void 0===a||a.open(e)}),[]),L=Object(c.useCallback)((e=>{var t;null===(t=d.current)||void 0===t||t.open(e)}),[]),T=Object(c.useMemo)((()=>({openPackageDrawer:S,handleDestroyPackage:I,refetch:P,openClientDrawer:z,openGenerateDocumentModal:L})),[P,I,z,L,S]),N=U(T),E=K(),R=Object(c.useMemo)((()=>[{label:Object(n.b)("verbs.delete"),icon:Object(b.jsx)(i.a,{}),danger:!0,onClick:M,disabled:!j.can_destroy_package}]),[M,j.can_destroy_package]),F=Object(c.useCallback)((e=>{null!==e&&void 0!==e&&e.deleted_at||S(null===e||void 0===e?void 0:e.id)}),[S]),H=Object(c.useCallback)((e=>{const t={},a={},c="pending"===e.status;return Object.entries(e).forEach((e=>{let[n,s]=e;const i="payment_status"===n&&c;a[n]=i?[]:s,s in ue&&(t[n]=ue[s])})),{...a,...t}}),[]),q=Object(c.useCallback)((e=>{var t;return(null===e||void 0===e||null===(t=e.inventory_packages)||void 0===t?void 0:t.total_count)||0}),[]),A=Object(c.useCallback)((e=>{var t;return null===e||void 0===e||null===(t=e.inventory_packages)||void 0===t?void 0:t.all}),[]);return Object(oe.a)({feature_keys:["has_packages"]}),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(m.a,{ref:e,title:Object(n.b)("words.package",{count:2}),permissions_key:"package",search_placeholder:Object(n.b)("package.search_placeholder"),filters:E,columns:N,has_feature:k,mass_actions:R,query:p,select_all_query:v,getData:A,getTotalCount:q,openDrawer:F,MobileItem:se,validateRow:D,parseFilters:H}),Object(b.jsx)(h.a,{ref:t,afterSave:P}),Object(b.jsx)(O.a,{ref:a,onSave:P}),Object(b.jsx)(g.a,{ref:d})]})}},664:function(e,t,a){"use strict";var c=a(13),n=a(0),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},i=a(71),l=function(e,t){return n.createElement(i.a,Object(c.a)({},e,{ref:t,icon:s}))},r=n.forwardRef(l);t.a=r},667:function(e,t,a){"use strict";var c=a(0),n=a(50),s=a(116);t.a=(e,t,a)=>Object(c.useCallback)((c=>{e?s.c.confirm({centered:!0,className:"webook-modal",title:Object(n.b)("words.attention"),maskClosable:!0,content:t(c),okText:Object(n.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(n.b)("verbs.cancel"),onOk:()=>{a(c)}}):s.b.warning(Object(n.b)("phrases.no_permission_to_do_this"))}),[a,e,t])},691:function(e,t,a){"use strict";var c=a(13),n=a(0),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]},name:"menu",theme:"outlined"},i=a(71),l=function(e,t){return n.createElement(i.a,Object(c.a)({},e,{ref:t,icon:s}))},r=n.forwardRef(l);t.a=r},853:function(e,t,a){"use strict";var c=a(0),n=a(50),s=a(2937),i=a(116),l=a(20),r=a(250),o=a(18),d=a(582),b=a(27),u=a(37),_=a(2879);const j=u.e`
  query fetchDocumentTemplate (
    $id: ID, $client_id: ID, $employee_id: ID, $schedule_group_id: ID, $inventory_sale_id: ID,
    $inventory_package_id: ID, $finance_bill_rec_id: ID, $finance_bill_pay_id: ID, $inventory_purchase_id: ID
  ) {
    document_template (id: $id) {
      id name save_on_generation exchange_variables(
        client_id: $client_id, employee_id: $employee_id, schedule_group_id: $schedule_group_id,
        inventory_sale_id: $inventory_sale_id, inventory_package_id: $inventory_package_id,
        finance_bill_rec_id: $finance_bill_rec_id, finance_bill_pay_id: $finance_bill_pay_id,
        inventory_purchase_id: $inventory_purchase_id
      )
    }
  }
`;var p=()=>Object(_.a)(j,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),v=a(232),h=a(19),m=a(82),O=a(22);const g=Object(c.lazy)((()=>Object(v.a)((()=>Promise.all([a.e(13),a.e(157)]).then(a.bind(null,3084)))))),f=Object(c.lazy)((()=>Object(v.a)((()=>Promise.all([a.e(13),a.e(158)]).then(a.bind(null,3085)))))),y=(e,t)=>{const[a,r]=Object(c.useState)(!1),[u,_]=Object(c.useState)(),[j,v]=Object(c.useState)(),[h,y]=Object(c.useState)(),[x,w]=Object(c.useState)(!0),$=Object(l.o)(),C=Object(b.a)((e=>e.current_user.id)),I=Object(b.a)((e=>e.current_user.authentication_token)),D=Object(b.a)((e=>e.current_user.addons.has_upload_image)),P=Object(c.useRef)(null),[M]=s.a.useForm(),{setFieldsValue:z,getFieldsValue:S,resetFields:L}=M,[T,{data:N,loading:E,called:R}]=p();Object(c.useEffect)((()=>{var e;R&&!E&&null!==N&&void 0!==N&&N.document_template&&(z({exchange_variables:null===N||void 0===N?void 0:N.document_template.exchange_variables}),w(null!==(e=N.document_template.save_on_generation)&&void 0!==e&&e))}),[null===N||void 0===N?void 0:N.document_template,E,R]);const F=Object(c.useCallback)((e=>{let{document_template_id:t,...a}=e;T({variables:{id:t,...a}}),r(!0),_(t),y(a.client_id);const c=a.schedule_group_id||a.inventory_sale_id||a.inventory_package_id||a.finance_bill_rec_id;v(c)}),[T]),H=Object(c.useCallback)((()=>{r(!1)}),[]);Object(c.useImperativeHandle)(t,(()=>({close:H,open:F})));const q=Object(c.useCallback)((()=>{$(`/subscription/addons?addon_id=${o.a.ID_UPLOAD_IMAGE}`)}),[$]),A=Object(c.useCallback)((e=>{const t=document.getElementById("generate-pdf-form");if(!t)return;const a=S();t.save_on_generation.value=e,t.exchange_variables.value=a.exchange_variables,t.submit()}),[S]),B=Object(c.useCallback)((()=>{D||!x?A(x):i.c.confirm({content:Object(n.b)("document_templates.upload_activation"),okText:Object(n.b)("verbs.contract"),okType:"primary",cancelText:Object(n.b)("verbs.cancel"),zIndex:1042,onOk:q,onCancel:()=>{w(!1),A(!1)}})}),[q,D,x,A]),V=Object(c.useCallback)((e=>{e||(L(),_(void 0),y(void 0),v(void 0),w(!0))}),[L]);return Object(O.jsxs)(k,{open:a,width:1650,height:"100%",onClose:H,destroyOnClose:!0,afterOpenChange:V,children:[Object(O.jsx)(s.a,{form:M,layout:"vertical",style:{height:"100%"},children:Object(O.jsx)(d.a,{Mobile:f,Desktop:g,title:null===N||void 0===N?void 0:N.document_template.name,loading:E,save_on_generation:x,setSaveOnGeneration:w,close:H,generatePDF:B,editorRef:P})}),Object(O.jsxs)("form",{id:"generate-pdf-form",action:`${m.a.API}/document_templates/generate_document`,method:"post",target:"_blank",children:[Object(O.jsx)("input",{type:"hidden",name:"document_template_id",value:u,readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"client_id",value:h,readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"class_id",value:j,readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"current_user_id",value:C,readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"authentication_token",value:I,readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"exchange_variables",readOnly:!0}),Object(O.jsx)("input",{type:"hidden",name:"save_on_generation",readOnly:!0})]})]})};y.displayName="GenerateDocumentDrawer";t.a=Object(c.memo)(Object(c.forwardRef)(y));const k=Object(h.d)(r.a).withConfig({componentId:"wb__sc-wueh2s-0"})([".ant-drawer-body{padding-left:0;padding-right:0;background:",";.tox-statusbar__branding{display:none;}}"],(e=>e.theme.is_mobile?"#f8f8f8":"transparent"))}}]);
//# sourceMappingURL=75.14d1b043.chunk.js.map