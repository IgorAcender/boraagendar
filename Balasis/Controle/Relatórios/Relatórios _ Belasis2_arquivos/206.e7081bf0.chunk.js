(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[206],{2931:function(e,t,s){"use strict";s.r(t);var o=s(0),c=s(50),n=s(1813),i=s(837),a=s(585),r=s(2921),d=s(250),l=s(613),b=s(659),j=s(1818),m=s(579),p=s(19),_=s(22);const u=e=>{let{sale_composes:t,commission_percentage:s,fee_config:n}=e;const i=Object(o.useMemo)((()=>"cost"===(null===n||void 0===n?void 0:n.product_consumed_price_by)?"inventory_product_cost_price_cents":"price"===(null===n||void 0===n?void 0:n.product_consumed_price_by)?"inventory_product_sale_price_cents":"pro"===(null===n||void 0===n?void 0:n.product_consumed_price_by)?"inventory_product_employee_price_cents":void 0),[null===n||void 0===n?void 0:n.product_consumed_price_by]),a=null!==n&&void 0!==n&&n.discount_consumed_products_on?s:1,r=Object(o.useMemo)((()=>[{title:Object(c.b)("words.consumed_product_other"),dataIndex:"inventory_product",key:"inventory_product",ellipsis:!0,render:e=>e.description},{title:Object(c.b)("words.quantity"),dataIndex:"quantity",key:"quantity",align:"right",width:160},{title:Object(c.b)("phrases.consumption_unit"),dataIndex:"unit_quantity",key:"unit_quantity",align:"right",width:160},{title:Object(c.b)("words.extra"),dataIndex:"extra_quantity",key:"extra_quantity",align:"right",width:160,render:e=>e||0},{title:Object(c.b)("phrases.unit_value"),dataIndex:"value",key:"value",align:"right",width:180,render:(e,t)=>i?Object(m.d)(t[i]*a):null},{title:Object(c.b)("phrases.total_value"),dataIndex:"total",key:"total",align:"right",width:180,render:(e,t)=>{if(!i)return null;const s=t[`total_${i}`]*a;return Object(m.d)(s,{cents:!0})}}]),[a,i]);return Object(_.jsx)(h,{columns:r,dataSource:t,rowKey:"id",pagination:!1})};u.displayName="SaleComposesTable";var O=Object(o.memo)(u);const h=Object(p.d)(r.a).withConfig({componentId:"wb__sc-8ttmva-0"})([".ant-table-content{min-height:0 !important;height:auto !important;}.ant-table-expanded-row td{padding:12px 8px !important;}"]);var x=s(116),g=s(27);const f=()=>{const e=Object(g.a)((e=>e.current_user.permissions)),t=Object(b.b)((e=>e.commission_items)),s=Object(b.b)((e=>{var t;return null===(t=e.employee)||void 0===t?void 0:t.employee_fee_config})),i=Object(b.b)((e=>e.commission_items_loading)),a=Object(b.b)((e=>e.selected_commission_items)),r=Object(b.b)((e=>e.expanded_row_keys)),d=Object(b.b)((e=>e.dispatch)),m=Object(o.useRef)(null),p="i"!==(null===s||void 0===s?void 0:s.product_consumed_price_by),u=Object(j.a)((t=>{var s;e.can_edit_sale?null===(s=m.current)||void 0===s||s.open({sale_id:t}):x.b.warning(Object(c.b)("phrases.no_permission_to_do_this"))})),h=Object(o.useMemo)((()=>({selectedRowKeys:a,columnWidth:16,onChange:e=>{d({type:"set_selected_commission_items",payload:e})}})),[d,a]),f=Object(o.useMemo)((()=>({expandedRowKeys:r,expandIconColumnIndex:-1,rowExpandable:e=>{var t;return((null===(t=e.inventory_sale_item)||void 0===t?void 0:t.inventory_sale_composes)||[]).length>0&&p},expandedRowRender:e=>{var t;const o=null===(t=e.inventory_sale_item)||void 0===t?void 0:t.inventory_sale_composes;if(o)return Object(_.jsx)(O,{sale_composes:o,commission_percentage:e.considered_commission_percentage/100,fee_config:s})}})),[r,s,p]);return Object(_.jsxs)(v,{children:[Object(_.jsx)(w,{dataSource:t,columns:u,pagination:!1,rowKey:"id",tableLayout:"fixed",size:"middle",loading:i,rowSelection:h,expandable:f,locale:{emptyText:Object(_.jsx)(n.a,{image:n.a.PRESENTED_IMAGE_SIMPLE,description:Object(c.b)("phrases.empty")})}}),Object(_.jsx)(l.a,{ref:m})]})};f.displayName="CommissionItemsTableDesktop";var y=Object(o.memo)(f);const v=Object(p.d)(d.g).withConfig({componentId:"wb__sc-zqvuxb-0"})(["padding:15px 0;@media print{padding:0;}"]),w=Object(p.d)(r.a).withConfig({componentId:"wb__sc-zqvuxb-1"})(["width:100%;box-shadow:0 0 10px 3px rgb(197 197 197 / 12%);.ant-table *{font-size:12rem !important;.ant-checkbox-input{opacity:unset;}colgroup .ant-table-selection-col{width:24px !important;min-width:24px !important;}}@media print{.ant-table{table{table-layout:auto !important;td,th{padding:12px 0 !important;}td{background:transparent !important;border-color:#f0f0f0 !important;}.ant-table-expanded-row td{padding-right:15px !important;}}colgroup{display:none !important;}.ant-table-selection-column{display:none !important;}}.ant-spin-nested-loading,.ant-spin-container{height:unset !important;}}"]);var C=s(1841),$=s(712),k=s(53),Y=s.n(k);var F=e=>Object(o.useMemo)((()=>[{title:Object(c.b)("words.date"),key:"created_at",dataIndex:"created_at",width:126,render:e=>Y()(e).format("L")},{title:Object(c.b)("words.origin"),key:"origin",dataIndex:"created_at",ellipsis:!0,render:(t,s)=>Object(_.jsx)(d.h,{onClick:()=>e(s.id),$color:"primary",$cursor:"pointer",children:Object(c.b)("finance.commissions.goal_payment")})},{title:Object(c.b)("words.value"),key:"value_cents",dataIndex:"value_cents",width:105,align:"right",render:e=>Object(_.jsx)($.a,{$semibold:!0,value:e,children:Object(m.d)(e)})}]),[e]);const I=()=>{const e=Object(b.b)((e=>e.bonifications)),t=Object(b.b)((e=>e.commission_items_loading)),s=Object(b.b)((e=>e.selected_bonifications)),n=Object(b.b)((e=>e.dispatch)),i=Object(o.useRef)(null),a=Object(o.useCallback)((e=>{var t;null===(t=i.current)||void 0===t||t.open(e)}),[]),r=F(a),l=Object(o.useMemo)((()=>({selectedRowKeys:s,columnWidth:16,onChange:e=>{n({type:"set_selected_bonifications",payload:e})}})),[n,s]);return 0===e.length||t?null:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(d.h,{$paddings:[10,0],$size:21,$semibold:!0,$block:!0,children:[Object(c.b)("words.bonification_other"),Object(_.jsxs)("small",{className:"no-print",children:["\xa0(",Object(c.b)("finance.commissions.select_to_add"),")"]})]}),Object(_.jsx)(D,{children:Object(_.jsx)(S,{dataSource:e,columns:r,pagination:!1,rowKey:"id",tableLayout:"fixed",size:"middle",loading:t,rowSelection:l})}),Object(_.jsx)(C.a,{ref:i})]})};var M=Object(o.memo)(I);const D=Object(p.d)(d.g).withConfig({componentId:"wb__sc-1kimzcd-0"})(["padding:15px 0;@media print{padding:0;}"]),S=Object(p.d)(r.a).withConfig({componentId:"wb__sc-1kimzcd-1"})(["width:100%;box-shadow:0 0 10px 3px rgb(197 197 197 / 12%);.ant-table *{font-size:12rem !important;.ant-checkbox-input{opacity:unset;}colgroup .ant-table-selection-col{width:24px !important;min-width:24px !important;}}@media print{.ant-table{table{table-layout:auto !important;td,th{padding:12px 0 !important;}td{background:transparent !important;border-color:#f0f0f0 !important;}}colgroup{display:none;}.ant-table-selection-column{display:none;}}.ant-spin-nested-loading,.ant-spin-container{height:unset !important;}}"]);var E=()=>Object(o.useMemo)((()=>[{title:Object(c.b)("words.date"),key:"date",dataIndex:"date",width:126,render:e=>Y()(e).format("L")},{title:Object(c.b)("words.observation",{count:2}),key:"note",dataIndex:"note",ellipsis:!0},{title:Object(c.b)("words.value"),key:"value_cents",dataIndex:"value_cents",width:105,align:"right",render:e=>Object(_.jsx)($.a,{$semibold:!0,value:e,children:Object(m.d)(e)})}]),[]);const z=()=>{const e=Object(b.b)((e=>e.advances)),t=Object(b.b)((e=>e.commission_items_loading)),s=Object(b.b)((e=>e.selected_advances)),n=Object(b.b)((e=>e.dispatch)),i=E(),a=Object(o.useMemo)((()=>({selectedRowKeys:s,columnWidth:16,onChange:e=>{n({type:"set_selected_advances",payload:e})}})),[n,s]);return 0===e.length||t?null:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(d.h,{$paddings:[10,0],$size:21,$semibold:!0,$block:!0,children:[Object(c.b)("words.advance",{count:2}),Object(_.jsxs)("small",{className:"no-print",children:["\xa0(",Object(c.b)("finance.commissions.select_to_apply_discount"),")"]})]}),Object(_.jsx)(N,{children:Object(_.jsx)(R,{dataSource:e,columns:i,pagination:!1,rowKey:"id",tableLayout:"fixed",size:"middle",loading:t,rowSelection:a})})]})};var q=Object(o.memo)(z);const N=Object(p.d)(d.g).withConfig({componentId:"wb__sc-pu7tev-0"})(["padding:15px 0;@media print{padding:0;}"]),R=Object(p.d)(r.a).withConfig({componentId:"wb__sc-pu7tev-1"})(["width:100%;box-shadow:0 0 10px 3px rgb(197 197 197 / 12%);.ant-table *{font-size:12rem !important;.ant-checkbox-input{opacity:unset;}colgroup .ant-table-selection-col{width:24px !important;min-width:24px !important;}}@media print{.ant-table{table{table-layout:auto !important;td,th{padding:12px 0 !important;}td{background:transparent !important;border-color:#f0f0f0 !important;}}colgroup{display:none;}.ant-table-selection-column{display:none;}}.ant-spin-nested-loading,.ant-spin-container{height:unset !important;}}"]);var P=s(817),L=s(597),K=s(852),T=s(3023),A=s(1809),V=s(159),B=s(787),H=s(3052),W=s(3041),J=s(2851),G=s(2937),U=s(37),Q=s(1850),X=s(76);const Z=U.e`
  mutation SaveEmployeeFeeConfig($data: SaveEmployeeFeeConfigInput!) {
    saveEmployeeFeeConfig(input: $data) {
      success
      errors
    }
  }
`;var ee=()=>{const[e,{loading:t}]=Object(Q.a)(Z,{context:{hasUpload:!0}});return[async t=>{try{const{data:s}=await e({variables:{data:t}}),{success:o=!1,errors:c=[]}=(null===s||void 0===s?void 0:s.saveEmployeeFeeConfig)||{};return null===c||void 0===c||c.forEach((e=>x.b.error(e))),{success:o}}catch(s){return X.a.captureException(s),x.b.error("N\xe3o foi poss\xedvel salvar as configura\xe7\xf5es de comiss\xe3o. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(s),{success:!1}}},{loading:t}]},te=s(405);const se=U.e`
  query FeeConfigurationDrawer ($id: ID) {
    employee (id: $id) {
      id
      employee_fee_config {
        id fee_payer discount_payer open_sales filter_date_by product_consumed_price_by discount_consumed_products_on
        considers_additional_cost show_total_gross_value commission_message_received
      }
    }
  }
`;var oe=e=>{let{id:t,onCompleted:s}=e;return Object(te.f)(se,{skip:!t,variables:{id:t},fetchPolicy:"network-only",onCompleted:e=>{const{employee:t}=e;s(t.employee_fee_config)},onError:e=>{X.a.captureException(e),console.log({error:e})}})},ce=s(943),ne=s(339),ie=s(586),ae=s(581);const re=(e,t)=>{let{afterSave:s}=e;const[n,i]=Object(o.useState)(!1),[a,r]=Object(o.useState)(),l=Object(g.a)((e=>e.is_mobile)),[b]=G.a.useForm(),{setFieldsValue:j,submit:m,resetFields:p}=b,[u,{loading:O}]=ee(),h=Object(o.useCallback)((e=>{const{commission_message_received:t,...s}=e,o={...s,commission_message_received:e.id?t:""};j({employee_fee_config_attributes:o})}),[j]),{loading:f,error:y}=oe({id:a,onCompleted:h}),v=Object(o.useCallback)((e=>{e&&r(e),i(!0)}),[]),w=Object(o.useCallback)((()=>{i(!1)}),[]);Object(o.useImperativeHandle)(t,(()=>({open:v,close:w})));const C=Object(o.useCallback)((async e=>{const{success:t}=await u({...e.employee_fee_config_attributes,employee_id:a});t&&(x.b.success(Object(c.b)("phrases.saved_successfully",{prefix:Object(c.b)("words.setting"),context:"female"})),w(),null===s||void 0===s||s())}),[s,w,a,u]),$=Object(o.useCallback)((e=>{e||(p(),r(void 0))}),[p]);return Object(_.jsx)(d.a,{open:n,title:"Configurar comiss\xf5es",width:1024,onClose:w,afterOpenChange:$,closable:!0,destroyOnClose:!0,footer:Object(_.jsx)(ae.a,{close:w,submit:m,loading:f||O,disabled:!!y}),children:Object(_.jsx)(le,{children:Object(_.jsxs)(ie.a,{visible:!!y,small:l,children:[Object(_.jsx)(ne.a,{loading:f}),Object(_.jsx)(G.a,{form:b,layout:"vertical",onFinish:C,children:Object(_.jsx)(ce.a,{setFieldsValue:j})})]})})})};re.displayName="FeeConfigurationDrawer";var de=Object(o.forwardRef)(re);const le=p.d.div.withConfig({componentId:"wb__sc-1nel48e-0"})(["position:relative;"]),be=U.e`
  query SalonFeeConfigurationDrawer {
    current_salon {
      id
      employee_fee_config {
        id fee_payer discount_payer open_sales filter_date_by product_consumed_price_by discount_consumed_products_on
        considers_additional_cost show_total_gross_value commission_message_received
      }
    }
  }
`;var je=e=>{let{onCompleted:t}=e;return Object(te.f)(be,{fetchPolicy:"network-only",onCompleted:e=>{const{current_salon:s}=e;t(s.employee_fee_config)},onError:e=>{X.a.captureException(e),console.log(e)}})};const me=U.e`
  mutation SaveSalonFeeConfig($data: SaveSalonEmployeeFeeConfigInput!) {
    saveSalonEmployeeFeeConfig(input: $data) {
      success
      errors
    }
  }
`;var pe=()=>{const[e,{loading:t}]=Object(Q.a)(me);return[async t=>{try{const{data:s}=await e({variables:{data:t}}),{success:o=!1,errors:c=[]}=(null===s||void 0===s?void 0:s.saveSalonEmployeeFeeConfig)||{};return null===c||void 0===c||c.forEach((e=>x.b.error(e))),{success:o}}catch(s){return X.a.captureException(s),x.b.error(Object(c.b)("phrases.generic_save_error_message")),console.error(s),{success:!1}}},{loading:t}]};const _e=e=>{let{visible:t,close:s,afterSave:n}=e;const[i]=G.a.useForm(),{setFieldsValue:a,submit:r}=i,[l,{loading:b}]=pe(),{loading:j,error:m}=je({onCompleted:e=>{const{commission_message_received:t,...s}=e,o={...s,commission_message_received:e.id?t:""};a({employee_fee_config_attributes:o})}}),p=Object(o.useCallback)((async e=>{const{success:t}=await l({...e.employee_fee_config_attributes});t&&(x.b.success(Object(c.b)("phrases.saved_successfully",{prefix:Object(c.b)("words.setting"),context:"female"})),s(),null===n||void 0===n||n())}),[n,s,l]);return Object(_.jsx)(d.a,{open:t,title:Object(c.b)("phrases.configure_commissions"),onClose:s,width:1024,closable:!0,destroyOnClose:!0,footer:Object(_.jsx)(ae.a,{close:s,submit:r,loading:j||b}),children:Object(_.jsxs)(Oe,{children:[Object(_.jsx)(ie.a,{visible:!!m}),Object(_.jsx)(ne.a,{loading:j}),Object(_.jsx)(G.a,{form:i,layout:"vertical",onFinish:p,children:Object(_.jsx)(ce.a,{setFieldsValue:a})})]})})};_e.displayName="FeeConfigurationDrawer";var ue=_e;const Oe=p.d.div.withConfig({componentId:"wb__sc-17i41ge-0"})(["position:relative;"]);var he=s(614),xe=s(354),ge=s(606);const fe=e=>{let{handlePrint:t}=e;const s=Object(b.b)((e=>e.filters.end_date)),n=Object(b.b)((e=>e.filters.start_date)),i=Object(b.b)((e=>e.filters.employee_id)),a=Object(g.a)((e=>e.current_user.permissions)),r=Object(b.b)((e=>e.filters.search_previous)),d=Object(b.b)((e=>e.commission_items_loading)),l=Object(b.b)((e=>e.show_tables)),j=Object(b.b)((e=>e.dispatch)),m=Object(b.b)((e=>e.refetchFeeConfig)),p=Object(b.b)((e=>e.fetchFeeConfig)),u=Object(b.b)((e=>e.fetchCommissions)),O=Object(b.b)((e=>e.refetchCommissions)),h=Object(o.useCallback)((async()=>{i&&(await m(),O())}),[m,O,i]),x=Object(o.useRef)(null),f=Object(o.useCallback)((e=>{var t;null===(t=x.current)||void 0===t||t.open(e)}),[]),[y]=Object(xe.b)(ue,{afterSave:h}),v=Object(o.useCallback)((async e=>{if(!e)return;j({type:"reset_data"}),j({type:"set_employee_id",payload:e}),await p(e);const t={employee_id:e,start_date:n.format("YYYY-MM-DD"),end_date:s.format("YYYY-MM-DD"),previous_end_date:n.subtract(1,"day").format("YYYY-MM-DD"),search_previous:r};u(t)}),[j,s,u,p,r,n]),w=Object(o.useCallback)((e=>{const t=null===e||void 0===e?void 0:e[0],s=null===e||void 0===e?void 0:e[1];if(!i||!t||!s)return;j({type:"set_dates",payload:{start_date:t,end_date:s}});const o={employee_id:i,start_date:t.format("YYYY-MM-DD"),end_date:s.format("YYYY-MM-DD"),previous_end_date:t.subtract(1,"day").format("YYYY-MM-DD"),search_previous:r};u(o)}),[j,i,u,r]),C=Object(o.useCallback)((e=>{if(!i)return;j({type:"set_search_previous",payload:e});const t={employee_id:i,start_date:n.format("YYYY-MM-DD"),end_date:s.format("YYYY-MM-DD"),previous_end_date:n.subtract(1,"day").format("YYYY-MM-DD"),search_previous:e};u(t)}),[j,i,s,u,n]),$=l&&!d,k=Object(o.useMemo)((()=>{const e=[{key:"print",onClick:t,disabled:!$,icon:Object(_.jsx)(B.a,{}),label:Object(c.b)("verbs.print")},{key:"divider",type:"divider"},{key:"salon-fee-config",onClick:()=>y(),icon:Object(_.jsx)(H.a,{}),label:Object(c.b)("finance.commissions.salon_settings")}];return i&&e.push({key:"employee-fee-config",onClick:()=>f(i),icon:Object(_.jsx)(H.a,{}),label:Object(c.b)("finance.commissions.employee_settings")}),e}),[$,i,t,f,y]);return Object(_.jsxs)(ve,{justify:"end",$gap:8,children:[l&&Object(_.jsxs)(_.Fragment,{children:[a.can_access_all_commissions&&Object(_.jsx)(he.a,{value:i,onChange:v,style:{width:250},has_commission:!0,getPopupContainer:()=>document.body}),Object(_.jsx)(ge.a,{value:[n,s],allowClear:!1,style:{width:250,height:32},onChange:w,getPopupContainer:()=>document.body}),Object(_.jsx)(K.a,{title:Object(c.b)("settings.commissions.search_previous_tooltip"),children:Object(_.jsxs)(we,{children:[Object(_.jsx)(T.a,{checked:r,onChange:C}),"\xa0",Object(c.b)("settings.commissions.search_previous")]})})]}),Object(_.jsx)(A.a,{menu:{items:k},trigger:["click"],children:Object(_.jsx)(V.a,{icon:Object(_.jsx)(W.a,{}),children:Object(c.b)("words.action",{count:2})})}),l&&Object(_.jsx)(V.a,{icon:Object(_.jsx)(J.a,{}),onClick:()=>O(),children:Object(c.b)("verbs.update")}),Object(_.jsx)(de,{afterSave:h,ref:x})]})};fe.displayName="Filters";var ye=Object(o.memo)(fe);const ve=Object(p.d)(d.g).withConfig({componentId:"wb__sc-1yt00ud-0"})(["@media (max-width:768px){flex-direction:column !important;& > *{margin-bottom:10px !important;}}"]),we=p.d.div.withConfig({componentId:"wb__sc-1yt00ud-1"})(["margin-top:auto;margin-bottom:auto;"]),Ce=e=>{const t=Object(g.a)((e=>e.current_user.permissions)),s=Object(P.a)();return Object(_.jsx)(L.b,{$showBottomBorder:!0,title:Object(c.b)("words.commission",{count:2}),tabs:s,children:t.can_access_commission&&Object(_.jsx)(ye,{...e})})};Ce.displayName="CommissionsHeader";var $e=Object(o.memo)(Ce),ke=s(774);const Ye=()=>{const e=Object(g.a)((e=>e.employees)),t=Object(g.a)((e=>e.current_user.permissions)),s=Object(g.a)((e=>e.current_user.employee)),n=t.can_access_all_commissions?e.filter((e=>e.active&&e.has_commission)):[s],i=Object(b.b)((e=>e.filters.end_date)),a=Object(b.b)((e=>e.filters.start_date)),r=Object(b.b)((e=>e.filters.search_previous)),l=Object(b.b)((e=>e.fetchFeeConfig)),j=Object(b.b)((e=>e.fetchCommissions)),m=Object(b.b)((e=>e.dispatch)),p=Object(o.useCallback)((async e=>{m({type:"set_employee_id",payload:e}),await l(e);const t={employee_id:e,start_date:a.format("YYYY-MM-DD"),end_date:i.format("YYYY-MM-DD"),previous_end_date:a.subtract(1,"day").format("YYYY-MM-DD"),search_previous:r};j(t)}),[m,i,j,l,r,a]),u=Object(o.useCallback)((e=>{const t=null===e||void 0===e?void 0:e[0],s=null===e||void 0===e?void 0:e[1];t&&s&&m({type:"set_dates",payload:{start_date:t,end_date:s}})}),[m]),O=Object(o.useCallback)((e=>{m({type:"set_search_previous",payload:e})}),[m]);return Object(_.jsxs)(Me,{$column:!0,$alignCenter:!0,children:[Object(_.jsx)(d.h,{$size:24,$semibold:!0,children:Object(c.b)("words.filter",{count:2})}),Object(_.jsx)(d.h,{$bottom:10,children:Object(c.b)("finance.commissions.select_period_and_employee")}),Object(_.jsx)(d.g,{$alignCenter:!0,$justifyCenter:!0,$bottom:10,children:Object(_.jsx)(ge.a,{value:[a,i],allowClear:!1,style:{width:450},onChange:u,getPopupContainer:()=>document.body})}),Object(_.jsx)(d.g,{$alignCenter:!0,$justifyCenter:!0,$bottom:10,children:Object(_.jsxs)(K.a,{title:Object(c.b)("settings.commissions.search_previous_tooltip"),children:[Object(_.jsx)(T.a,{checked:r,onChange:O}),"\xa0",Object(c.b)("settings.commissions.search_previous")]})}),Object(_.jsx)(Ie,{children:n.map((e=>Object(_.jsx)(De,{title:e.name,onClick:()=>p(e.id),children:Object(_.jsx)(ke.a,{item:e})},e.id)))})]})};Ye.displayName="EmployeeList";var Fe=Object(o.memo)(Ye);const Ie=p.d.div.withConfig({componentId:"wb__sc-eicw6g-0"})(["display:flex;flex-direction:column;flex-wrap:initial;overflow-x:hidden;overflow-y:auto;width:450px;max-height:calc(100vh - 260px);padding:0 20px;div + div{margin-top:10px;}"]),Me=Object(p.d)(d.g).withConfig({componentId:"wb__sc-eicw6g-1"})(["margin:0 auto;padding-top:10px;height:100%;"]),De=p.d.div.withConfig({componentId:"wb__sc-eicw6g-2"})(["display:flex;flex-direction:row;align-items:center;justify-content:flex-start;cursor:pointer;padding:10px;border:1px solid transparent;box-shadow:0 0 10px 3px rgb(197 197 197 / 12%);border-radius:5px;background-color:#FFFFFF;transition:box-shadow .2s;&:hover{border:1px solid ",";box-shadow:0 0 10px 3px rgb(197 197 197 / 30%);}"],(e=>e.theme.colors.primary));var Se=s(543),Ee=s(2883),ze=s(2975),qe=s(671);const Ne={i:Object(c.b)("employee_fee_config.no_discount"),cost:Object(c.b)("employee_fee_config.cost_price"),price:Object(c.b)("employee_fee_config.selling_price"),pro:Object(c.b)("employee_fee_config.employee_price")},Re={both:Object(c.b)("employee_fee_config.fee_and_discount_payer.both"),company:Object(c.b)("employee_fee_config.fee_and_discount_payer.company"),employee:Object(c.b)("employee_fee_config.fee_and_discount_payer.employee")},Pe=()=>{const e=Object(b.b)((e=>e.employee)),t=Object(b.b)((e=>e.refetchFeeConfig)),s=Object(o.useRef)(null),n=Object(o.useCallback)((e=>{var t;null===(t=s.current)||void 0===t||t.open(e)}),[]),i=Object(g.a)((e=>e.current_user.permissions));if(!e)return null;const a=e.employee_fee_config;return Object(_.jsxs)(Se.a,{justify:"center",children:[Object(_.jsxs)(Ke,{image:Object(_.jsx)(Te,{shape:"circle",size:100,src:e.avatar_url,icon:Object(_.jsx)("img",{src:qe.a,alt:""})}),description:Object(_.jsx)(d.h,{$size:24,$semibold:!0,$block:!0,$alignCenter:!0,$textEllipsis:!0,children:e.name}),children:[i.can_edit_commission&&Object(_.jsx)(V.a,{icon:Object(_.jsx)(H.a,{}),onClick:()=>n(),children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("employee_fee_config.commission_customization")})}),Object(_.jsxs)(Ae,{gutter:12,children:[Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.date_filter"),": "]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:"available_date"===a.filter_date_by?Object(c.b)("phrases.availability_date"):Object(c.b)("phrases.competence_date")}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.sale_type"),": "]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:a.open_sales?Object(c.b)("employee_fee_config.all_sales"):Object(c.b)("employee_fee_config.only_finished")}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("words.fee",{count:2}),": "]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Re[a.fee_payer]}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.discounts"),": "]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Re[a.discount_payer]}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.variable_cost_of_services"),":"]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:a.considers_additional_cost?Object(c.b)("employee_fee_config.apply_discount"):Object(c.b)("employee_fee_config.do_not_apply_discount")}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.deduct_consumed_products_from"),":"]})}),Object(_.jsxs)(Ee.a,{xs:24,sm:12,children:[0===a.discount_consumed_products_on?Object(c.b)("employee_fee_config.employee_commission"):null,1===a.discount_consumed_products_on?Object(c.b)("employee_fee_config.service"):null]}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("words.consumed_product",{count:2}),": "]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Ne[a.product_consumed_price_by]}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:Object(_.jsxs)(d.h,{$bold:!0,children:[Object(c.b)("employee_fee_config.display_gross_value_in_report"),":"]})}),Object(_.jsx)(Ee.a,{xs:24,sm:12,children:a.show_total_gross_value?Object(c.b)("words.yes"):Object(c.b)("words.no")})]})]}),Object(_.jsx)(de,{afterSave:t,ref:s})]})};Pe.displayName="EmployeeFeeConfig";var Le=Object(o.memo)(Pe);const Ke=Object(p.d)(n.a).withConfig({componentId:"wb__sc-ayh2sm-0"})(["margin-top:30px !important;width:100%;max-width:530px;padding:0 15px;.ant-empty-footer{margin-top:30px;}"]),Te=Object(p.d)(ze.a).withConfig({componentId:"wb__sc-ayh2sm-1"})(["min-height:100px;"]),Ae=Object(p.d)(Se.a).withConfig({componentId:"wb__sc-ayh2sm-2"})(["margin-top:30px;& > *:nth-child(2n){margin-bottom:5px;}@media (min-width:576px){& > *:nth-child(2n){text-align:left;}& > *:nth-child(2n + 1){text-align:right;}}"]),Ve=()=>Object(b.b)((e=>e.employee))?Object(_.jsx)(Le,{}):Object(_.jsx)(Fe,{});Ve.displayName="CommissionEmpty";var Be=Object(o.memo)(Ve);const He=()=>{const e=Object(b.b)((e=>e.employee)),t=Object(b.b)((e=>e.filters.start_date)),s=Object(b.b)((e=>e.filters.end_date));return Object(_.jsxs)(Je,{children:[Object(_.jsx)(d.h,{$block:!0,$size:21,$alignCenter:!0,$semibold:!0,$margins:10,children:Object(c.b)("words.commission",{count:2})}),Object(_.jsxs)(d.h,{$block:!0,$semibold:!0,children:[Object(c.b)("words.period"),": ",t.format("LL")," - ",s.format("LL")]}),Object(_.jsxs)(d.h,{$block:!0,$semibold:!0,$bottom:20,children:[Object(c.b)("words.employee"),": ",null===e||void 0===e?void 0:e.name]})]})};He.displayName="PrintHeader";var We=Object(o.memo)(He);const Je=p.d.div.withConfig({componentId:"wb__sc-wop40l-0"})(["display:none;@media print{display:unset;}"]);var Ge=s(137);const Ue=()=>{const e=Object(b.b)((e=>e.commission_items)),t=Object(b.b)((e=>e.advances)),s=Object(b.b)((e=>e.bonifications)),n=Object(b.b)((e=>{var t;return null===(t=e.employee)||void 0===t?void 0:t.employee_fee_config})),i=Object(o.useMemo)((()=>e.reduce(((e,t)=>{const s=e.sale_item_gross_value+t.sale_item_gross_value||0,o=3===t.employee_commission_mode?0:t.discounted_for_products_sum,c=e.discounted_for_products_sum+o||0;return{available_value:e.available_value+t.available_value||0,sale_item_gross_value:s,discounted_for_products_sum:c}}),{available_value:0,sale_item_gross_value:0,discounted_for_products_sum:0})),[e]),a=Object(o.useMemo)((()=>t.reduce(((e,t)=>e+t.value_cents/100),0)),[t]),r=Object(o.useMemo)((()=>s.reduce(((e,t)=>e+t.value_cents),0)/100),[s]),l=i.available_value-a+r;return Object(_.jsxs)(Xe,{children:[Object(_.jsx)(d.h,{$block:!0,$size:21,$alignCenter:!0,$semibold:!0,$margins:10,children:Object(c.b)("words.total",{count:2})}),(null===n||void 0===n?void 0:n.show_total_gross_value)&&Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.gross_value")})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(m.d)(i.sale_item_gross_value,{cents:!1})})})]}),Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.commission",{count:2})})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(m.d)(i.available_value,{cents:!1})})})]}),Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.consumed_product",{count:2})})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(m.d)(i.discounted_for_products_sum,{cents:!1})})})]}),Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.advance",{count:2})})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(m.d)(a,{cents:!1})})})]}),Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.bonification_other")})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(m.d)(r,{cents:!1})})})]}),Object(_.jsxs)(Ze,{gutter:12,children:[Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)(d.h,{$bold:!0,children:Object(c.b)("words.total")})}),Object(_.jsx)(Ee.a,{span:12,children:Object(_.jsx)($.a,{$bold:!0,value:l,children:Object(m.d)(l,{cents:!1})})})]})]})};Ue.displayName="PrintFooter";var Qe=Object(o.memo)(Ue,Ge.isEqual);const Xe=p.d.div.withConfig({componentId:"wb__sc-1ptq4zs-0"})(["width:100%;display:none;break-inside:avoid;& > .ant-row:first-of-type{border-top:1px solid #f0f0f0;}@media print{display:table;}"]),Ze=Object(p.d)(Se.a).withConfig({componentId:"wb__sc-1ptq4zs-1"})(["padding:12px 0;border-bottom:1px solid #f0f0f0;& > *:nth-child(2n){text-align:right;}& > *:nth-child(2n + 1){text-align:left;}"]);var et=s(1207),tt=s(3036),st=s(845),ot=s(1816);const ct=()=>{const e=Object(g.a)((e=>e.current_user.permissions)),t=Object(o.useRef)(null),s=Object(b.b)((e=>e.advances)),n=Object(b.b)((e=>e.filters.end_date)),i=Object(b.b)((e=>e.bonifications)),a=Object(b.b)((e=>e.filters.start_date)),r=Object(b.b)((e=>e.commission_items)),l=Object(b.b)((e=>e.selected_advances)),j=Object(b.b)((e=>{var t;return null===(t=e.employee)||void 0===t?void 0:t.employee_fee_config})),p=Object(b.b)((e=>e.selected_commission_items)),u=Object(b.b)((e=>e.selected_bonifications)),O=Object(b.b)((e=>e.refetchCommissions)),h=(null===j||void 0===j?void 0:j.show_total_gross_value)||!1,x=Object(o.useMemo)((()=>Object(st.d)(r,p)),[r,p]),f=Object(o.useMemo)((()=>Object(st.b)(s,l)),[s,l]),y=Object(o.useMemo)((()=>Object(st.c)(i,u)),[i,u]),v=Object(o.useMemo)((()=>Object(st.e)(x.available_value,f,y)),[f,y,x.available_value]),w=!(p.length>0&&v>=0);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(et.a,{offsetBottom:10,children:Object(_.jsxs)(it,{justify:"space-between",$paddings:10,$wrap:!0,children:[h&&Object(_.jsxs)(at,{xs:12,sm:6,md:4,children:[Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("words.gross_value")}),Object(m.d)(x.sale_item_gross_value,{cents:!1})]}),Object(_.jsxs)(at,{xs:12,sm:6,md:4,children:[Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("words.commission",{count:2})}),Object(m.d)(x.available_value,{cents:!1})]}),Object(_.jsxs)(at,{xs:12,sm:6,md:4,children:[Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("words.advance",{count:2})}),Object(m.d)(f,{cents:!1})]}),Object(_.jsxs)(at,{xs:12,sm:6,md:4,children:[Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("words.bonification_other")}),Object(m.d)(y,{cents:!1})]}),Object(_.jsxs)(at,{xs:12,sm:6,md:4,children:[Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("words.net")}),Object(_.jsx)($.a,{$semibold:!0,value:v,children:Object(m.d)(v,{cents:!1})})]}),e.can_pay_commission&&Object(_.jsx)(rt,{children:Object(_.jsx)(V.a,{type:"primary",className:"ant-button-success",icon:Object(_.jsx)(tt.a,{}),onClick:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.open()},disabled:w,children:Object(_.jsx)(d.h,{$semibold:!0,children:Object(c.b)("finance.commissions.pay_commissions")})})})]})}),Object(_.jsx)(ot.a,{ref:t,selected_commission_items:p,selected_advances:l,selected_bonifications:u,start_date_filter:a.format("YYYY-MM-DD"),end_date_filter:n.format("YYYY-MM-DD"),afterSave:O})]})};var nt=Object(o.memo)(ct);const it=Object(p.d)(d.g).withConfig({componentId:"wb__sc-1q2ttss-0"})(["width:calc(100%);background:#FFFFFF;margin:10px 0 0 0;box-shadow:0 0 10px 3px rgb(197 197 197 / 12%);border-radius:6px;@media (max-width:768px){width:calc(100% - 30px);margin:15px 15px 0 15px;}"]),at=Object(p.d)(Ee.a).withConfig({componentId:"wb__sc-1q2ttss-1"})(["display:flex !important;flex-direction:column;align-items:start;@media (max-width:768px){align-items:center;margin-bottom:10px;}"]),rt=Object(p.d)(Ee.a).withConfig({componentId:"wb__sc-1q2ttss-2"})(["display:flex;align-items:center;@media (max-width:768px){width:100%;.ant-btn{width:100%;}}"]),dt=()=>{const e=Object(g.a)((e=>e.current_user.permissions)),t=Object(b.b)((e=>e.employee)),s=Object(b.b)((e=>e.show_tables)),r=Object(b.b)((e=>e.commission_items)),d=Object(b.b)((e=>e.fee_config_error)),l=Object(b.b)((e=>e.commissions_has_error)),j=Object(b.b)((e=>e.employee_loading)),m=Object(b.b)((e=>e.dispatch)),p=Object(o.useRef)(null),u=Object(o.useMemo)((()=>({content:()=>p.current,removeAfterPrint:!0,onAfterPrint:()=>m({type:"set_expanded_row_keys",payload:[]})})),[m]),O=Object(i.useReactToPrint)(u),h=Object(o.useCallback)((()=>{const e=r.map((e=>e.id));m({type:"set_expanded_row_keys",payload:e}),p.current&&x.b.loading(`${Object(c.b)("verbs.wait")}...`,2,O)}),[r,m,O]);return Object(_.jsxs)(a.b,{children:[Object(_.jsx)($e,{handlePrint:h}),Object(_.jsxs)(lt,{$pageFull:!0,has_permission:e.can_access_commission,children:[Object(_.jsx)(ne.a,{loading:j}),s?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ie.a,{visible:l}),null!==t&&void 0!==t&&t.has_commission?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(bt,{ref:p,children:[Object(_.jsx)(We,{}),Object(_.jsx)(y,{}),Object(_.jsx)(q,{}),Object(_.jsx)(M,{}),Object(_.jsx)(Qe,{})]}),Object(_.jsx)(nt,{})]}):Object(_.jsx)(n.a,{style:{marginTop:15},description:Object(c.b)("finance.commissions.employee_has_no_commissions")})]}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ie.a,{visible:d}),Object(_.jsx)(Be,{})]})]})]})};dt.displayName="CommissionItems";t.default=Object(o.memo)(dt);const lt=Object(p.d)(a.c).withConfig({componentId:"wb__sc-1nyzygp-0"})(["position:relative;display:block;overflow-y:auto;"]),bt=p.d.div.withConfig({componentId:"wb__sc-1nyzygp-1"})(["@media print{margin:10px;}"])}}]);
//# sourceMappingURL=206.e7081bf0.chunk.js.map