(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[210],{2953:function(e,t,r){"use strict";r.r(t);var a=r(0),s=r(50),c=r(37);const n=c.e`
  query ChartList($page: Int, $results: Int, $search_query: String, $sort_field: String, $sort_order: String) {
    all_finance_charts(
      page: $page,
      results: $results,
      search: $search_query,
      sort_field: $sort_field,
      sort_order: $sort_order,
      use_replica: true
    ) {
      all {
        id name _default kind
      }

      total_count
    }
  }
`;c.e`
  query ChartsIdsList {
    all_finance_charts(use_replica: true) {
      all {
        id
      }
    }
  }
`;var o=r(627),i=r(2937),l=r(250),d=r(27),b=r(1850),u=r(116),j=r(76);const h=c.e`
  mutation ChartDrawerSaveChart ($data: SaveChartInput!) {
    saveChart (input: $data) {
      success errors
    }
  }
`;var O=()=>{const[e,{loading:t}]=Object(b.a)(h);return[async t=>{const{_default:r,...a}=t,c={...a,default:r};try{var n;const t=await e({variables:{data:c}}),{success:r=!1,errors:a=[]}=(null===(n=t.data)||void 0===n?void 0:n.saveChart)||{};return null===a||void 0===a||a.forEach((e=>u.b.error(e))),{success:r}}catch(o){return j.a.captureException(o),u.b.error(Object(s.b)("phrases.generic_save_error_message")),console.error(o),{success:!1}}},{loading:t}]},p=r(2879);const f=c.e`
  query FinanceBillRecDrawer ($id: ID) {
    finance_chart(id: $id) {
      id
      name
      _default
      kind
    }
  }
`;var m=(e,t)=>Object(p.a)(f,{fetchPolicy:"network-only",onCompleted:r=>{const{finance_chart:a}=r,{_default:s,...c}=a,n=s||void 0;t(n),e({...c,_default:n})},onError:e=>{j.a.captureException(e),console.log(e)}}),_=r(3048),v=r(1256),y=r(543),g=r(2824),w=r(2883),x=r(1227);const C={accountsetup:"AccountSetup",advance:"Advance",cashopening:"CashOpening",commission:"Commission","inventory/package":"Inventory::Package","inventory/purchase":"Inventory::Purchase","inventory/sale":"Inventory::Sale","offers/sale":"Offers::Sale",prolabore:"ProLabore",salary:"Salary",transfer:"Transfer","customer/subscription":"Customer::Subscription",revenues:"Revenues",expenses:"Expenses"},k={accountsetup:Object(s.b)("finance.registrations.charts.account_setup"),advance:Object(s.b)("words.advance"),cashopening:Object(s.b)("finance.cash_account.opening"),commission:Object(s.b)("words.commission"),"inventory/package":Object(s.b)("words.package_other"),"inventory/purchase":Object(s.b)("words.purchase_other"),"inventory/sale":Object(s.b)("words.sale_other"),"offers/sale":Object(s.b)("words.offer_other"),prolabore:Object(s.b)("words.pro_labore"),salary:Object(s.b)("words.salary"),transfer:Object(s.b)("words.transfer"),"customer/subscription":Object(s.b)("phrases.subscription_sale"),revenues:Object(s.b)("finance.registrations.charts.revenues"),expenses:Object(s.b)("finance.registrations.charts.expenses")};var $=r(22);const{Option:I}=v.a,S=e=>{let{initial_default:t}=e;const r=Object(d.a)((e=>e.is_mobile));return Object($.jsxs)(y.a,{gutter:8,children:[Object($.jsx)(i.a.Item,{noStyle:!0,name:"id",children:Object($.jsx)(g.a,{type:"hidden"})}),Object($.jsx)(w.a,{span:24,children:Object($.jsx)(i.a.Item,{name:"name",label:Object(s.b)("words.name"),rules:[{required:!0,message:Object(s.b)("phrases.required_field")}],children:Object($.jsx)(g.a,{size:r?"large":"middle",placeholder:Object(s.b)("words.name")})})}),Object($.jsx)(w.a,{md:12,xs:24,children:Object($.jsx)(i.a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.id!==t.id||e._default!==t._default,children:e=>{let{getFieldValue:t}=e;const a=t("id"),c=t("_default"),n=!!a||!!c&&c!==C.transfer;return Object($.jsx)(i.a.Item,{name:"kind",label:Object(s.b)("words.type"),initialValue:"C",rules:[{required:!0,message:Object(s.b)("phrases.required_field")}],children:Object($.jsxs)(v.a,{size:r?"large":"middle",disabled:n,children:[Object($.jsx)(I,{value:"C",children:Object(s.b)("words.credit")}),Object($.jsx)(I,{value:"D",children:Object(s.b)("words.debit")})]})})}})}),Object($.jsx)(w.a,{md:12,xs:24,children:Object($.jsx)(i.a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.id!==t.id,children:e=>{let{getFieldValue:a,setFieldsValue:c}=e;const n=a("id");return Object($.jsx)(i.a.Item,{label:Object($.jsxs)("span",{children:[Object(s.b)("finance.registrations.charts.default_screen"),Object($.jsx)(x.a,{title:Object(s.b)("finance.registrations.charts.default_screen"),trigger:["hover","click"],content:Object($.jsx)(l.h,{$align:"justify",$block:!0,style:{width:250},children:Object(s.b)("finance.registrations.charts.default_screen_tooltip")}),children:Object($.jsx)(_.a,{style:{marginLeft:5}})})]}),name:"_default",children:Object($.jsx)(v.a,{placeholder:Object(s.b)("finance.registrations.charts.default_screen"),disabled:!!n&&!!t,onChange:e=>{return c({kind:(t=e,{AccountSetup:"C",Advance:"D",CashOpening:"C",Commission:"D","Inventory::Package":"C","Inventory::Purchase":"D","Inventory::Sale":"C","Offers::Sale":"C",ProLabore:"D",Salary:"D","Customer::Subscription":"C",Revenues:"C",Expenses:"D"}[t]||"C")});var t},size:r?"large":"middle",children:Object.keys(k).map((e=>{const t=C[e],r=k[e];return Object($.jsx)(I,{value:t,children:r},e)}))})})}})})]})};S.displayName="ChartForm";var D=S,F=r(581),L=r(339);const q=(e,t)=>{let{afterSave:r}=e;const c=Object(d.a)((e=>e.is_mobile)),[n,o]=Object(a.useState)(!1),[b,j]=Object(a.useState)(),[h]=i.a.useForm(),{submit:p,setFieldsValue:f,resetFields:_}=h,[v,{loading:y}]=O(),[g,{loading:w,error:x}]=m(f,j),C=e=>{e&&g({variables:{id:e}}),o(!0)},k=Object(a.useCallback)((()=>o(!1)),[]);Object(a.useImperativeHandle)(t,(()=>({open:C,close:k})));const I=Object(a.useCallback)((async e=>{const{success:t}=await v(e);t&&(u.b.success(Object(s.b)("phrases.saved_successfully",{prefix:Object(s.b)("words.category"),context:"female"})),null===r||void 0===r||r(),k())}),[k,r,v]);return Object($.jsxs)(l.a,{open:n,title:Object(s.b)("words.category"),onClose:k,placement:c?"bottom":"right",height:"100%",closable:!0,width:480,destroyOnClose:!0,afterOpenChange:e=>!e&&_(),footer:Object($.jsx)(F.a,{loading:y,submit:p,close:k,disabled:!!x}),children:[Object($.jsx)(L.a,{loading:w}),Object($.jsxs)(i.a,{form:h,layout:"vertical",onFinish:I,scrollToFirstError:!0,children:[Object($.jsx)("button",{type:"submit",hidden:!0}),Object($.jsx)(D,{initial_default:b})]})]})};q.displayName="ChartDrawer";var R=Object(a.memo)(Object(a.forwardRef)(q)),E=r(593);const P=c.e`
  mutation ChartsListDrawer($data: DestroyChartInput!) {
    destroyChart(input: $data) {
      destroyed errors
    }
  }
`;var T=()=>{const[e,{loading:t}]=Object(b.a)(P),r=Object(a.useCallback)((async t=>{const r=u.b.loading(`${Object(s.b)("verbs.wait")}...`,0);try{const{data:a}=await e({variables:{data:t}});let{destroyed:s=!1,errors:c=[]}=(null===a||void 0===a?void 0:a.destroyChart)||{};return{success:s,errors:c}}catch(a){return u.b.error(Object(s.b)("phrases.generic_save_error_message")),console.error(a),{success:!1}}finally{r()}}),[e]);return[r,t]},N=r(547),V=r(583),z=r(19);const A=e=>{let{item:t}=e;const r=null!==t&&void 0!==t&&t._default?k[t._default.toLowerCase().replace("::","/")]:"";return Object($.jsxs)(H,{children:[Object($.jsx)(l.g,{children:Object($.jsx)(V.b,{width:15,$block:!0,children:null===t||void 0===t?void 0:t.name})}),Object($.jsxs)(l.g,{justify:"space-between",$top:10,children:[Object($.jsx)(V.b,{width:10,$block:!0,children:"C"===(null===t||void 0===t?void 0:t.kind)?Object($.jsx)(N.a,{color:"green",children:Object(s.b)("words.credit")}):Object($.jsx)(N.a,{color:"red",children:Object(s.b)("words.debit")})}),Object($.jsx)("div",{children:r})]})]})};A.displayName="ChartItemMobile";var M=Object(a.memo)(A);const H=z.d.div.withConfig({componentId:"wb__sc-1y5witv-0"})(["width:100%;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;"]);var J=r(852),U=r(1438),B=r(616),G=r(3034),K=r(2854);var Q=e=>{let{openChartDrawer:t,destroyChart:r}=e;return Object(a.useMemo)((()=>[{title:Object(s.b)("words.name"),dataIndex:"name",key:"name",className:"table-sort",sorter:!0,always_visible:!0,render:(e,r)=>Object($.jsx)(l.h,{$cursor:"pointer",$color:"primary",onClick:()=>t(r),children:e})},{title:`${Object(s.b)("words.credit")}/${Object(s.b)("words.debit")}`,dataIndex:"kind",key:"kind",default_visible:!0,width:"20%",render:e=>"C"===e?Object($.jsx)(N.a,{color:"green",children:Object(s.b)("words.credit")}):Object($.jsx)(N.a,{color:"red",children:Object(s.b)("words.debit")})},{title:Object(s.b)("finance.registrations.charts.default_screen"),dataIndex:"_default",key:"_default",default_visible:!0,width:"20%",render:e=>e?k[e.toLowerCase().replace("::","/")]:""},{title:Object(s.b)("words.action_other"),key:"actions",align:"center",always_visible:!0,width:100,render:(e,a)=>Object($.jsxs)(B.a,{width:84,children:[Object($.jsx)(J.a,{title:Object(s.b)("verbs.edit"),children:Object($.jsx)(l.h,{$cursor:"pointer",$color:"primary",onClick:()=>t(a),children:Object($.jsx)(G.a,{})})}),Object($.jsx)(U.a,{type:"vertical"}),Object($.jsx)(l.d,{as:K.a,$color:a._default?"gray_1":"red",onClick:()=>r(a.id)})]})}]),[r,t])},W=r(1433),X=r(612);t.default=()=>{Object(E.a)({feature_keys:["has_finance_customization"]});const e=Object(d.a)((e=>e.current_user.permissions)),t=Object(a.useRef)(null),r=Object(a.useRef)(null),[c]=T(),i=Object(a.useCallback)((()=>{var e;null===(e=t.current)||void 0===e||e.refetch()}),[]),l=Object(a.useCallback)((async e=>{var r;const{success:a}=await c({id:e});a&&(u.b.success(Object(s.b)("phrases.deleted_successfully",{prefix:Object(s.b)("words.category"),context:"female"})),null===(r=t.current)||void 0===r||r.afterDestroyRecord(1))}),[c]),b=Object(a.useCallback)((t=>{e.is_admin?u.c.confirm({centered:!0,className:"webook-modal",title:Object(s.b)("words.attention"),maskClosable:!0,content:Object(s.b)("phrases.confirm_delete",{model:Object(s.b)("words.category").toLocaleLowerCase(),context:"female"}),okText:Object(s.b)("phrases.yes_delete"),okType:"danger",cancelText:Object(s.b)("verbs.cancel"),onOk:()=>l(t)}):u.b.warning(Object(s.b)("phrases.no_permission_to_do_this"))}),[l,e.is_admin]),j=Object(a.useCallback)((e=>{var t;null===(t=r.current)||void 0===t||t.open(null===e||void 0===e?void 0:e.id)}),[]),h=Q({openChartDrawer:j,destroyChart:b}),O=Object(a.useCallback)((e=>{if(!e._default)return{content:Object($.jsx)(X.a,{icon:K.a,label:Object(s.b)("verbs.delete"),direction:"left",color:"red"}),action:()=>b(e.id)}}),[b]);return Object($.jsxs)($.Fragment,{children:[Object($.jsx)(o.a,{ref:t,Header:W.a,title:Object(s.b)("words.record",{count:2}),storage_key:"categorias_financeiro",search_placeholder:Object(s.b)("input.search_by_name"),permissions:{can_create:e.is_admin,can_edit:e.is_admin,can_access:e.is_admin},columns:h,query:n,item_selectable:!1,getData:e=>null===e||void 0===e?void 0:e.all_finance_charts.all,getTotalCount:e=>(null===e||void 0===e?void 0:e.all_finance_charts.total_count)||0,MobileItem:M,openDrawer:j,validateRow:()=>!0,mobileSwipeLeft:O}),Object($.jsx)(R,{ref:r,afterSave:i})]})}}}]);
//# sourceMappingURL=210.d34b076d.chunk.js.map