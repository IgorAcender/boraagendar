(this["webpackJsonpwebook-react"]=this["webpackJsonpwebook-react"]||[]).push([[124],{2925:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a(20),s=a(18),c=a(37);const o=c.e`
  query ElectronicConsumerInvoiceList(
    $page: Int, $results: Int, $search_query: String, $start_date: String, $end_date: String, $status: [ID]
  ) {
    all_electronic_consumer_invoices (
      sort_order: "DESC",
      sort_field: "id",
      page: $page,
      results: $results,
      search_term: $search_query,
      start_date: $start_date,
      end_date: $end_date,
      status: $status,
    ) {
      total_count
      all {
        id
        document_id
        emission_environment
        document_type
        status
        status_reason
        pdf_file_link
        xml_file_link
        created_at
        total_value
        customer_name
        number
        document {
          ... on Inventory_Sale {
            id
            code
            finished
          }
        }
      }
    }

    current_salon {
      id
      finance_consumer_notation_disables {
        id
        created_at
        status
        status_reason
        environment
        series
        initial_number
        final_number
        justification
      }
    }
  }
`;var r=a(3074),l=a(1102),d=a(627),u=a(613),b=a(647),_=a(852),j=a(250),m=a(579),v=a(547),O=a(967),p=a(1453),h=a(19),x=a(53),f=a.n(x),g=a(22);const y=e=>({pending:Object(g.jsx)(k,{color:"#1194f6",children:"Pendente"}),issued:Object(g.jsx)(k,{color:"#4eb660",children:"Emitida"}),canceled:Object(g.jsx)(k,{color:"#faa84f",children:"Cancelada"}),denied:Object(g.jsx)(k,{color:"#e44e4d",children:"Negada"}),cancel_denied:Object(g.jsx)(k,{color:"#e44e4d",children:"Cancelamento negado"}),Erro:Object(g.jsx)(k,{color:"#e44e4d",children:"Erro"}),AutorizacaoSolicitada:Object(g.jsx)(k,{color:"#1194f6",children:"Pendente"}),Negada:Object(g.jsx)(k,{color:"#e44e4d",children:"Inutiliza\xe7\xe3o negada"}),Autorizada:Object(g.jsx)(k,{color:"#7e57c6",children:"Inutilizada"})}[e]||Object(g.jsx)(k,{color:"#1194f6",children:"Pendente"}));var C=e=>{let{refetch:t,openSaleDrawer:a,openPackageDrawer:n}=e;const c=Object(i.useCallback)(((e,t)=>{"Inventory::Sale"!==e?"Inventory::Package"!==e||n(t):a(t)}),[n,a]);return Object(i.useMemo)((()=>[{title:"Status",default_visible:!0,always_visible:!0,key:"status",dataIndex:"status",width:150,render:(e,t)=>{const a=t.status_reason;return Object(g.jsx)(_.a,{placement:"top",title:Object(O.a)({status:e,status_reason:a}),children:y(e)})}},{title:"Data",dataIndex:"emission_date",key:"emission_date",width:100,default_visible:!0,render:(e,t)=>{const a=e||t.created_at;return f()(a,s.H).format("L")}},{title:"Comanda/Pacote",key:"client_sale_type",dataIndex:"client_sale_type",default_visible:!0,render:(e,t)=>{const a=`${"Inventory::Sale"===e?"C":"P"}#${t.client_sale.code}`;return Object(g.jsx)(j.i,{onClick:()=>c(e,t.client_sale_id),children:a})}},{title:"Cliente",key:"client_name",dataIndex:"client_name",ellipsis:!0,default_visible:!0,render:e=>e},{title:"Valor",dataIndex:"total_value",key:"total_value",width:115,align:"right",default_visible:!0,render:e=>Object(m.d)(e,{cents:!1})},{default_visible:!0,key:"actions",align:"center",width:70,render:(e,a)=>Object(g.jsx)(p.a,{has_service:!0,show_menu_icon:!0,can_issue:!0,sale_finished:a.client_sale.finished,invoice:a,sale_id:a.client_sale_id,type:a.client_sale_type,refetch:t})}]),[c,t])};const k=Object(h.d)(v.a).withConfig({componentId:"wb__sc-1eg79d-0"})(["margin-right:0 !important;"]);var w=a(50),I=a(1809),$=a(691),S=a(2937),N=a(2883),D=a(1256),E=a(2824),F=a(2838),z=a(1850),P=a(116),R=a(76);const M=c.e`
  mutation CreateElectronicNotationDisable ($data: Finance_InvoiceNotationDisable_CreateInput!) {
    invoiceNotationDisableCreate(input: $data) {
      id success errors
    }
  }
`;var q=()=>{const[e,{loading:t}]=Object(z.a)(M);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:i,errors:n}=(null===a||void 0===a?void 0:a.invoiceNotationDisableCreate)||{};return i?(P.b.success("Inutiliza\xe7\xe3o enviada com sucesso!"),{success:i}):(null===n||void 0===n||n.forEach((e=>P.b.error(e))),{success:i})}catch(a){return R.a.captureException(a),P.b.error("N\xe3o foi poss\xedvel realizar a inutiliza\xe7\xe3o. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(a),{success:!1}}},{loading:t}]},L=a(27),A=a(581);const H=(e,t)=>{const{afterSave:a}=e,[n,s]=Object(i.useState)(!1),c=Object(L.a)((e=>e.is_mobile)),[o]=S.a.useForm(),{resetFields:r,setFieldsValue:l,submit:d}=o,[u,{loading:b}]=q(),_=Object(i.useCallback)((()=>{l({environment:"Producao"}),s(!0)}),[l]),m=Object(i.useCallback)((()=>{s(!1)}),[]);Object(i.useImperativeHandle)(t,(()=>({open:_,close:m})));return Object(g.jsx)(j.a,{open:n,title:"Inutilizar numera\xe7\xe3o de NF-e",placement:c?"bottom":"right",height:"100%",onClose:m,width:768,closable:!0,destroyOnClose:!0,afterOpenChange:e=>{e||r()},footer:Object(g.jsx)(A.a,{loading:b,submit:d,close:m,save_text:"Baixar"}),push:!1,children:Object(g.jsx)(S.a,{form:o,layout:"vertical",onFinish:async e=>{const{success:t}=await u(e);t&&(m(),null===a||void 0===a||a())},children:Object(g.jsxs)(j.g,{gutter:8,$wrap:!0,children:[Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"Ambiente",name:"environment",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsxs)(D.a,{size:c?"large":"middle",style:{width:"100%"},children:[Object(g.jsx)(D.a.Option,{value:"Producao",children:"Produ\xe7\xe3o"}),Object(g.jsx)(D.a.Option,{value:"Homologacao",children:"Homologa\xe7\xe3o"})]})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"S\xe9rie",name:"series",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(E.a,{size:c?"large":"middle"})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"N\xfamero inicial",name:"initial_number",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(F.a,{size:c?"large":"middle",style:{width:"100%"}})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"N\xfamero Final",name:"final_number",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(F.a,{size:c?"large":"middle",style:{width:"100%"}})})}),Object(g.jsx)(N.a,{span:24,children:Object(g.jsx)(S.a.Item,{label:"Justificativa",name:"justification",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(E.a.TextArea,{size:c?"large":"middle",rows:3})})})]})})})};H.displayName="ElectronicNotationDisable";var V=Object(i.forwardRef)(H),B=a(1004),T=a(131),X=a(2851);var U=e=>{const{status:t,handleUpdateStatus:a,handleDestroyRecord:n,handleDownloadXML:s,openNotationDisable:c}=e;return Object(i.useMemo)((()=>{const e=[];return"Erro"!==t&&e.push({key:"update-status-notation",onClick:a,icon:Object(g.jsx)(B.a,{}),label:"Atualizar status"}),"Autorizada"===t&&e.push({key:"download-xml-notation",onClick:s,icon:Object(g.jsx)(l.a,{}),label:"Baixar XML"}),"Erro"===t&&e.push({key:"destroy-divider",type:"divider"},{key:"destroy",onClick:n,danger:!0,icon:Object(g.jsx)(T.a,{}),label:Object(w.b)("verbs.delete")}),["Erro","Negada"].includes(t)&&e.push({key:"retry",onClick:c,icon:Object(g.jsx)(X.a,{}),label:"Tentar inutilizar novamente"}),e}),[n,s,a,c,t])};const Y=c.e`
  mutation UpdateNotationDisableStatus($data: Finance_InvoiceNotationDisable_UpdateStatusInput!) {
    invoiceNotationDisableUpdateStatus(input: $data) {
      success errors status status_reason
    }
  }
`;var J=()=>{const[e,{loading:t}]=Object(z.a)(Y);return[async t=>{try{const{data:a}=await e({variables:{data:{id:t}}}),{success:i,errors:n}=(null===a||void 0===a?void 0:a.invoiceNotationDisableUpdateStatus)||{};return i?(P.b.success("Inutiliza\xe7\xe3o de nota fiscal de produto atualizada!"),{success:i}):(null===n||void 0===n||n.forEach((e=>P.b.error(e))),{success:i})}catch(a){return R.a.captureException(a),P.b.error("N\xe3o foi poss\xedvel atualizar a inutiliza\xe7\xe3o da nota fiscal de produto. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(a),{success:!1}}},{loading:t}]};const W=c.e`
  mutation DestroyInvoiceNotationDisable($data: Finance_InvoiceNotationDisable_DestroyInput!) {
    invoiceNotationDisableDestroy(input: $data) {
      success errors
    }
  }
`;var K=()=>{const[e,{loading:t}]=Object(z.a)(W);return[async t=>{const a=P.b.loading(`${Object(w.b)("verbs.wait")}...`,0);try{const{data:i}=await e({variables:{data:{id:t}}}),{success:n,errors:s}=(null===i||void 0===i?void 0:i.invoiceNotationDisableDestroy)||{};return n?(P.b.success("Inutiliza\xe7\xe3o exclu\xedda do sistema!"),{success:n}):(null===s||void 0===s||s.forEach((e=>P.b.error(e))),{success:n})}catch(i){return R.a.captureException(i),P.b.error("N\xe3o foi poss\xedvel excluir a inutiliza\xe7\xe3o. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(i),{success:!1}}finally{a()}},{loading:t}]},G=a(2879),Q=a(836);const Z=c.e`
  query DownloadXmlNotation($id: ID!) {
    download_xml_notation(id: $id, notation_type: "nf-e")
  }
`;var ee=()=>Object(G.a)(Z,{fetchPolicy:"network-only",onCompleted:e=>{let{download_xml_notation:t}=e;const{xml:a,filename:i}=JSON.parse(t);try{const e=new Blob([a],{type:"text/xml"});Object(Q.saveAs)(e,i)}catch(n){R.a.captureException(n),P.b.error("N\xe3o foi poss\xedvel realizar o download do XML. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(n)}}});const te=e=>{const{notation_disable:t,refetch:a}=e,[n,s]=Object(i.useState)(!1),c=Object(L.a)((e=>e.current_user.permissions)),{status:o,id:r}=t,l=Object(i.useRef)(null),[d]=ee(),[u]=J(),[b]=K(),_=()=>{P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},m=Object(i.useCallback)((async()=>{if(!c.can_edit_invoice)return void _();s(!1);const{success:e}=await u(r);e&&(null===a||void 0===a||a())}),[r,c.can_edit_invoice,a,u]),v=Object(i.useCallback)((async()=>{if(!c.can_destroy_invoice)return void _();s(!1);const{success:e}=await b(r);e&&(null===a||void 0===a||a())}),[b,r,c.can_destroy_invoice,a]),O=Object(i.useCallback)((()=>{c.can_access_invoice?(s(!1),d({variables:{id:r}})):_()}),[d,r,c.can_access_invoice]),p=Object(i.useCallback)((()=>{var e;c.can_create_invoice?(s(!1),null===(e=l.current)||void 0===e||e.open()):_()}),[c.can_create_invoice]),h=U({status:o,handleUpdateStatus:m,handleDestroyRecord:v,openNotationDisable:p,handleDownloadXML:O});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(I.a,{open:n,onOpenChange:s,menu:{items:h},trigger:["click"],children:Object(g.jsx)(j.i,{children:Object(g.jsx)($.a,{})})}),Object(g.jsx)(V,{ref:l,afterSave:()=>null===a||void 0===a?void 0:a()})]})};var ae=Object(i.memo)(te),ie=a(1422);const ne=e=>({Homologacao:Object(g.jsx)(v.a,{color:"green",children:"Homologa\xe7\xe3o"}),Producao:Object(g.jsx)(v.a,{color:"blue",children:"Produ\xe7\xe3o"})}[e]||"");var se=e=>{let{refetch:t,openSaleDrawer:a,openPackageDrawer:n}=e;const s=Object(i.useCallback)(((e,t)=>{"Inventory::Sale"!==e?"Inventory::Package"!==e||n(t):a(t)}),[n,a]);return Object(i.useMemo)((()=>[{title:"Status",default_visible:!0,always_visible:!0,key:"status",dataIndex:"status",width:140,render:(e,t)=>{const a=t.status_reason;return Object(g.jsx)(_.a,{placement:"top",title:Object(O.a)({status:e,status_reason:a}),children:y(e)})}},{title:"Ambiente",default_visible:!0,always_visible:!0,key:"emission_environment",dataIndex:"emission_environment",width:110,render:(e,t)=>ne(e||t.environment)},{title:"Data",dataIndex:"created_at",key:"created_at",width:100,default_visible:!0,render:(e,t)=>ce(t)},{title:"Comanda/Pacote",key:"document_type",dataIndex:"document_type",default_visible:!0,render:(e,t)=>{if("Finance_InvoiceNotationDisable"===t.__typename)return"";const a=`${"Inventory::Sale"===e?"C":"P"}#${t.document.code}`;return Object(g.jsx)(j.i,{onClick:()=>s(e,t.document_id),children:a})}},{title:"N\xfamero",key:"number",dataIndex:"number",width:90,default_visible:!0,render:(e,t)=>"Finance_InvoiceNotationDisable"===t.__typename?`${t.initial_number} - ${t.final_number}`:e},{title:"Cliente",key:"customer_name",dataIndex:"customer_name",default_visible:!0,render:(e,t)=>"Finance_InvoiceNotationDisable"===t.__typename?`Inutiliza\xe7\xe3o da numera\xe7\xe3o ${t.initial_number} \xe0 ${t.final_number}`:e},{title:"Valor",dataIndex:"total_value",key:"total_value",align:"right",width:115,default_visible:!0,render:e=>e>0?Object(m.d)(e,{cents:!1}):""},{default_visible:!0,key:"actions",align:"center",width:70,render:(e,a)=>{if("Finance_InvoiceNotationDisable"===a.__typename){const e={id:a.id,status:a.status,status_reason:a.status_reason,created_at:a.created_at,environment:a.environment,series:a.series,initial_number:a.initial_number,final_number:a.final_number,justification:a.justification};return Object(g.jsx)(ae,{notation_disable:e,refetch:t})}const i={id:a.id,status:a.status,status_reason:a.status_reason,created_at:a.created_at,document_id:a.document_id,emission_environment:a.emission_environment,document_type:a.document_type,pdf_file_link:a.pdf_file_link,xml_file_link:a.xml_file_link,customer_name:a.customer_name,number:a.number,finished:a.document.finished};return Object(g.jsx)(ie.a,{has_product:!0,show_menu_icon:!0,can_issue:!0,sale_finished:i.finished,electronic_invoice:i,sale_id:i.document_id,type:i.document_type,refetch:t})}}]),[s,t])};const ce=e=>"Finance_InvoiceNotationDisable"===(null===e||void 0===e?void 0:e.__typename)?f()(null===e||void 0===e?void 0:e.created_at).format("L"):f()(null===e||void 0===e?void 0:e.created_at,s.H).format("L"),oe=c.e`
  mutation CreateConsumerNotationDisable ($data: FinanceConsumerNotationDisableCreateInput!) {
    consumerNotationDisableCreate(input: $data) {
      success errors
    }
  }
`;var re=()=>{const[e,{loading:t}]=Object(z.a)(oe);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:i,errors:n}=(null===a||void 0===a?void 0:a.consumerNotationDisableCreate)||{};return i?(P.b.success("Inutiliza\xe7\xe3o enviada com sucesso!"),{success:i}):(null===n||void 0===n||n.forEach((e=>P.b.error(e))),{success:i})}catch(a){return R.a.captureException(a),P.b.error("N\xe3o foi poss\xedvel realizar a inutiliza\xe7\xe3o. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(a),{success:!1}}},{loading:t}]};const le=(e,t)=>{const{afterSave:a}=e,[n,s]=Object(i.useState)(!1),c=Object(L.a)((e=>e.is_mobile)),[o]=S.a.useForm(),{resetFields:r,setFieldsValue:l,submit:d}=o,[u,{loading:b}]=re(),_=Object(i.useCallback)((()=>{l({environment:"Producao"}),s(!0)}),[l]),m=Object(i.useCallback)((()=>{s(!1)}),[]);Object(i.useImperativeHandle)(t,(()=>({open:_,close:m})));return Object(g.jsx)(j.a,{open:n,title:"Inutilizar numera\xe7\xe3o de NFC-e",placement:c?"bottom":"right",height:"100%",onClose:m,width:768,closable:!0,destroyOnClose:!0,afterOpenChange:e=>{e||r()},footer:Object(g.jsx)(A.a,{loading:b,submit:d,close:m,save_text:"Baixar"}),push:!1,children:Object(g.jsx)(S.a,{form:o,layout:"vertical",onFinish:async e=>{const{success:t}=await u(e);t&&(m(),null===a||void 0===a||a())},children:Object(g.jsxs)(j.g,{gutter:8,$wrap:!0,children:[Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"Ambiente",name:"environment",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsxs)(D.a,{size:"middle",style:{width:"100%"},children:[Object(g.jsx)(D.a.Option,{value:"Producao",children:"Produ\xe7\xe3o"}),Object(g.jsx)(D.a.Option,{value:"Homologacao",children:"Homologa\xe7\xe3o"})]})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"S\xe9rie",name:"series",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(E.a,{})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"N\xfamero inicial",name:"initial_number",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(F.a,{style:{width:"100%"}})})}),Object(g.jsx)(N.a,{xs:24,md:12,children:Object(g.jsx)(S.a.Item,{label:"N\xfamero Final",name:"final_number",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(F.a,{style:{width:"100%"}})})}),Object(g.jsx)(N.a,{span:24,children:Object(g.jsx)(S.a.Item,{label:"Justificativa",name:"justification",rules:[{required:!0,message:"Obrigat\xf3rio"}],children:Object(g.jsx)(E.a.TextArea,{rows:3})})})]})})})};le.displayName="ConsumerNotationDisable";var de=Object(i.forwardRef)(le);const ue=c.e`
  mutation DestroyInvoiceNotationDisable($data: FinanceConsumerNotationDisableDestroyInput!) {
    consumerNotationDisableDestroy(input: $data) {
      success errors
    }
  }
`;var be=()=>{const[e,{loading:t}]=Object(z.a)(ue);return[async t=>{const a=P.b.loading(`${Object(w.b)("verbs.wait")}...`,0);try{const{data:i}=await e({variables:{data:{id:t}}}),{success:n,errors:s}=(null===i||void 0===i?void 0:i.consumerNotationDisableDestroy)||{};return n?(P.b.success("Inutiliza\xe7\xe3o exclu\xedda do sistema!"),{success:n}):(null===s||void 0===s||s.forEach((e=>P.b.error(e))),{success:n})}catch(i){return R.a.captureException(i),P.b.error("N\xe3o foi poss\xedvel excluir a inutiliza\xe7\xe3o. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(i),{success:!1}}finally{a()}},{loading:t}]};const _e=c.e`
  mutation UpdateNotationDisableStatus($data: FinanceConsumerNotationDisableUpdateStatusInput!) {
    consumerNotationDisableUpdateStatus(input: $data) {
      success errors status status_reason
    }
  }
`;var je=()=>{const[e,{loading:t}]=Object(z.a)(_e);return[async t=>{try{const{data:a}=await e({variables:{data:{id:t}}}),{success:i,errors:n}=(null===a||void 0===a?void 0:a.consumerNotationDisableUpdateStatus)||{};return i?(P.b.success("Inutiliza\xe7\xe3o de nota fiscal de consumidor atualizada!"),{success:i}):(null===n||void 0===n||n.forEach((e=>P.b.error(e))),{success:i})}catch(a){return R.a.captureException(a),P.b.error("N\xe3o foi poss\xedvel atualizar a inutiliza\xe7\xe3o da nota fiscal de consumidor. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(a),{success:!1}}},{loading:t}]};const me=c.e`
  query DownloadXmlNotation($id: ID!) {
    download_xml_notation(id: $id, notation_type: "nfc-e")
  }
`;var ve=()=>Object(G.a)(me,{fetchPolicy:"network-only",onCompleted:e=>{let{download_xml_notation:t}=e;const{xml:a,filename:i}=JSON.parse(t);try{const e=new Blob([a],{type:"text/xml"});Object(Q.saveAs)(e,i)}catch(n){R.a.captureException(n),P.b.error("N\xe3o foi poss\xedvel realizar o download do XML. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(n)}}});const Oe=e=>{const{notation_disable:t,refetch:a}=e,[n,s]=Object(i.useState)(!1),c=Object(L.a)((e=>e.current_user.permissions)),{status:o,id:r}=t,l=Object(i.useRef)(null),[d]=ve(),[u]=je(),[b]=be(),_=()=>{P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},m=Object(i.useCallback)((async()=>{if(!c.can_edit_invoice)return void _();s(!1);const{success:e}=await u(r);e&&(null===a||void 0===a||a())}),[r,c.can_edit_invoice,a,u]),v=Object(i.useCallback)((async()=>{if(!c.can_destroy_invoice)return void _();s(!1);const{success:e}=await b(r);e&&(null===a||void 0===a||a())}),[b,r,c.can_destroy_invoice,a]),O=Object(i.useCallback)((()=>{c.can_access_invoice?(s(!1),d({variables:{id:r}})):_()}),[d,r,c.can_access_invoice]),p=Object(i.useCallback)((()=>{var e;c.can_create_invoice?(s(!1),null===(e=l.current)||void 0===e||e.open()):_()}),[c.can_create_invoice]),h=U({status:o,handleUpdateStatus:m,handleDestroyRecord:v,openNotationDisable:p,handleDownloadXML:O});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(I.a,{open:n,onOpenChange:s,menu:{items:h},trigger:["click"],children:Object(g.jsx)(j.i,{children:Object(g.jsx)($.a,{})})}),Object(g.jsx)(de,{ref:l,afterSave:()=>null===a||void 0===a?void 0:a()})]})};var pe=Object(i.memo)(Oe),he=a(1421);var xe=e=>{let{refetch:t,openSaleDrawer:a,openPackageDrawer:n}=e;const s=Object(i.useCallback)(((e,t)=>{"Inventory::Sale"!==e?"Inventory::Package"!==e||n(t):a(t)}),[n,a]);return Object(i.useMemo)((()=>[{title:"Status",default_visible:!0,always_visible:!0,key:"status",dataIndex:"status",width:140,render:(e,t)=>{const a=t.status_reason;return Object(g.jsx)(_.a,{placement:"top",title:Object(O.a)({status:e,status_reason:a}),children:y(e)})}},{title:"Ambiente",default_visible:!0,always_visible:!0,key:"emission_environment",dataIndex:"emission_environment",width:110,render:(e,t)=>ne(e||t.environment)},{title:"Data",dataIndex:"created_at",key:"created_at",width:100,default_visible:!0,render:(e,t)=>fe(t)},{title:"Comanda/Pacote",key:"document_type",dataIndex:"document_type",default_visible:!0,render:(e,t)=>{if("FinanceConsumerNotationDisable"===t.__typename)return"";const a=`${"Inventory::Sale"===e?"C":"P"}#${t.document.code}`;return Object(g.jsx)(j.i,{onClick:()=>s(e,t.document_id),children:a})}},{title:"N\xfamero",key:"number",dataIndex:"number",width:90,default_visible:!0,render:(e,t)=>"FinanceConsumerNotationDisable"===t.__typename?`${t.initial_number} - ${t.final_number}`:e},{title:"Cliente",key:"customer_name",dataIndex:"customer_name",default_visible:!0,ellipsis:!0,render:(e,t)=>"FinanceConsumerNotationDisable"===t.__typename?`Inutiliza\xe7\xe3o da numera\xe7\xe3o ${t.initial_number} a ${t.final_number}`:e},{title:"Valor",dataIndex:"total_value",key:"total_value",align:"right",width:115,default_visible:!0,render:e=>e>0?Object(m.d)(e,{cents:!1}):""},{default_visible:!0,key:"actions",align:"center",width:70,render:(e,a)=>{if("FinanceConsumerNotationDisable"===a.__typename){const e={id:a.id,status:a.status,status_reason:a.status_reason,created_at:a.created_at,environment:a.environment,series:a.series,initial_number:a.initial_number,final_number:a.final_number,justification:a.justification};return Object(g.jsx)(pe,{notation_disable:e,refetch:t})}const i={id:a.id,status:a.status,status_reason:a.status_reason,created_at:a.created_at,document_id:a.document_id,emission_environment:a.emission_environment,document_type:a.document_type,pdf_file_link:a.pdf_file_link,xml_file_link:a.xml_file_link,customer_name:a.customer_name,number:a.number,finished:a.document.finished};return Object(g.jsx)(he.a,{has_product:!0,show_menu_icon:!0,can_issue:!0,sale_finished:i.finished,electronic_consumer_invoice:i,sale_id:i.document_id,type:i.document_type,refetch:t})}}]),[s,t])};const fe=e=>"FinanceConsumerNotationDisable"===(null===e||void 0===e?void 0:e.__typename)?f()(null===e||void 0===e?void 0:e.created_at).format("L"):f()(null===e||void 0===e?void 0:e.created_at,s.H).format("L");var ge=a(2975),ye=a(340),Ce=a(596),ke=a(800),we=a(801),Ie=a(405);const $e=c.e`
  query InvoiceViewDrawer ($id: ID) {
    invoice (id: $id) {
      id
      status
      created_at
      emission_date
      total_value
      client_sale_type
      client_sale_id
      client_name
      pdf_link
      xml_link
      client_sale {
        ... on Inventory_Sale {
          id
          code
          client {
            id
            name
            phone2
            avatar_url
          }
        }
      }
    }
  }
`;var Se=e=>Object(Ie.f)($e,{skip:!e,fetchPolicy:"no-cache",variables:{id:e},onError:e=>{R.a.captureException(e),console.log(e)}}),Ne=a(339),De=a(159),Ee=a(2856),Fe=a(600);const ze=e=>{const{status:t,pdf_link:a,xml_link:n,movement_type:s,movement_id:c,handleUpdateInvoice:o,handleCancelInvoice:r}=e,l=Object(L.a)((e=>e.current_user.permissions)),d=Object(i.useRef)(null),_=Object(i.useRef)(null),{t:m}=Object(ye.c)(),v=Object(i.useCallback)((e=>{var t;l.can_edit_sale?null===(t=d.current)||void 0===t||t.open({sale_id:e}):P.b.warning(m("phrases.no_permission_to_do_this"))}),[l.can_edit_sale,m]),O=Object(i.useCallback)((e=>{var t;l.can_edit_package?null===(t=_.current)||void 0===t||t.open(e):P.b.warning(m("phrases.no_permission_to_do_this"))}),[l.can_edit_package,m]),p=Object(i.useCallback)(((e,t)=>{"Inventory::Sale"!==e?"Inventory::Package"!==e||O(t):v(t)}),[O,v]),h=Object(i.useMemo)((()=>{let e=[{key:"origin",onClick:()=>p(s,c),label:Object(g.jsx)(j.h,{$size:16,children:"Acessar a origem"})}];return a&&n&&e.push({key:"pdf",onClick:()=>Object(Fe.a)(a),label:Object(g.jsx)(j.h,{$size:16,children:"Baixar PDF"})},{key:"xml",onClick:()=>Object(Fe.a)(n),label:Object(g.jsx)(j.h,{$size:16,children:"Baixar XML"})}),"issued"===t&&e.push({key:"cancel",onClick:()=>{l.can_destroy_invoice?r():P.b.warning(m("phrases.no_permission_to_do_this"))},label:Object(g.jsx)(j.h,{$size:16,children:"Cancelar nota"})}),e}),[r,c,s,p,a,l.can_destroy_invoice,t,m,n]);return Object(g.jsxs)(Re,{children:[Object(g.jsx)(De.a,{block:!0,type:"primary",size:"large",onClick:()=>{l.can_edit_invoice?o():P.b.warning(m("phrases.no_permission_to_do_this"))},children:Object(g.jsx)(j.h,{$semibold:!0,children:"Atualizar Status"})}),Object(g.jsx)(I.a,{menu:{items:h},trigger:["click"],placement:"bottom",children:Object(g.jsx)(De.a,{block:!0,size:"large",children:Object(g.jsxs)(j.h,{$semibold:!0,children:["Outras op\xe7\xf5es ",Object(g.jsx)(Ee.a,{})]})})}),Object(g.jsx)(u.a,{ref:d}),Object(g.jsx)(b.a,{ref:_})]})};ze.displayName="Footer";var Pe=Object(i.memo)(ze);const Re=h.d.div.withConfig({componentId:"wb__sc-1rfikpa-0"})(["display:flex;.ant-btn + .ant-btn{margin-left:8px;}"]),Me=(e,t)=>{const[a,n]=Object(i.useState)(!1),[c,o]=Object(i.useState)(),r=Object(L.a)((e=>e.current_user.permissions)),l=Object(i.useRef)(null),[d]=Object(ke.a)(),[u]=Object(we.a)(),{t:b}=Object(ye.c)(),{data:_,loading:v,refetch:O}=Se(c),p=null===_||void 0===_?void 0:_.invoice,h=null===_||void 0===_?void 0:_.invoice.client_sale.client,x=Object(i.useCallback)((e=>{o(e),n(!0)}),[]),y=Object(i.useCallback)((()=>{n(!1)}),[]),C=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await d(e);t&&(null===O||void 0===O||O())}),[O,d]),k=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await u(e);t&&(null===O||void 0===O||O())}),[u,O]);Object(i.useImperativeHandle)(t,(()=>({open:x,close:y})));const w="Inventory::Sale"===(null===p||void 0===p?void 0:p.client_sale_type)?"Comanda":"Pacote";return Object(g.jsxs)(j.a,{open:a,onClose:y,width:"100%",placement:"bottom",height:"100%",title:"Dados da NFS-e",destroyOnClose:!0,push:!1,footer:Object(g.jsx)(Pe,{status:null===p||void 0===p?void 0:p.status,pdf_link:null===p||void 0===p?void 0:p.pdf_link,xml_link:null===p||void 0===p?void 0:p.xml_link,movement_id:null===p||void 0===p?void 0:p.client_sale_id,movement_type:null===p||void 0===p?void 0:p.client_sale_type,handleUpdateInvoice:()=>C(c),handleCancelInvoice:()=>k(c)}),children:[Object(g.jsx)(Ne.a,{loading:v}),Object(g.jsxs)(j.g,{$column:!0,children:[(null===p||void 0===p?void 0:p.status)&&Ae(p.status),Object(g.jsx)(j.h,{$bold:!0,$top:20,children:"Informa\xe7\xf5es"}),Object(g.jsxs)(j.g,{$alignCenter:!0,onClick:()=>{var e;r.can_edit_client?null===(e=l.current)||void 0===e||e.open({id:null===h||void 0===h?void 0:h.id,initial_active_bar:"panel"}):P.b.warning(b("phrases.no_permission_to_do_this"))},$bottom:20,children:[Object(g.jsx)(ge.a,{size:70,src:null===h||void 0===h?void 0:h.avatar_url,shape:"circle"}),Object(g.jsxs)(j.g,{$left:10,$column:!0,children:[Object(g.jsx)(j.h,{$link:!0,$textEllipsis:!0,children:null===h||void 0===h?void 0:h.name}),Object(g.jsx)(j.h,{$color:"gray_1",children:null===h||void 0===h?void 0:h.phone2})]})]}),Object(g.jsxs)(S.a,{layout:"vertical",children:[Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Data de emiss\xe3o",children:Object(g.jsx)(E.a,{disabled:!0,value:f()(null===p||void 0===p?void 0:p.emission_date,s.H).format("L, HH:mm[h][h]")})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Origem",children:Object(g.jsx)(E.a,{disabled:!0,value:`${w} n\xfamero #${null===p||void 0===p?void 0:p.client_sale.code}`})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Valor da nota",children:Object(g.jsx)(E.a,{disabled:!0,value:Object(m.d)(null===p||void 0===p?void 0:p.total_value,{cents:!1})})})})]})]}),Object(g.jsx)(Ce.a,{ref:l,onSave:()=>O()})]})};Me.displayName="InvoiceViewDrawer";var qe=Object(i.memo)(Object(i.forwardRef)(Me));const Le=Object(h.d)(v.a).withConfig({componentId:"wb__sc-smfbv3-0"})(["margin-right:0 !important;text-align:center;font-size:16rem !important;"]),Ae=e=>({pending:Object(g.jsx)(Le,{color:"#1194f6",children:"Pendente"}),issued:Object(g.jsx)(Le,{color:"#4eb660",children:"Emitida"}),canceled:Object(g.jsx)(Le,{color:"#faa84f",children:"Cancelada"}),denied:Object(g.jsx)(Le,{color:"#e44e4d",children:"Negada"}),cancel_denied:Object(g.jsx)(Le,{color:"#e44e4d",children:"Cancelamento negado"}),Erro:Object(g.jsx)(Le,{color:"#e44e4d",children:"Erro"}),AutorizacaoSolicitada:Object(g.jsx)(Le,{color:"#1194f6",children:"Pendente"}),Negada:Object(g.jsx)(Le,{color:"#e44e4d",children:"Inutiliza\xe7\xe3o negada"}),Autorizada:Object(g.jsx)(Le,{color:"#7e57c6",children:"Inutilizada"})}[e]||Object(g.jsx)(Le,{color:"#1194f6",children:"Pendente"}));var He=a(802),Ve=a(803);const Be=c.e`
  query ConsumerInvoiceViewDrawer ($id: ID) {
    electronic_consumer_invoice (id: $id) {
      id
      status
      created_at
      emission_environment
      number
      total_value
      document_type
      document_id
      customer_name
      pdf_file_link
      xml_file_link
      document {
        ... on Inventory_Sale {
          id
          code
          client {
            id
            name
            phone2
            avatar_url
          }
        }
      }
    }
  }
`;var Te=e=>Object(Ie.f)(Be,{skip:!e,fetchPolicy:"no-cache",variables:{id:e},onError:e=>{R.a.captureException(e),console.log(e)}}),Xe=a(591),Ue=a(117);const Ye=(e,t)=>{const[a,n]=Object(i.useState)(!1),[c,o]=Object(i.useState)(),r=Object(L.a)((e=>e.current_user.permissions)),l=Object(i.useRef)(null),[d]=Object(He.a)(),[u]=Object(Ve.a)(),{t:b}=Object(ye.c)(),{data:_,loading:v,refetch:O}=Te(c),p=null===_||void 0===_?void 0:_.electronic_consumer_invoice,h=null===_||void 0===_?void 0:_.electronic_consumer_invoice.document.client,x=Object(i.useCallback)((e=>{o(e),n(!0)}),[]),y=Object(i.useCallback)((()=>{n(!1)}),[]),C=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await d(e);t&&(null===O||void 0===O||O())}),[O,d]),k=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await u(e);t&&(null===O||void 0===O||O())}),[u,O]);Object(i.useImperativeHandle)(t,(()=>({open:x,close:y})));const w="Inventory::Sale"===(null===p||void 0===p?void 0:p.document_type)?"Comanda":"Pacote";return Object(g.jsxs)(j.a,{open:a,onClose:y,width:"100%",placement:"bottom",height:"100%",title:"Dados da NFC-e",destroyOnClose:!0,push:!1,footer:Object(g.jsx)(Pe,{status:null===p||void 0===p?void 0:p.status,pdf_link:null===p||void 0===p?void 0:p.pdf_file_link,xml_link:null===p||void 0===p?void 0:p.xml_file_link,movement_id:null===p||void 0===p?void 0:p.document_id,movement_type:null===p||void 0===p?void 0:p.document_type,handleUpdateInvoice:()=>C(c),handleCancelInvoice:()=>k(c)}),children:[Object(g.jsx)(Ne.a,{loading:v}),Object(g.jsxs)(j.g,{$column:!0,children:[(null===p||void 0===p?void 0:p.status)&&Ae(p.status),Object(g.jsx)(j.h,{$bold:!0,$top:20,children:"Informa\xe7\xf5es"}),Object(g.jsxs)(j.g,{$alignCenter:!0,onClick:()=>{var e;r.can_edit_client?null===(e=l.current)||void 0===e||e.open({id:null===h||void 0===h?void 0:h.id,initial_active_bar:"panel"}):P.b.warning(b("phrases.no_permission_to_do_this"))},$bottom:20,children:[Object(g.jsx)(ge.a,{size:70,src:null===h||void 0===h?void 0:h.avatar_url,shape:"circle"}),Object(g.jsxs)(j.g,{$left:10,$column:!0,children:[Object(g.jsx)(j.h,{$link:!0,$textEllipsis:!0,children:null===h||void 0===h?void 0:h.name}),Object(g.jsx)(j.h,{$color:"gray_1",children:null!==h&&void 0!==h&&h.phone2?Object(g.jsx)(Xe.a,{inputStyle:{color:Ue.a.gray_1},hide_input_styles:!0,disabled:!0,value:h.phone2},h.phone2):b("phrases.without_phone")})]})]}),Object(g.jsxs)(S.a,{layout:"vertical",children:[Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"N\xfamero da nota",children:Object(g.jsx)(E.a,{disabled:!0,value:null===p||void 0===p?void 0:p.number})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Data de emiss\xe3o",children:Object(g.jsx)(E.a,{disabled:!0,value:f()(null===p||void 0===p?void 0:p.created_at,s.H).format("L, HH:mm[h][h]")})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Origem",children:Object(g.jsx)(E.a,{disabled:!0,value:`${w} n\xfamero #${null===p||void 0===p?void 0:p.document.code}`})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Valor da nota",children:Object(g.jsx)(E.a,{disabled:!0,value:Object(m.d)(null===p||void 0===p?void 0:p.total_value,{cents:!1})})})}),(null===p||void 0===p?void 0:p.emission_environment)&&Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Ambiente de emiss\xe3o",children:ne(p.emission_environment)})})]})]}),Object(g.jsx)(Ce.a,{ref:l,onSave:()=>O()})]})};Ye.displayName="ConsumerInvoiceViewDrawer";var Je=Object(i.memo)(Object(i.forwardRef)(Ye)),We=a(703),Ke=a(629),Ge=a(2236),Qe=a.n(Ge),Ze=a(2237),et=a.n(Ze);const tt=c.e`
  query DownloadXmlInvoice($start_date: String!, $end_date: String!, $invoice_type: String!, $date_type: String) {
    download_xml_invoice(
      start_date: $start_date,
      end_date: $end_date,
      invoice_type: $invoice_type,
      date_type: $date_type,
    )
  }
`;var at=()=>Object(G.a)(tt,{fetchPolicy:"network-only",onCompleted:e=>{let{download_xml_invoice:t}=e;const{files:a={},filename:i}=JSON.parse(t);if(0!==a.length)try{it(a,i)}catch(n){R.a.captureException(n),P.b.error("N\xe3o foi poss\xedvel realizar o download dos XMLs. Atualize a p\xe1gina e tente novamente. Se o erro persistir entre em contato."),console.error(n)}else P.b.info("Nenhum XML encontrado neste per\xedodo")}});const it=async(e,t)=>{const a=new et.a,i=P.b.loading("Baixando...",0);for(let s=0;s<e.length;s+=30){const t=e.slice(s,s+30).map((async e=>new Promise((async(t,i)=>{try{const i=await Qe.a.getBinaryContent(e.url);a.file(e.filename,i,{binary:!0}),t(!0)}catch(n){console.log(`Erro ao carregar o arquivo ${e.filename}:`,n),i(n)}}))));await Promise.all(t)}const n=await a.generateAsync({type:"blob"});Object(Q.saveAs)(n,t),i()},nt=(e,t)=>{const{title:a,storage_key:n}=e,[s,c]=Object(i.useState)(!1),o=Object(L.a)((e=>e.is_mobile)),[r]=S.a.useForm(),{setFieldsValue:l,submit:d,resetFields:u}=r,[b,{loading:_}]=at(),m=Object(i.useCallback)((()=>{l({dates:[f()(),f()()],date_type:"invoice_date"}),c(!0)}),[l]),v=Object(i.useCallback)((()=>{c(!1)}),[]);Object(i.useImperativeHandle)(t,(()=>({open:m,close:v})));const O=Object(i.useCallback)((e=>{e||u()}),[u]);return Object(g.jsx)(j.a,{open:s,title:`Download XML ${a}`,placement:o?"bottom":"right",height:"100%",onClose:v,width:600,closable:!0,styles:{body:{padding:15}},destroyOnClose:!0,afterOpenChange:O,footer:Object(g.jsx)(A.a,{loading:_,submit:d,close:v,save_text:"Baixar"}),push:!1,children:Object(g.jsxs)(S.a,{form:r,layout:"vertical",onFinish:e=>{const t=e.dates[0].format("YYYY-MM-DD"),a=e.dates[1].format("YYYY-MM-DD");b({variables:{start_date:t,end_date:a,invoice_type:n,date_type:e.date_type}}),v()},children:[Object(g.jsx)(S.a.Item,{name:"dates",label:"Per\xedodo",children:Object(g.jsx)(We.a,{})}),Object(g.jsx)(S.a.Item,{name:"date_type",label:"Por data de:",hidden:"invoice"!==n,children:Object(g.jsx)(Ke.b,{size:o?"large":"middle",options:[{value:"invoice_date",label:"Cria\xe7\xe3o da nota"},{value:"sale_date",label:"Comanda ou Pacote"}],allowClear:!1})})]})})};nt.displayName="DownloadXMLDrawer";var st=Object(i.forwardRef)(nt);const ct=[{value:"0",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#1194f6",children:"Pendente"})},{value:"1",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#4eb660",children:"Emitida"})},{value:"2",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#faa84f",children:"Cancelada"})},{value:"3",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Negada"})},{value:"4",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Cancelamento negado"})}];var ot=()=>Object(i.useMemo)((()=>[{label:"Status",name:"status",checkbox_options:ct,checkbox_disabled:!0},{label:"Per\xedodo",name:"emission_date",rangepicker:{start_date_name:"start_date",end_date_name:"end_date"}}]),[]),rt=a(583);const lt=e=>{const{item:t}=e;return Object(g.jsxs)(j.g,{$column:!0,children:[Object(g.jsxs)(j.g,{justify:"space-between",children:[Object(g.jsx)(rt.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:22,children:"FinanceConsumerNotationDisable"===(null===t||void 0===t?void 0:t.__typename)?`Inutiliza\xe7\xe3o da numera\xe7\xe3o ${t.initial_number} \xe0 ${t.final_number}`:`N\xb0 ${null===t||void 0===t?void 0:t.number} - ${null===t||void 0===t?void 0:t.customer_name}`}),Object(g.jsx)(rt.b,{width:6,$align:"right",$block:!0,$semibold:!0,children:((null===t||void 0===t?void 0:t.total_value)||0)>0?Object(m.d)(null===t||void 0===t?void 0:t.total_value,{cents:!1}):""})]}),Object(g.jsxs)(j.g,{$top:5,justify:"space-between",children:[Object(g.jsxs)(rt.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[ut(t)," ",fe(t)]}),t&&y(null===t||void 0===t?void 0:t.status)]})]})};lt.displayName="ElectronicConsumerInvoiceItemMobile";var dt=Object(i.memo)(lt);const ut=e=>"FinanceConsumerNotationDisable"===(null===e||void 0===e?void 0:e.__typename)?"":`${"Inventory::Sale"===(null===e||void 0===e?void 0:e.document_type)?"C":"P"}#${null===e||void 0===e?void 0:e.document.code} -`;var bt=a(593),_t=a(598),jt=a(597),mt=a(1444),vt=a(2855),Ot=a(687);var pt=()=>{const[e,t]=Object(i.useState)(!1),a=Object(_t.b)((e=>e.filters)),n=Object(_t.b)((e=>e.title)),s=Object(_t.b)((e=>e.storage_key)),c=Object(_t.b)((e=>e.permissions)),o=Object(_t.b)((e=>e.show_filters)),r=Object(_t.b)((e=>e.search_placeholder)),l=Object(_t.b)((e=>e.dispatch)),d=Object(_t.b)((e=>e.onSearch)),u=Object(_t.b)((e=>e.refetch)),b=Object(i.useRef)(null),_=Object(i.useRef)(null),j=Object(i.useRef)(null),m=Object(i.useCallback)((()=>{var e;null===(e=b.current)||void 0===e||e.open()}),[]),v=()=>{u()},O=Object(i.useCallback)((()=>{var e,t;"electronic_invoice"===s&&(null===(e=_.current)||void 0===e||e.open());"electronic_consumer_invoice"===s&&(null===(t=j.current)||void 0===t||t.open())}),[s]);return Object(g.jsxs)(g.Fragment,{children:[e&&Object(g.jsx)(jt.a,{autoFocus:!0,width:350,allowClear:!0,placeholder:r,onSearch:e=>d(e),onChange:e=>{let{target:{value:t}}=e;0===t.length&&d("")}}),!e&&!!r&&Object(g.jsx)(De.a,{icon:Object(g.jsx)(mt.a,{}),onClick:()=>{null!==c&&void 0!==c&&c.can_access?t(!0):P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},children:"Buscar"}),!!a&&Object(g.jsx)(De.a,{className:o?"ant-btn-gold":void 0,type:o?"primary":"default",onClick:()=>{null!==c&&void 0!==c&&c.can_access?l({type:"set_show_filters",payload:!o}):P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},icon:o?Object(g.jsx)(vt.a,{}):Object(g.jsx)(Ot.a,{}),children:Object(w.b)("verbs.filter")}),!!s&&Object(g.jsx)(De.a,{type:"primary",onClick:()=>{null!==c&&void 0!==c&&c.can_access?m():P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},children:"Baixar XML"}),("electronic_invoice"===s||"electronic_consumer_invoice"===s)&&Object(g.jsx)(De.a,{type:"primary",onClick:()=>{null!==c&&void 0!==c&&c.can_create?O():P.b.warning(Object(w.b)("phrases.no_permission_to_do_this"))},children:"Inutilizar"}),Object(g.jsx)(st,{ref:b,title:n,storage_key:s}),Object(g.jsx)(V,{ref:_,afterSave:v}),Object(g.jsx)(de,{ref:j,afterSave:v})]})},ht=a(342);var xt=e=>{let{title:t}=e;const a=Object(_t.b)((e=>e.onSearch)),i=Object(_t.b)((e=>e.title));return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(jt.b,{title:t||i,onSearch:a,tabs:[{label:"NFS-e",path:"/invoices/invoice"},{label:"NF-e",path:"/invoices/electronic_invoice"},{label:"NFC-e",path:"/invoices/electronic_consumer_invoice"},{label:Object(w.b)("words.setting_other"),path:"/invoices/settings",is_new:!Object(ht.b)({date:"2025/12/10"})}],children:Object(g.jsx)(pt,{})})})};var ft=()=>{Object(bt.a)({addon_keys:["has_nfce"],search:s.a.ID_NEW_ELECTRONIC_CONSUMER_INVOICE});const e=Object(L.a)((e=>e.current_user.addons.has_nfce)),t=Object(L.a)((e=>e.current_user.permissions)),a=Object(i.useRef)(null),n=Object(i.useRef)(null),c=Object(i.useRef)(null),_=Object(i.useRef)(null),j=Object(i.useRef)(null),m=Object(i.useRef)(null),v=Object(i.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.refetch()}),[]),O=Object(i.useCallback)((e=>{var t;"FinanceConsumerNotationDisable"!==(null===e||void 0===e?void 0:e.__typename)&&(null===(t=n.current)||void 0===t||t.open(null===e||void 0===e?void 0:e.id))}),[]),p=Object(i.useCallback)((e=>{var t;null===(t=m.current)||void 0===t||t.open({sale_id:e})}),[]),h=Object(i.useCallback)((e=>{var t;null===(t=j.current)||void 0===t||t.open(e)}),[]),x=xe({refetch:v,openSaleDrawer:p,openPackageDrawer:h}),y=ot(),C=Object(i.useCallback)((()=>!0),[]),k=Object(i.useCallback)((e=>{var t;return[...(null===e||void 0===e||null===(t=e.all_electronic_consumer_invoices)||void 0===t?void 0:t.all)||[],...(null===e||void 0===e?void 0:e.current_salon.finance_consumer_notation_disables)||[]].sort(((e,t)=>f()(t.created_at).unix()-f()(e.created_at).unix()))}),[]),w=Object(i.useCallback)((e=>{var t,a;return((null===e||void 0===e||null===(t=e.all_electronic_consumer_invoices)||void 0===t?void 0:t.total_count)||0)+((null===e||void 0===e||null===(a=e.current_salon)||void 0===a?void 0:a.finance_consumer_notation_disables.length)||0)}),[]),I=Object(i.useMemo)((()=>[{label:"Inutilizar",icon:r.a,onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.open()}},{label:"Baixar XML",icon:l.a,onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.open()}}]),[]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(d.a,{ref:a,Header:xt,title:"Nota fiscal de consumidor",storage_key:"electronic_consumer_invoice",search_placeholder:"Procure pelo nome do cliente...",filters:y,has_feature:e,addon_id:s.a.ID_NEW_ELECTRONIC_CONSUMER_INVOICE,permissions:{can_create:t.can_create_invoice,can_edit:t.can_edit_invoice,can_access:t.can_access_invoice},openDrawer:O,columns:x,validateRow:C,extra_actions:I,show_create_button:!1,item_selectable:!1,query:o,getData:k,MobileItem:dt,getTotalCount:w}),Object(g.jsx)(u.a,{ref:m}),Object(g.jsx)(b.a,{ref:j}),Object(g.jsx)(Je,{ref:n}),Object(g.jsx)(de,{ref:c,afterSave:v}),Object(g.jsx)(st,{ref:_,title:"Nota fiscal de consumidor",storage_key:"electronic_consumer_invoice"})]})};const gt=c.e`
  query ElectronicInvoiceList(
    $page: Int, $results: Int, $search_query: String, $start_date: String, $end_date: String, $status: [ID]
  ) {
    all_electronic_invoices (
      sort_order: "DESC",
      sort_field: "id",
      page: $page,
      results: $results,
      search_term: $search_query,
      start_date: $start_date,
      end_date: $end_date,
      status: $status,
    ) {
      total_count
      all {
        id
        document_id
        emission_environment
        document_type
        status
        status_reason
        pdf_file_link
        xml_file_link
        created_at
        total_value
        customer_name
        number
        document {
          ... on Inventory_Sale {
            id
            code
            finished
          }
        }
      }
    }

    current_salon {
      id
      finance_invoice_notation_disables {
        id
        created_at
        status
        status_reason
        environment
        series
        initial_number
        final_number
        justification
      }
    }
  }
`;var yt=a(804),Ct=a(805);const kt=c.e`
  query ElectronicInvoiceViewDrawer ($id: ID) {
    electronic_invoice (id: $id) {
      id
      status
      created_at
      emission_environment
      number
      total_value
      document_type
      document_id
      customer_name
      pdf_file_link
      xml_file_link
      document {
        ... on Inventory_Sale {
          id
          code
          client {
            id
            name
            phone2
            avatar_url
          }
        }
      }
    }
  }
`;var wt=e=>Object(Ie.f)(kt,{skip:!e,fetchPolicy:"no-cache",variables:{id:e},onError:e=>{R.a.captureException(e),console.log(e)}});const It=(e,t)=>{const[a,n]=Object(i.useState)(!1),[c,o]=Object(i.useState)(),r=Object(L.a)((e=>e.current_user.permissions)),l=Object(i.useRef)(null),[d]=Object(yt.a)(),[u]=Object(Ct.a)(),{t:b}=Object(ye.c)(),{data:_,loading:v,refetch:O}=wt(c),p=null===_||void 0===_?void 0:_.electronic_invoice,h=null===_||void 0===_?void 0:_.electronic_invoice.document.client,x=Object(i.useCallback)((e=>{o(e),n(!0)}),[]),y=Object(i.useCallback)((()=>{n(!1)}),[]),C=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await d(e);t&&(null===O||void 0===O||O())}),[O,d]),k=Object(i.useCallback)((async e=>{if(!e)return;const{success:t}=await u(e);t&&(null===O||void 0===O||O())}),[u,O]);Object(i.useImperativeHandle)(t,(()=>({open:x,close:y})));const w="Inventory::Sale"===(null===p||void 0===p?void 0:p.document_type)?"Comanda":"Pacote";return Object(g.jsxs)(j.a,{open:a,onClose:y,width:"100%",placement:"bottom",height:"100%",title:"Dados da NF-e",destroyOnClose:!0,push:!1,footer:Object(g.jsx)(Pe,{status:null===p||void 0===p?void 0:p.status,pdf_link:null===p||void 0===p?void 0:p.pdf_file_link,xml_link:null===p||void 0===p?void 0:p.xml_file_link,movement_id:null===p||void 0===p?void 0:p.document_id,movement_type:null===p||void 0===p?void 0:p.document_type,handleUpdateInvoice:()=>C(c),handleCancelInvoice:()=>k(c)}),children:[Object(g.jsx)(Ne.a,{loading:v}),Object(g.jsxs)(j.g,{$column:!0,children:[(null===p||void 0===p?void 0:p.status)&&Ae(p.status),Object(g.jsx)(j.h,{$bold:!0,$top:20,children:"Informa\xe7\xf5es"}),Object(g.jsxs)(j.g,{$alignCenter:!0,onClick:()=>{var e;r.can_edit_client?null===(e=l.current)||void 0===e||e.open({id:null===h||void 0===h?void 0:h.id,initial_active_bar:"panel"}):P.b.warning(b("phrases.no_permission_to_do_this"))},$bottom:20,children:[Object(g.jsx)(ge.a,{size:70,src:null===h||void 0===h?void 0:h.avatar_url,shape:"circle"}),Object(g.jsxs)(j.g,{$left:10,$column:!0,children:[Object(g.jsx)(j.h,{$link:!0,$textEllipsis:!0,children:null===h||void 0===h?void 0:h.name}),Object(g.jsx)(j.h,{$color:"gray_1",children:null===h||void 0===h?void 0:h.phone2})]})]}),Object(g.jsxs)(S.a,{layout:"vertical",children:[Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"N\xfamero da nota",children:Object(g.jsx)(E.a,{size:"large",disabled:!0,value:null===p||void 0===p?void 0:p.number})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Data de emiss\xe3o",children:Object(g.jsx)(E.a,{disabled:!0,size:"large",value:f()(null===p||void 0===p?void 0:p.created_at,s.H).format("L, HH:mm[h][h]")})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Origem",children:Object(g.jsx)(E.a,{size:"large",disabled:!0,value:`${w} n\xfamero #${null===p||void 0===p?void 0:p.document.code}`})})}),Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Valor da nota",children:Object(g.jsx)(E.a,{disabled:!0,value:Object(m.d)(null===p||void 0===p?void 0:p.total_value,{cents:!1})})})}),(null===p||void 0===p?void 0:p.emission_environment)&&Object(g.jsx)(N.a,{children:Object(g.jsx)(S.a.Item,{label:"Ambiente de emiss\xe3o",children:ne(p.emission_environment)})})]})]}),Object(g.jsx)(Ce.a,{ref:l,onSave:O})]})};It.displayName="ElectronicInvoiceViewDrawer";var $t=Object(i.memo)(Object(i.forwardRef)(It));const St=e=>{const{item:t}=e;return Object(g.jsxs)(j.g,{$column:!0,children:[Object(g.jsxs)(j.g,{justify:"space-between",children:[Object(g.jsx)(rt.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:22,children:"Finance_InvoiceNotationDisable"===(null===t||void 0===t?void 0:t.__typename)?`Inutiliza\xe7\xe3o da numera\xe7\xe3o ${t.initial_number} \xe0 ${t.final_number}`:`N\xb0 ${null===t||void 0===t?void 0:t.number} - ${null===t||void 0===t?void 0:t.customer_name}`}),Object(g.jsx)(rt.b,{width:6,$align:"right",$block:!0,$semibold:!0,children:((null===t||void 0===t?void 0:t.total_value)||0)>0?Object(m.d)(null===t||void 0===t?void 0:t.total_value,{cents:!1}):""})]}),Object(g.jsxs)(j.g,{$top:5,justify:"space-between",children:[Object(g.jsxs)(rt.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[Dt(t)," ",ce(t)]}),t&&y(null===t||void 0===t?void 0:t.status)]})]})};St.displayName="ElectronicInvoiceItemMobile";var Nt=Object(i.memo)(St);const Dt=e=>"Finance_InvoiceNotationDisable"===(null===e||void 0===e?void 0:e.__typename)?"":`${"Inventory::Sale"===(null===e||void 0===e?void 0:e.document_type)?"C":"P"}#${null===e||void 0===e?void 0:e.document.code} -`,Et=[{value:"0",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#1194f6",children:"Pendente"})},{value:"1",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#4eb660",children:"Emitida"})},{value:"2",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#faa84f",children:"Cancelada"})},{value:"3",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Negada"})},{value:"4",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Cancelamento negado"})}];var Ft=()=>Object(i.useMemo)((()=>[{label:"Status",name:"status",checkbox_options:Et,checkbox_disabled:!0},{label:"Per\xedodo",name:"emission_date",rangepicker:{start_date_name:"start_date",end_date_name:"end_date"}}]),[]);var zt=()=>{Object(bt.a)({addon_keys:["has_nfe"],search:s.a.ID_NEW_ELECTRONIC_INVOICE});const e=Object(L.a)((e=>e.current_user.addons.has_nfe)),t=Object(L.a)((e=>e.current_user.permissions)),a=Object(i.useRef)(null),n=Object(i.useRef)(null),c=Object(i.useRef)(null),o=Object(i.useRef)(null),_=Object(i.useRef)(null),j=Object(i.useRef)(null),m=Object(i.useCallback)((()=>{var e;null===(e=c.current)||void 0===e||e.refetch()}),[]),v=Object(i.useCallback)((e=>{var t;"Finance_InvoiceNotationDisable"!==(null===e||void 0===e?void 0:e.__typename)&&(null===(t=a.current)||void 0===t||t.open(null===e||void 0===e?void 0:e.id))}),[]),O=Object(i.useCallback)((e=>{var t;null===(t=j.current)||void 0===t||t.open({sale_id:e})}),[]),p=Object(i.useCallback)((e=>{var t;null===(t=_.current)||void 0===t||t.open(e)}),[]),h=se({refetch:m,openSaleDrawer:O,openPackageDrawer:p}),x=Ft(),y=Object(i.useCallback)((()=>!0),[]),C=Object(i.useCallback)((e=>{var t;return[...(null===e||void 0===e||null===(t=e.all_electronic_invoices)||void 0===t?void 0:t.all)||[],...(null===e||void 0===e?void 0:e.current_salon.finance_invoice_notation_disables)||[]].sort(((e,t)=>f()(t.created_at).unix()-f()(e.created_at).unix()))}),[]),k=Object(i.useCallback)((e=>{var t,a;return((null===e||void 0===e||null===(t=e.all_electronic_invoices)||void 0===t?void 0:t.total_count)||0)+((null===e||void 0===e||null===(a=e.current_salon)||void 0===a?void 0:a.finance_invoice_notation_disables.length)||0)}),[]),w=Object(i.useMemo)((()=>[{label:"Inutilizar",icon:r.a,onClick:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.open()}},{label:"Baixar XML",icon:l.a,onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.open()}}]),[]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(d.a,{ref:c,Header:xt,title:"Nota fiscal de produto",storage_key:"electronic_invoice",search_placeholder:"Procure pelo nome do cliente...",filters:x,has_feature:e,addon_id:s.a.ID_NEW_ELECTRONIC_INVOICE,permissions:{can_create:t.can_create_invoice,can_edit:t.can_edit_invoice,can_access:t.can_access_invoice},openDrawer:v,columns:h,validateRow:y,extra_actions:w,show_create_button:!1,item_selectable:!1,query:gt,getData:C,MobileItem:Nt,getTotalCount:k}),Object(g.jsx)(u.a,{ref:j}),Object(g.jsx)(b.a,{ref:_}),Object(g.jsx)($t,{ref:a}),Object(g.jsx)(V,{ref:n,afterSave:m}),Object(g.jsx)(st,{ref:o,title:"Nota fiscal de produto",storage_key:"electronic_invoice"})]})},Pt=a(585),Rt=a(3023),Mt=a(3066),qt=a(349),Lt=a(999),At=a(2884);const Ht=c.e`
  mutation SaveTaxpayerSecurityCodeMutation($data: SaveTaxpayerSecurityCodeInput!) {
    saveTaxpayerSecurityCode(input: $data) {
      success
      errors
    }
  }
`;var Vt=()=>{const[e,{loading:t}]=Object(z.a)(Ht);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:i=!1,errors:n}=(null===a||void 0===a?void 0:a.saveTaxpayerSecurityCode)||{};return null===n||void 0===n||n.map((e=>P.b.error(e))),{success:i}}catch(a){return R.a.captureException(a),P.b.error(Object(w.b)("phrases.generic_save_error_message")),console.error(a),{success:!1}}},t]};const Bt=(e,t)=>{const[a,n]=Object(i.useState)(!1),[s]=S.a.useForm(),[c,o]=Vt(),r=()=>{n(!0)},l=()=>{n(!1)};Object(i.useImperativeHandle)(t,(()=>({close:l,open:r})));const d=Object(i.useCallback)((async e=>{const{success:t}=await c(e);t&&At.a.success(Object(w.b)("phrases.update_successfully",{prefix:"CSC"})),l()}),[c]),u=Object(i.useCallback)((e=>{e||s.resetFields()}),[s]);return Object(g.jsx)(j.a,{open:a,title:"Enviar CSC",onClose:l,closable:!0,width:600,height:"100%",afterOpenChange:u,footer:Object(g.jsx)(A.a,{submit:s.submit,loading:o,close:l}),children:Object(g.jsxs)(S.a,{form:s,layout:"vertical",onFinish:d,children:[Object(g.jsx)(S.a.Item,{name:"csc_production",label:"CSC Produ\xe7\xe3o",rules:[{required:!0,message:Object(w.b)("phrases.required_field")}],children:Object(g.jsx)(E.a,{placeholder:Object(w.b)("words.password")})}),Object(g.jsx)(S.a.Item,{name:"csc_homologation",label:"CSC Homologa\xe7\xe3o",rules:[{required:!0,message:Object(w.b)("phrases.required_field")}],children:Object(g.jsx)(E.a,{placeholder:Object(w.b)("words.password")})})]})})};Bt.displayName="TaxpayerSecurityCodeDrawer";var Tt=Object(i.forwardRef)(Bt);const Xt=c.e`
  mutation SaveDigitalCertificateMutation($data: SaveDigitalCertificateInput!) {
    saveDigitalCertificate(input: $data) {
      success
      errors
    }
  }
`;var Ut=()=>{const[e,{loading:t}]=Object(z.a)(Xt);return[async t=>{try{const{data:a}=await e({variables:{data:t}}),{success:i=!1,errors:n}=(null===a||void 0===a?void 0:a.saveDigitalCertificate)||{};return null===n||void 0===n||n.map((e=>P.b.error(e))),{success:i}}catch(a){return R.a.captureException(a),P.b.error(Object(w.b)("phrases.generic_save_error_message")),console.error(a),{success:!1}}},t]};const Yt=(e,t)=>{const[a,n]=Object(i.useState)(!1),[s,c]=Object(i.useState)(),o=Object(i.useRef)(null),[r]=S.a.useForm(),[l,d]=Ut(),u=()=>{n(!0)},b=()=>{n(!1)};Object(i.useImperativeHandle)(t,(()=>({close:b,open:u})));const _=Object(i.useCallback)((async()=>{var e;const t=null===(e=o.current)||void 0===e?void 0:e.files;if(!t||!t[0])return;const a=t[0];c(a)}),[]),m=Object(i.useCallback)((async e=>{if(!s)return;const{success:t}=await l({file:s,...e});t&&At.a.success(Object(w.b)("phrases.update_successfully",{prefix:Object(w.b)("settings.invoices.digital_certificate.title")})),b()}),[s,l]),v=Object(i.useCallback)((e=>{e||(r.resetFields(),c(void 0),o.current&&(o.current.value=""))}),[r]);return Object(g.jsx)(j.a,{open:a,title:Object(w.b)("settings.invoices.digital_certificate.upload"),onClose:b,closable:!0,width:600,height:"100%",afterOpenChange:v,footer:Object(g.jsx)(A.a,{submit:r.submit,loading:d,close:b}),children:Object(g.jsxs)(S.a,{form:r,layout:"vertical",onFinish:m,children:[Object(g.jsx)(S.a.Item,{label:Object(w.b)("settings.invoices.digital_certificate.title"),children:Object(g.jsx)("input",{type:"file",ref:o,onChange:_,multiple:!1,accept:".p12, .pfx"})}),Object(g.jsx)(S.a.Item,{name:"certificate_password",label:Object(w.b)("settings.invoices.digital_certificate.password"),rules:[{required:!0,message:Object(w.b)("phrases.required_field")}],children:Object(g.jsx)(E.a,{placeholder:Object(w.b)("words.password")})})]})})};Yt.displayName="DigitalCertificateDrawer";var Jt=Object(i.forwardRef)(Yt);const Wt=c.a`
  mutation SaveInvoiceCompany($data: SaveSalonInput!) {
    saveSalon(input: $data) {
      success errors
    }
  }
`;var Kt=()=>Object(z.a)(Wt,{onError:e=>{console.error(e),P.b.error(Object(w.b)("phrases.generic_save_error_message")),R.a.captureException(e)},onCompleted:e=>{let{saveSalon:{success:t,errors:a}}=e;t?P.b.success(Object(w.b)("phrases.saved_successfully",{prefix:Object(w.b)("words.setting_other"),context:"female",count:2})):null===a||void 0===a||a.map((e=>P.b.error(e)))}});const Gt=c.a`
  query InvoiceCompany {
    current_company {
      id
      invoice_company {
        id
        send_employee_deduction
        send_employee_observations
        nfse_consider_package_item_value
        nfse_consider_credit_value
        ibs_cbs_classificacao_tributaria
        ibs_cbs_codigo_indicador_operacao
        codigo_nbs
        additional_observation
      }
    }
  }
`;var Qt=e=>Object(Ie.f)(Gt,{fetchPolicy:"network-only",onError:e=>{console.error(e),P.b.error(Object(w.b)("phrases.unable_to_fetch_data"))},onCompleted:e}),Zt=a(623),ea=a(812);const ta=()=>{const e=Object(L.a)((e=>e.current_user.permissions)),t=Object(L.a)((e=>e.current_user.is_staff)),a=Object(L.a)((e=>e.is_mobile)),n=Object(qt.b)("show_impersonate_bar"),s=Object(i.useRef)(null),c=Object(i.useRef)(null),[o]=S.a.useForm(),{setFieldsValue:r}=o,l=Object(i.useCallback)((e=>{let{current_company:t}=e;r({id:t.id,invoice_company_attributes:t.invoice_company})}),[r]),{loading:d}=Qt(l),[u,{loading:b}]=Kt(),_=Object(i.useCallback)((async e=>{u({variables:{data:e}})}),[u]);return Object(g.jsxs)(Pt.b,{children:[Object(g.jsx)(xt,{title:Object(w.b)("words.setting_other")}),Object(g.jsx)(Pt.c,{$pageFull:!0,has_permission:e.is_admin,children:Object(g.jsxs)(Lt.SettingsContainer,{children:[Object(g.jsxs)(S.a,{form:o,layout:"vertical",style:{width:"100%"},onFinish:_,children:[Object(g.jsx)(Ne.a,{loading:d}),Object(g.jsx)(S.a.Item,{noStyle:!0,name:"id",children:Object(g.jsx)(E.a,{type:"hidden"})}),Object(g.jsx)(S.a.Item,{noStyle:!0,name:["invoice_company_attributes","id"],children:Object(g.jsx)(E.a,{type:"hidden"})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.package_items_in_invoice"),description:Object(g.jsx)(ye.a,{i18nKey:"settings.invoices.package_items_in_invoice_description",components:[Object(g.jsx)("br",{})]}),children:Object(g.jsx)(S.a.Item,{noStyle:!0,name:["invoice_company_attributes","nfse_consider_package_item_value"],valuePropName:"checked",children:Object(g.jsx)(Rt.a,{})})}),Object(g.jsx)(Zt.a,{title:Object(g.jsxs)(g.Fragment,{children:[Object(w.b)("settings.invoices.consider_credit_value"),Object(g.jsx)(ht.c,{date:"2025/12/10"})]}),description:Object(g.jsx)(ye.a,{i18nKey:"settings.invoices.consider_credit_value_description",components:[Object(g.jsx)("br",{})]}),children:Object(g.jsx)(S.a.Item,{noStyle:!0,name:["invoice_company_attributes","nfse_consider_credit_value"],valuePropName:"checked",children:Object(g.jsx)(Rt.a,{})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.include_partner_deductions"),description:Object(w.b)("settings.invoices.include_partner_deductions_description"),children:Object(g.jsx)(S.a.Item,{noStyle:!0,name:["invoice_company_attributes","send_employee_deduction"],valuePropName:"checked",children:Object(g.jsx)(Rt.a,{})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.show_partner_details_in_invoice_notes"),description:Object(w.b)("settings.invoices.show_partner_details_in_invoice_notes_description"),children:Object(g.jsx)(S.a.Item,{noStyle:!0,name:["invoice_company_attributes","send_employee_observations"],valuePropName:"checked",children:Object(g.jsx)(Rt.a,{})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.tax_reform.codigo_nbs"),description:Object(w.b)("settings.invoices.tax_reform.codigo_nbs_description"),is_column:a,children:Object(g.jsx)(S.a.Item,{name:["invoice_company_attributes","codigo_nbs"],style:{width:"100%"},children:Object(g.jsx)(E.a,{placeholder:"1.2602",maxLength:20,size:a?"large":"middle"})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.tax_reform.ibs_cbs_classificacao_tributaria"),description:Object(w.b)("settings.invoices.tax_reform.ibs_cbs_classificacao_tributaria_description"),is_column:a,children:Object(g.jsx)(S.a.Item,{name:["invoice_company_attributes","ibs_cbs_classificacao_tributaria"],style:{width:"100%"},dependencies:[["invoice_company_attributes","ibs_cbs_codigo_indicador_operacao"]],rules:[e=>{let{getFieldValue:t}=e;return{validator:(e,a)=>t(["invoice_company_attributes","ibs_cbs_codigo_indicador_operacao"])&&!a?Promise.reject(new Error(Object(w.b)("settings.invoices.tax_reform.ibs_cbs_classificacao_required"))):Promise.resolve()}}],children:Object(g.jsx)(E.a,{placeholder:"000001",maxLength:20,size:a?"large":"middle"})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.tax_reform.ibs_cbs_codigo_indicador_operacao"),description:Object(w.b)("settings.invoices.tax_reform.ibs_cbs_codigo_indicador_operacao_description"),is_column:a,align_items:a?"start":void 0,children:Object(g.jsx)(S.a.Item,{name:["invoice_company_attributes","ibs_cbs_codigo_indicador_operacao"],style:{width:"100%"},dependencies:[["invoice_company_attributes","ibs_cbs_classificacao_tributaria"]],rules:[e=>{let{getFieldValue:t}=e;return{validator:(e,a)=>t(["invoice_company_attributes","ibs_cbs_classificacao_tributaria"])&&!a?Promise.reject(new Error(Object(w.b)("settings.invoices.tax_reform.ibs_cbs_codigo_required"))):Promise.resolve()}}],children:Object(g.jsx)(E.a,{placeholder:"1.2602.10.00",maxLength:20,size:a?"large":"middle"})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.tax_reform.additional_observation"),is_column:!0,description:Object(g.jsx)(S.a.Item,{name:["invoice_company_attributes","additional_observation"],extra:Object(g.jsx)(ye.a,{i18nKey:Object(w.b)("settings.invoices.tax_reform.additional_observation_description"),components:[Object(g.jsx)("br",{})]}),children:Object(g.jsx)(E.a.TextArea,{rows:3,maxLength:500,style:{width:"100%"},placeholder:Object(w.b)("settings.invoices.tax_reform.additional_observation_placeholder")})})}),Object(g.jsx)(Zt.a,{title:Object(w.b)("settings.invoices.digital_certificate.update"),description:Object(w.b)("settings.invoices.digital_certificate.update_description"),is_column:a,children:Object(g.jsx)(De.a,{type:"primary",icon:Object(g.jsx)(Mt.a,{}),block:a,onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.open()},children:Object(w.b)("settings.invoices.digital_certificate.update_certificate")})}),(t||n)&&Object(g.jsx)(Zt.a,{title:"Atualizar o c\xf3digo de seguran\xe7a do consumidor",description:"Envia o CSC para o enotas",children:Object(g.jsx)(De.a,{type:"primary",onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.open()},children:"Atualizar CSC"})}),Object(g.jsx)(ea.a,{loading:b,submit:o.submit})]}),Object(g.jsx)(Jt,{ref:s}),Object(g.jsx)(Tt,{ref:c})]})})]})};ta.displayName="InvoiceSettings";var aa=ta;const ia=c.e`
  query InvoiceList(
    $page: Int, $results: Int, $search_query: String, $start_date: String, $end_date: String, $status: [ID]
  ) {
    current_salon {
      id
      invoices (
        client_sale_type: ["Inventory::Sale", "Inventory::Package"],
        sort_order: "DESC",
        sort_field: "id",
        page: $page,
        results: $results,
        search_term: $search_query,
        start_date: $start_date,
        end_date: $end_date,
        status: $status,
      ) {
        total_count
        all {
          id
          status
          status_reason
          client_sale_type
          client_sale_id
          created_at
          emission_date
          client_name
          total_value
          pdf_link
          xml_link
          client_sale {
            ... on Inventory_Sale {
              id
              code
              finished
            }
          }
        }
      }
    }
  }
`;var na=a(3037);const sa=[{value:"pending",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#1194f6",children:"Pendente"})},{value:"issued",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#4eb660",children:"Emitida"})},{value:"canceled",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#faa84f",children:"Cancelada"})},{value:"denied",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Negada"})},{value:"cancel_denied",label:Object(g.jsx)(v.a,{style:{margin:"2px 0"},color:"#e44e4d",children:"Cancelamento negado"})}];var ca=()=>Object(i.useMemo)((()=>[{label:"Status",name:"status",checkbox_options:sa,checkbox_disabled:!0},{label:"Per\xedodo",name:"emission_date",rangepicker:{start_date_name:"start_date",end_date_name:"end_date"}}]),[]);const oa=e=>{const{item:t}=e,a=`${"Inventory::Sale"===(null===t||void 0===t?void 0:t.client_sale_type)?"C":"P"}#${null===t||void 0===t?void 0:t.client_sale.code}`;return Object(g.jsxs)(j.g,{$column:!0,children:[Object(g.jsxs)(j.g,{justify:"space-between",children:[Object(g.jsx)(rt.b,{$block:!0,$textEllipsis:!0,$isFlex:!0,width:22,children:null===t||void 0===t?void 0:t.client_name}),Object(g.jsx)(rt.b,{width:6,$align:"right",$block:!0,$semibold:!0,children:Object(m.d)(null===t||void 0===t?void 0:t.total_value,{cents:!1})})]}),Object(g.jsxs)(j.g,{$top:5,justify:"space-between",children:[Object(g.jsxs)(rt.b,{width:8,$block:!0,$color:"gray_1",$size:12,$isFlex:!0,$textEllipsis:!0,children:[a," - ",f()((null===t||void 0===t?void 0:t.emission_date)||(null===t||void 0===t?void 0:t.created_at),s.H).format("LL")]}),t&&y(null===t||void 0===t?void 0:t.status)]})]})};oa.displayName="InvoiceItemMobile";var ra=Object(i.memo)(oa);var la=()=>{const e=Object(n.o)();Object(bt.a)({addon_keys:["has_nfs"],search:s.a.ID_NEW_INVOICE,onCancel:()=>e("/calendar")});const t=Object(L.a)((e=>e.current_user.addons.has_nfs)),a=Object(L.a)((e=>e.current_user.permissions)),c=Object(i.useRef)(null),o=Object(i.useRef)(null),r=Object(i.useRef)(null),_=Object(i.useRef)(null),j=Object(i.useRef)(null),m=Object(i.useCallback)((()=>{var e;null===(e=j.current)||void 0===e||e.refetch()}),[]),v=Object(i.useCallback)((e=>{var t;null===(t=r.current)||void 0===t||t.open(null===e||void 0===e?void 0:e.id)}),[]),O=Object(i.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.open({sale_id:e})}),[]),p=Object(i.useCallback)((e=>{var t;null===(t=o.current)||void 0===t||t.open(e)}),[]),h=C({refetch:m,openSaleDrawer:O,openPackageDrawer:p}),x=ca(),f=Object(i.useCallback)((()=>!0),[]),y=Object(i.useCallback)((e=>{var t,a;return null===e||void 0===e||null===(t=e.current_salon)||void 0===t||null===(a=t.invoices)||void 0===a?void 0:a.all}),[]),k=Object(i.useCallback)((e=>{var t,a;return(null===e||void 0===e||null===(t=e.current_salon)||void 0===t||null===(a=t.invoices)||void 0===a?void 0:a.total_count)||0}),[]),w=Object(i.useMemo)((()=>[{label:"Comandas",icon:na.a,onClick:()=>e("/sales")},{label:"Baixar XML",icon:l.a,onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.open()}}]),[e]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(d.a,{ref:j,Header:xt,title:"Nota fiscal de servi\xe7o",storage_key:"invoice",search_placeholder:"Procure pelo nome do cliente...",filters:x,has_feature:t,addon_id:s.a.ID_NEW_INVOICE,permissions:{can_create:a.can_create_invoice,can_edit:a.can_edit_invoice,can_access:a.can_access_invoice},openDrawer:v,columns:h,validateRow:f,extra_actions:w,show_create_button:!1,item_selectable:!1,query:ia,getData:y,MobileItem:ra,getTotalCount:k}),Object(g.jsx)(u.a,{ref:c}),Object(g.jsx)(b.a,{ref:o}),Object(g.jsx)(qe,{ref:r}),Object(g.jsx)(st,{ref:_,title:"Nota fiscal de servi\xe7o",storage_key:"invoice"})]})};const da=()=>{const e=Object(n.o)(),t=Object(L.a)((e=>e.is_webook)),a=Object(L.a)((e=>{var t;return!(null===(t=e.current_user.salon.enotas_token)||void 0===t||!t.token)})),s=Object(L.a)((e=>e.current_user.addons.has_nfs))&&a,c=Object(L.a)((e=>e.current_user.addons.has_nfe))&&a,o=Object(L.a)((e=>e.current_user.addons.has_nfce))&&a;Object(i.useEffect)((()=>{t&&e("/calendar")}),[t,e]);const r=Object(i.useMemo)((()=>s?Object(g.jsx)(n.a,{to:"/invoices/invoice"}):c?Object(g.jsx)(n.a,{to:"/invoices/electronic_invoice"}):o?Object(g.jsx)(n.a,{to:"/invoices/electronic_consumer_invoice"}):Object(g.jsx)(n.a,{to:"/invoices/invoice"})),[o,c,s]);return Object(g.jsxs)(n.d,{children:[Object(g.jsx)(n.b,{path:"/",element:r}),Object(g.jsx)(n.b,{path:"/invoice",element:Object(g.jsx)(la,{})}),Object(g.jsx)(n.b,{path:"/electronic_invoice",element:Object(g.jsx)(zt,{})}),Object(g.jsx)(n.b,{path:"/electronic_consumer_invoice",element:Object(g.jsx)(ft,{})}),Object(g.jsx)(n.b,{path:"/settings",element:Object(g.jsx)(aa,{})})]})};da.displayName="CashAccountings";t.default=Object(i.memo)(da)},812:function(e,t,a){"use strict";var i=a(50),n=a(159),s=a(1207),c=a(250),o=a(0),r=a(27),l=a(19),d=a(22);const u=e=>{let{loading:t,submit:a}=e;const o=Object(r.a)((e=>e.is_mobile));return o?Object(d.jsx)(c.g,{$paddings:o?15:[15,0],justify:"end",children:Object(d.jsx)(n.a,{size:"large",block:!0,type:"primary",onClick:a,loading:t,children:Object(i.b)("verbs.save")})}):Object(d.jsx)(s.a,{offsetBottom:0,children:Object(d.jsx)(b,{children:Object(d.jsx)(n.a,{type:"primary",onClick:a,loading:t,size:"middle",children:Object(i.b)("verbs.save")})})})};u.displayName="SettingsFooter",t.a=Object(o.memo)(u);const b=l.d.div.withConfig({componentId:"wb__sc-ks2z7o-0"})(["background:",";padding:15px 20px;display:flex;justify-content:flex-end;"],(e=>e.theme.colors.white))},999:function(e,t,a){"use strict";a.r(t),a.d(t,"SettingsContainer",(function(){return z}));var i=a(0),n=a(50),s=a(116),c=a(2937),o=a(2824),r=a(538),l=a(159),d=a(3023),u=a(585),b=a(18),_=a(742),j=a(743),m=a(19),v=a(654),O=a(27),p=a(812),h=a(623),x=a(37),f=a(1850),g=a(76);const y=x.e`
  mutation saveSubscriptionSaleSettingsMutation($data: SaveSalonConfigurationInput!) {
    saveSalonConfiguration(input: $data) {
      success errors
    }
  }
`;var C=()=>{const[e,{loading:t}]=Object(f.a)(y);return[async t=>{const a=s.b.loading(`${Object(n.b)("verbs.wait")}...`,0);try{const{data:i}=await e({variables:{data:t}}),{success:n,errors:c}=(null===i||void 0===i?void 0:i.saveSalonConfiguration)||{};return null===c||void 0===c||c.forEach((e=>s.b.error(e))),{success:n}}catch(i){return g.a.captureException(i),s.b.error(Object(n.b)("phrases.generic_save_error_message")),console.error(i),{success:!1}}finally{a()}},t]},k=a(82),w=a(854),I=a(1004),$=a(3052),S=a(597),N=a(22);const D=()=>{const e=[{label:Object(n.b)("words.subscription_other"),path:"/customer/subscriptions",icon:w.a},{label:Object(n.b)("words.customer_subscription_template_other"),path:"/customer/subscription-templates",icon:I.a},{label:Object(n.b)("words.setting_other"),path:"/customer/subscription-settings",icon:$.a}];return Object(N.jsx)(S.b,{$showBottomBorder:!0,title:Object(n.b)("phrases.subscription_sale_other"),tabs:e})};D.displayName="Header";var E=D;const F=()=>{const e=Object(O.a)((e=>e.is_mobile)),t=Object(O.a)((e=>e.current_user.permissions)),a=Object(O.a)((e=>e.current_user.salon.salon_configuration)),m=Object(O.a)((e=>{var t;return null===(t=e.current_user.salon.site_config)||void 0===t?void 0:t.subdomain})),x=Object(O.a)((e=>e.current_user.salon.has_online_payment)),f=Object(i.useRef)(null),g=Object(i.useRef)(null),[y]=c.a.useForm(),w=Object(v.a)(),I=Object(i.useMemo)((()=>({id:a.id,subscription_template_visible:a.subscription_template_visible,subscription_template_description:a.subscription_template_description})),[a.id,a.subscription_template_description,a.subscription_template_visible]),[$,S]=C(),D=Object(i.useCallback)((async e=>{const{success:t}=await $(e);t&&s.b.success(Object(n.b)("phrases.saved_successfully",{prefix:Object(n.b)("words.setting"),context:"female"}))}),[$]),F=Object(i.useCallback)((()=>{var e,a;t.is_admin?k.a.IS_WEBOOK?null===(a=g.current)||void 0===a||a.open():null===(e=f.current)||void 0===e||e.open():s.b.warning(Object(n.b)("phrases.no_permission_to_do_this"))}),[t.is_admin]),P=Object(i.useCallback)(((e,t)=>t?x?Promise.resolve():(F(),y.setFieldValue("subscription_template_visible",!1),Promise.reject()):Promise.resolve()),[y,x,F]),R=Object(i.useMemo)((()=>b.w?k.a.ONLINEBOOKING_DOMAIN:"localhost:3050"),[]),M=Object(i.useMemo)((()=>{if(!m)return;return`${b.w?"https://":"http://"}${m}.${R}/subscription`}),[m,R]);return Object(N.jsxs)(u.b,{children:[Object(N.jsx)(E,{}),Object(N.jsx)(u.c,{$pageFull:!0,has_permission:t.is_admin,children:Object(N.jsx)(z,{children:Object(N.jsxs)(c.a,{form:y,initialValues:I,onFinish:D,layout:"vertical",style:{width:"100%"},children:[Object(N.jsx)(c.a.Item,{name:"id",noStyle:!0,children:Object(N.jsx)(o.a,{type:"hidden",autoComplete:"off"})}),Object(N.jsx)(h.a,{title:Object(n.b)("customer.subscription_settings.link_title"),description:Object(n.b)("customer.subscription_settings.link_description"),is_column:e,children:Object(N.jsxs)(r.a.Compact,{block:!0,children:[Object(N.jsx)(o.a,{style:{width:"calc(100% - 80px)"},value:M,disabled:!0}),Object(N.jsx)(l.a,{style:{width:80},type:"primary",disabled:!M,onClick:()=>w(M),children:Object(n.b)("verbs.copy")})]})}),Object(N.jsx)(h.a,{title:Object(n.b)("words.visible"),is_column:e,align_items:e?"start":void 0,description:Object(n.b)("customer.subscription_settings.visible_description"),children:Object(N.jsx)(c.a.Item,{name:"subscription_template_visible",valuePropName:"checked",noStyle:!0,rules:[{validator:P}],children:Object(N.jsx)(d.a,{})})}),Object(N.jsx)(h.a,{title:Object(n.b)("words.description"),is_column:!0,description:Object(N.jsxs)(N.Fragment,{children:[Object(n.b)("customer.subscription_settings.template_description"),Object(N.jsx)(c.a.Item,{noStyle:e,name:"subscription_template_description",children:Object(N.jsx)(o.a.TextArea,{maxLength:16777215,rows:3,placeholder:Object(n.b)("customer.subscription_settings.template_placeholder"),style:{width:"100%",marginTop:10},autoComplete:"off"})})]})}),Object(N.jsx)(p.a,{loading:S,submit:y.submit})]})})}),Object(N.jsx)(_.a,{ref:f}),Object(N.jsx)(j.a,{ref:g})]})};F.displayName="SubscriptionSettings";t.default=F;const z=m.d.div.withConfig({componentId:"wb__sc-z3olam-0"})(["width:100%;background:#FFFFFF;padding:10px;margin-bottom:","px;",";.ant-form-item-control{width:100%;}"],(e=>e.theme.sidebar_mobile_bottom_margin),(e=>e.theme.is_mobile&&Object(m.c)(["padding:0 10px;"])))}}]);
//# sourceMappingURL=124.ebee3515.chunk.js.map