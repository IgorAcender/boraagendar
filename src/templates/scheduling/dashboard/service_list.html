{% extends "base_dashboard.html" %}
{% block title %}Serviços{% endblock %}
{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  .header-gradient{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:1.5rem;border-radius:14px;margin-bottom:1rem;box-shadow:0 8px 32px rgba(102,126,234,.3)}
  .header-content{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}
  .header-title{display:flex;align-items:center;gap:1rem}
  .header-icon{background:rgba(255,255,255,.2);padding:.75rem;border-radius:12px;font-size:1.5rem}
  .btn{padding:.6rem 1rem;border:none;border-radius:10px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:.5rem}
  .btn-primary{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem}
  .cardx{background:#111827;border:1px solid #223148;border-radius:12px;padding:1rem}
  label{font-weight:600;color:#cbd5e1;font-size:.9rem}
  input,select,textarea{width:100%;padding:.6rem;border-radius:10px;border:1px solid #334155;background:#0f172a;color:#e2e8f0}
  .status-badge{padding:.2rem .6rem;border-radius:999px}
  .messages{list-style:none;margin:.5rem 0 0;padding:0}
  .messages li{color:#fecaca}
</style>
{% endblock %}
{% block content %}

<div class="header-gradient">
  <div class="header-content">
    <div class="header-title">
      <div class="header-icon"><i class="fas fa-spa"></i></div>
      <div>
        <h2 style="margin:0">Serviços</h2>
        <p class="subtitle" style="opacity:.9">Cadastre e gerencie os serviços ofertados</p>
      </div>
    </div>
  </div>
</div>

<div class="cardx" style="margin-bottom:1rem;">
  <h3 style="margin-top:0">Novo serviço</h3>
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button class="btn btn-primary" type="submit"><i class="fas fa-save"></i> Salvar</button>
  </form>
  {% if form.errors %}
    <ul class="messages">{% for f in form %}{% for e in f.errors %}<li>{{ e }}</li>{% endfor %}{% endfor %}</ul>
  {% endif %}
  <p style="margin-top:.5rem;color:#94a3b8">Para vincular profissionais, edite o serviço após criar.</p>
</div>

<div class="grid">
{% for s in services %}
  <div class="cardx">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem">
      <div>
        <h3 style="margin:0">{{ s.name }}</h3>
        <small style="color:#cbd5e1">{{ s.duration_minutes }} min • R$ {{ s.price }}</small>
      </div>
      <span class="status-badge" style="background:{% if s.is_active %}#10b981{% else %}#ef4444{% endif %};color:#06281d">{% if s.is_active %}ativo{% else %}inativo{% endif %}</span>
    </div>
    <p style="color:#cbd5e1;margin:.5rem 0 0">{{ s.description|default:"Sem descrição" }}</p>
    <div style="margin-top:.6rem;color:#cbd5e1">
      <i class="fas fa-user"></i>
      {% for p in s.professionals.all %}{{ p.display_name }}{% if not forloop.last %}, {% endif %}{% empty %}Nenhum vinculado{% endfor %}
    </div>
  </div>
{% empty %}
  <p>Nenhum serviço cadastrado.</p>
{% endfor %}
</div>

{% endblock %}
